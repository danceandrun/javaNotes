ç†è®ºï¼šå›ç­”ä¸ºä»€ä¹ˆå­¦ä¹ å¾®æœåŠ¡

å®ç°ï¼šå†™ä»£ç å»

#  ä»å•ä½“åº”ç”¨åˆ°å¾®æœåŠ¡

## å•ä½“æ¶æ„

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬æ‰€å®ç°çš„webåº”ç”¨éƒ½æœ‰ä¸€ä¸ªå…±åŒçš„ç‰¹ç‚¹ï¼Œ**æ‰€æœ‰çš„ä»£ç æœ€ç»ˆæ‰“åŒ…æˆä¸€ä¸ªæ–‡ä»¶(jaråŒ…)ï¼Œæ•´ä¸ªç³»ç»Ÿçš„æ‰€æœ‰åŠŸèƒ½å•å…ƒæ•´ä½“éƒ¨ç½²åˆ°åŒä¸€ä¸ªè¿›ç¨‹**ï¼Œè¿™ç§è½¯ä»¶æ¶æ„çš„é£æ ¼ï¼Œå³æ‰€è°“çš„"å•ä½“æ¶æ„"ã€‚

![](SpringCloudç¬”è®° .assets/å•ä½“åº”ç”¨.png)

#### å•ä½“æ¶æ„çš„æ‰©å®¹

ä¸€ä¸ªå•ä½“åº”ç”¨åœ¨è¿è¡Œæ—¶ï¼Œä¼šéƒ¨ç½²åœ¨ä¸€å°äº‘æœåŠ¡å™¨ä¸Šï¼Œä½†æ˜¯éšç€ç”¨æˆ·ä½“é‡çš„å¢é•¿ï¼Œä¸€å°äº‘æœåŠ¡å™¨ä¸Šè¿è¡Œçš„ä¸€ä¸ªå•ä½“åº”ç”¨ï¼Œå·²ç»æ— æ³•æ‰¿è½½æ—¥ç›Šå¢é•¿çš„è¯·æ±‚é‡ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å¯¹å•ä½“åº”ç”¨å®ç°æ‰©å®¹ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨å•ä½“åº”ç”¨é›†ç¾¤

![](SpringCloudç¬”è®° .assets/å•ä½“åº”ç”¨çš„é›†ç¾¤.png)

é€šè¿‡ä½¿ç”¨å•ä½“åº”ç”¨çš„é›†ç¾¤ï¼Œå¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šï¼Œå¾ˆå¥½åœ°åº”å¯¹æ—¥ç›Šå¢é•¿çš„ç”¨æˆ·è¯·æ±‚ï¼Œä½†æ˜¯è¿™æ ·å°±å®Œç¾äº†å—ï¼Ÿå½“ç„¶ä¸æ˜¯

#### å•ä½“æ¶æ„çš„ä¼˜åŠ¿å’Œå¼Šç«¯

åœ¨å•ä½“åº”ç”¨çš„æ—©æœŸï¼Œåº”ç”¨ç¨‹åºç›¸å¯¹è¾ƒå°ï¼Œå•ä½“æ¶æ„çš„å¥½å¤„ï¼š

- åº”ç”¨çš„å¼€å‘å¾ˆç®€å•
- æ˜“äºå¯¹åº”ç”¨ç¨‹åºè¿›è¡Œå¤§è§„æ¨¡çš„æ›´æ”¹
- æµ‹è¯•ç›¸å¯¹ç›´è§‚ç®€å•
- éƒ¨ç½²ç®€å•æ˜äº†
- æ¨ªå‘æ‰©å®¹ä¸è´¹å¹ç°ä¹‹åŠ›

ä½†æ˜¯ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œå•ä½“åº”ç”¨ä¸­åŒ…å«çš„åŠŸèƒ½è¶Šæ¥è¶Šå¤šï¼Œåº”ç”¨çš„"ä½“ç§¯"è¶Šæ¥è¶Šå¤§ï¼Œå•ä½“åº”ç”¨çš„å¼Šç«¯å°±ä¼šé€æ¸ä½“ç°å‡ºæ¥ã€‚

- ä»£ç è¿‡åº¦å¤æ‚ä¸”ä¸¥é‡è€¦åˆï¼Œå¯¼è‡´éš¾ä»¥ç»´æŠ¤

> 1. ç”±äºç³»ç»Ÿæœ¬èº«è¿‡äºåºå¤§å’Œå¤æ‚ï¼Œä»¥è‡³äºä»»ä½•ä¸€ä¸ªå¼€å‘è€…éƒ½å¾ˆéš¾ç†è§£å®ƒçš„å…¨éƒ¨ï¼Œå› æ­¤ï¼Œä¿®å¤è½¯ä»¶ä¸­çš„é—®é¢˜å’Œæ­£ç¡®å®ç°æ–°åŠŸèƒ½å°±å˜å¾—å›°éš¾ä¸”è€—æ—¶
> 2. æ›´ç³Ÿç³•çš„æ˜¯ï¼Œè¿™ç§æåº¦çš„å¤æ‚æ€§ï¼Œå¯èƒ½ä¼šå½¢æˆä¸€ä¸ªæ¶æ€§å¾ªç¯: ç”±äºä»£ç éš¾ä»¥ç†è§£ï¼Œå› æ­¤å¼€å‘è€…åœ¨æ›´æ”¹æ—¶æ›´å®¹æ˜“å‡ºé”™ï¼Œæ¯ä¸€æ¬¡æ›´æ”¹éƒ½ä¼šè®©ä»£ç åº“å˜å¾—æ›´å¤æ‚ï¼Œæ›´éš¾æ‡‚

- ä»ä»£ç æäº¤åˆ°å®é™…éƒ¨ç½²çš„å‘¨æœŸå¾ˆé•¿

> ä»ä»£ç å®Œæˆåˆ°è¿è¡Œåœ¨ç”Ÿäº§ç¯å¢ƒï¼Œæ˜¯ä¸€ä¸ªæ¼«é•¿ä¸”è´¹åŠ›çš„è¿‡ç¨‹ã€‚
> 1. ä¼—å¤šå¼€å‘äººå‘˜éƒ½å‘åŒä¸€ä¸ªä»£ç åº“æäº¤ä»£ç ï¼Œå¸¸å¸¸ä½¿å¾—ä»£ç åº“çš„æ„å»ºç»“æ„å¤„äºæ— æ³•äº¤ä»˜çš„çŠ¶æ€ã€‚å½“é‡‡ç”¨äº†åˆ†æ”¯æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåˆå¿…é¡»å¿å—æ¼«é•¿ä¸”ç—›è‹¦çš„åˆå¹¶è¿‡ç¨‹
> 2. å› ä¸ºä»£ç åº“ä¸­çš„ä»£ç ååˆ†å¤æ‚ï¼Œä»¥è‡³äºä»»ä½•ä¸€ä¸ªæ›´æ”¹å¯èƒ½å¼•èµ·çš„å½±å“æ˜¯æœªçŸ¥çš„ï¼Œä¸ºäº†é¿å…ç‰µä¸€å‘è€ŒåŠ¨å…¨èº«çš„åæœï¼Œå³ä½¿æ˜¯ä¸€ä¸ªå¾®å°çš„æ›´æ”¹ï¼Œä¹Ÿå¿…é¡»æ‰§è¡Œå…¨éƒ¨çš„æµ‹è¯•

- æ‰©å±•æ€§å—é™

> 1. å¦‚æœå•ä½“åº”ç”¨ä¸­çš„æŸä¸€ä¸ªåŠŸèƒ½ç‚¹å­˜åœ¨æ€§èƒ½é—®é¢˜ï¼Œé‚£ä¹ˆå°±éœ€è¦å¤šéƒ¨ç½²å‡ ä¸ªå•ä½“åº”ç”¨çš„å®ä¾‹ï¼Œå†åŠ ä¸Šè´Ÿè½½å‡è¡¡çš„è®¾å¤‡(æ¯”å¦‚nginx)ï¼Œæ‰èƒ½ä¿è¯æ•´ä¸ªåº”ç”¨çš„æ€§èƒ½èƒ½å¤Ÿæ”¯æ’‘ç”¨æˆ·çš„ä½¿ç”¨
> 2. åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œåº”ç”¨çš„ä¸åŒæ¨¡å—å¯¹èµ„æºçš„éœ€æ±‚æ˜¯ç›¸äº’å†²çªçš„ï¼Œæ¯”å¦‚æŸäº›æ¨¡å—éœ€è¦é«˜æ•ˆçš„IOï¼ŒæŸäº›æ¨¡å—éœ€è¦é«˜æ€§èƒ½çš„CPU, è€Œè¿™äº›æ¨¡å—éƒ½åœ¨ä¸€ä¸ªå•ä½“åº”ç”¨ä¹‹å†…ï¼Œå› æ­¤å…¶æ‰€éƒ¨ç½²çš„æœåŠ¡å™¨å¿…é¡»æ»¡è¶³æ‰€æœ‰çš„éœ€æ±‚  

- å¼€å‘æ…¢ï¼Œå¯åŠ¨æ…¢ï¼Œä¸¥é‡å½±å“å¼€å‘æ•ˆç‡
- äº¤ä»˜å¯é çš„å•ä½“åº”ç”¨å›°éš¾

> 1. å•ä½“åº”ç”¨ä½“ç§¯åºå¤§ï¼Œéš¾ä»¥è¿›è¡Œå…¨é¢å’Œå½»åº•çš„æµ‹è¯•ï¼Œè€Œç¼ºä¹å¯é çš„æµ‹è¯•æ„å‘³ç€ä»£ç ä¸­çš„é”™è¯¯ä¼šè¿›å…¥ç”Ÿäº§ç¯å¢ƒ
> 2. ç¼ºä¹æ•…éšœéš”ç¦»ï¼Œå› ä¸ºæ‰€æœ‰çš„æ¨¡å—éƒ½åœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­è¿è¡Œï¼Œæ¯éš”ä¸€æ®µæ—¶é—´ï¼Œåœ¨ä¸€ä¸ªæ¨¡å—ä¸­çš„ä»£ç é”™è¯¯ï¼Œå°†ä¼šå¯¼è‡´æ•´ä¸ªåº”ç”¨ç¨‹åºçš„å´©æºƒ

## å¾®æœåŠ¡æ¶æ„

> ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ï¼Ÿ
>
> ä»€ä¹ˆæ˜¯å¾®æœåŠ¡æ¶æ„ï¼Ÿ

æˆ‘ä»¬çœ‹åˆ°ï¼Œéšç€å•ä½“åº”ç”¨çš„å‘å±•ï¼Œæœ€ç»ˆä¼šå˜å¾—éš¾ä»¥ç»´æŠ¤ï¼Œéš¾ä»¥å®ç°åŠæ—¶å¯é çš„äº¤ä»˜ï¼Œä¸”å¼€å‘æ•ˆç‡ä½ã€‚é‚£ä¹ˆæ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿè§£å†³ä¹‹é“å°±åœ¨äºå¾®æœåŠ¡æ¶æ„ã€‚

è¦ç†è§£å¾®æœåŠ¡æ¶æ„ï¼Œæˆ‘ä»¬å¾—é¦–å…ˆç†è§£å¾®æœåŠ¡ï¼Œé‚£ä»€ä¹ˆæ˜¯å¾®æœåŠ¡å‘¢ï¼Ÿ

ç®€å•ç†è§£ä¸€ä¸ª**å¾®æœåŠ¡**çš„æœ¬è´¨å°±æ˜¯ä¸€ä¸ªéº»é›€è™½å°ä½†äº”è„ä¿±å…¨çš„åº”ç”¨ç¨‹åºï¼Œå®ƒæŒ‰ç…§**å•ä¸€èŒè´£åŸåˆ™**å®ç°äº†**ç‰¹å®šçš„ä¸€ç»„åŠŸèƒ½**ã€‚

- å› ä¸ºæ¯ä¸ªå¾®æœåŠ¡çš„æœ¬è´¨éƒ½å¯ä»¥æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œè¿™å°±è¦æ±‚ï¼Œå¾®æœåŠ¡å¯ä»¥**ç‹¬ç«‹éƒ¨ç½²ï¼Œç‹¬ç«‹è¿è¡Œï¼Œç‹¬ç«‹å¯¹å¤–æä¾›æœåŠ¡**(è¿è¡Œåœ¨ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ä¸­)
- æ¯ä¸ªå¾®æœåŠ¡ï¼Œæ ¹æ®å•ä¸€èŒè´£åŸåˆ™ï¼Œå®ç°ä¸€ç»„ç›¸å…³åŠŸèƒ½

åœ¨æ­¤åŸºç¡€ä¸Šï¼Œä»€ä¹ˆæ˜¯**å¾®æœåŠ¡æ¶æ„**å‘¢ï¼Ÿç®€å•ç†è§£ï¼Œå°±æ˜¯**æŠŠåº”ç”¨ç¨‹åºåŠŸèƒ½åˆ†è§£ä¸ºä¸€ç»„æœåŠ¡**çš„æ¶æ„é£æ ¼ã€‚å®é™…ä¸Šï¼Œå¾®æœåŠ¡æ¶æ„æ˜¯æ¨¡å—åŒ–å¼€å‘çš„ä¸€ç§å½¢å¼ã€‚

æ¨¡å—åŒ–æ˜¯å¼€å‘å¤§å‹ï¼Œå¤æ‚åº”ç”¨ç¨‹åºçš„åŸºç¡€ã€‚å½“ä¸€ä¸ªå•ä½“åº”ç”¨ç¨‹åºçš„è§„æ¨¡å¤ªå¤§çš„æ—¶å€™ï¼Œæ˜¯å¾ˆéš¾ä½œä¸ºä¸€ä¸ªæ•´ä½“å¼€å‘ï¼Œä¹Ÿå¾ˆéš¾è®©ä¸€ä¸ªäººå®Œå…¨ç†è§£çš„ã€‚ä¸ºäº†è®©ä¸åŒçš„äººå¼€å‘å’Œç†è§£(ä¸åŒçš„éƒ¨åˆ†)ï¼Œå¤§å‹åº”ç”¨éœ€è¦æ‹†åˆ†æ¨¡å—ã€‚

- åœ¨å•ä½“æ¶æ„ä¸­ï¼Œæ¨¡å—é€šå¸¸ç”±ä¸€ç»„ç¼–ç¨‹è¯­è¨€æ‰€æä¾›çš„çš„ç»“æ„(ä¾‹å¦‚Javaä¸­çš„åŒ…ï¼Œæˆ–è€…jaræ–‡ä»¶)æ¥å®šä¹‰ï¼Œä½†æ˜¯é€šè¿‡è¿™ç§æ–¹å¼å¾—åˆ°çš„æ¨¡å—ï¼Œä¸åŒæ¨¡å—çš„ä»£ç è¿˜æ˜¯å¯ä»¥ç›¸äº’å¼•ç”¨ï¼Œ**å¯¼è‡´æ¨¡å—ä¸­å¯¹è±¡ä¾èµ–å…³ç³»çš„æ··ä¹±**
- è€Œå¾®æœåŠ¡æ¶æ„ï¼Œä½¿ç”¨å¾®æœåŠ¡ä½œä¸ºæ¨¡å—åŒ–çš„å•å…ƒï¼Œè¦è®¿é—®æœåŠ¡ï¼Œåªèƒ½é€šè¿‡æœåŠ¡å¯¹å¤–æä¾›çš„APIï¼Œäºæ˜¯**æœåŠ¡çš„APIä¸ºå®ƒè‡ªèº«æ„ç­‘äº†ä¸€ä¸ªä¸å¯é€¾è¶Šçš„è¾¹ç•Œ**ï¼Œä½ æ— æ³•è¶Šè¿‡APIå»è®¿é—®æœåŠ¡å†…éƒ¨çš„ç±»ã€‚ï¼ˆåŠŸèƒ½è¾¹ç•Œå†³å®šæ•°æ®è¾¹ç•Œï¼Œä¹Ÿå°±æ˜¯ä¸åŒçš„æœåŠ¡è®¿é—®ä¸åŒçš„æ•°æ®åº“ï¼‰

![](SpringCloudç¬”è®° .assets/å¾®æœåŠ¡.png)

#### å¾®æœåŠ¡çš„ä¼˜åŠ¿å’Œå¼Šç«¯

ä½¿ç”¨å¾®æœåŠ¡æ¶æ„ï¼Œå¯ä»¥è§£å†³åºå¤§çš„å•ä½“åº”ç”¨çš„ç—›ç‚¹ï¼Œå¸¦æ¥å¾ˆå¤šå¥½å¤„ï¼š

- æ¯ä¸ªæœåŠ¡éƒ½ç›¸å¯¹è¾ƒå°ï¼Œå®¹æ˜“ç»´æŠ¤
- ä½¿å¾—å¤§å‹çš„åº”ç”¨ç¨‹åºå®ç°å¿«é€Ÿçš„æŒç»­äº¤ä»˜å’ŒæŒç»­éƒ¨ç½²

> 1. æ¯ä¸€ä¸ªæœåŠ¡ç›¸å¯¹è¾ƒå°ï¼Œç¼–å†™å…¨é¢çš„æµ‹è¯•ä»£ç å’Œæ‰§è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•éƒ½å˜å¾—ç›¸å¯¹å®¹æ˜“
> 2. æ¯ä¸ªæœåŠ¡éƒ½ç‹¬ç«‹äºå…¶ä»–æœåŠ¡éƒ¨ç½²ï¼Œå¦‚æœè´Ÿè´£æœåŠ¡çš„å¼€å‘äººå‘˜ï¼Œéœ€è¦éƒ¨ç½²å¯¹è¯¥æœåŠ¡çš„æ›´æ”¹ï¼Œä¸éœ€è¦ä¸å…¶ä»–å¼€å‘äººå‘˜åå•†ï¼Œå› æ­¤å°†æ›´æ”¹é¢‘ç¹éƒ¨ç½²åˆ°ç”Ÿäº§ä¸­è¦å®¹æ˜“çš„å¤š

- åº”ç”¨æ‰©å±•çµæ´»

> 1. åº”ç”¨è¢«æ‹†åˆ†ä¸ºä¸åŒçš„å¾®æœåŠ¡ï¼Œè€Œå¾®æœåŠ¡å¯ä»¥ç‹¬ç«‹éƒ¨ç½²ï¼Œå› æ­¤ï¼Œæ‰©å®¹å°±ä¸åœ¨é’ˆå¯¹æ•´ä¸ªåº”ç”¨äº†ï¼Œå“ªé‡Œå‡ºç°æ€§èƒ½ç“¶é¢ˆï¼Œå¯¹å“ªä¸ªæœåŠ¡æ‰©å®¹å³å¯
> 2. å³ä½¿ä¸åŒçš„çš„æœåŠ¡éœ€è¦èµ„æºå­˜åœ¨å†²çªï¼Œä¹Ÿæ²¡æœ‰å…³ç³»ï¼ŒæŠŠå®ƒä»¬åˆ†åˆ«éƒ¨ç½²åˆ°å…·æœ‰æ‹¥æœ‰å„è‡ªæ‰€éœ€è¦èµ„æºçš„æœºå™¨ä¸Šå³å¯

- æ›´å¥½çš„å®¹é”™

> ç›¸æ¯”äºå•ä½“æ¶æ„ä¸­ï¼Œä¸€ä¸ªæ•…éšœæ‹–å®æ•´ä¸ªç³»ç»Ÿçš„æƒ…å†µï¼Œä¸€ä¸ªæœåŠ¡çš„æ•…éšœï¼Œå¹¶ä¸ä¼šå½±å“æƒ³åˆ°å…¶ä»–æœåŠ¡çš„æ­£å¸¸è¿è¡Œã€‚

å½“ç„¶ï¼Œä½¿ç”¨å¾®æœåŠ¡ä¹Ÿä¼šå¸¦æ¥ä¸€äº›å¼Šç«¯ï¼Œå¾®æœåŠ¡æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œæœ‰åˆ†å¸ƒå¼ç³»ç»Ÿçš„é€šç—…ï¼š

- åˆ†å¸ƒå¼ç³»ç»Ÿå¯èƒ½å¤æ‚éš¾ä»¥ç®¡ç†
- åˆ†å¸ƒå¼éƒ¨ç½²è¿½è¸ªé—®é¢˜éš¾ï¼ˆä½†æ˜¯ç›®å‰æœ‰æˆç†Ÿçš„æ—¥å¿—èšåˆæŠ€æœ¯ï¼‰
- åˆ†å¸ƒå¼äº‹åŠ¡æ¯”è¾ƒéš¾å¤„ç†ï¼ˆç›®å‰æœ‰æˆç†Ÿçš„äº‹åŠ¡æ²»ç†æŠ€æœ¯ï¼‰
- æœåŠ¡æ•°é‡å¢åŠ ï¼Œç®¡ç†å¤æ‚æ€§å¢åŠ ï¼ˆæœåŠ¡ä¸€è®¿é—®æ•°æ®åº“ä¸€ï¼ŒæœåŠ¡äºŒè®¿é—®æ•°æ®åº“äºŒï¼Œä¸¤ä¸ªæ˜¯ä¸åŒçš„æ•°æ®åº“è¿æ¥ï¼›å°†ä¸åŒçš„æœåŠ¡å¯¹æ•°æ®åº“çš„è®¿é—®æˆä¸ºä¸€ä¸ªäº‹åŠ¡ï¼Œéœ€è¦åˆ†å¸ƒå¼äº‹åŠ¡ï¼‰

#### å¾®æœåŠ¡çš„æ‹†åˆ†

å› ä¸ºåº”ç”¨å¾ˆå°‘ä¸€å¼€å§‹å°±æ˜¯å¾®æœåŠ¡æ¶æ„ï¼Œåˆšå¼€å§‹æ˜¯å•ä½“æ¶æ„ï¼Œå°†å•ä½“æ¶æ„æ‹†åˆ†æˆå¾®æœåŠ¡æ¶æ„ã€‚

![image-20210922143348626](SpringCloudç¬”è®° .assets/image-20210922143348626.png)

å®é™…å¼€å‘æ—¶ï¼Œé€šå¸¸ä½¿ç”¨æ¨ªå‘æ‹†åˆ†

æœåŠ¡æ‹†åˆ†çš„æ³¨æ„äº‹é¡¹ï¼š

+ æ¯ä¸ªæœåŠ¡çš„åŠŸèƒ½æœ‰è¾¹ç•Œï¼Œå› æ­¤æ¯ä¸ªæœåŠ¡è®¿é—®çš„æ•°æ®ä¹Ÿæ˜¯æœ‰è¾¹ç•Œçš„ï¼Œæ‰€ä»¥æ¯ä¸ªæœåŠ¡éƒ½æœ‰è‡ªå·±çš„æ•°æ®åº“
+ æ¯ä¸ªæœåŠ¡çš„æ•°æ®åº“åªé™äºè‡ªå·±ç›´æ¥è®¿é—®ï¼Œå…¶ä»–æœåŠ¡ä¸èƒ½ç›´æ¥è®¿é—®
+  æœåŠ¡è°ƒç”¨ï¼šğŸ·ï¸å¦‚æœä¸€ä¸ªæœåŠ¡éœ€è¦å…¶ä»–æœåŠ¡çš„æ•°æ®ï¼Œåˆ™å¯ä»¥é€šè¿‡è°ƒç”¨å…¶ä»–æœåŠ¡å¯¹å¤–æš´éœ²çš„æ¥å£ï¼Œè®¿é—®åˆ°å…¶ä»–æœåŠ¡çš„æ•°æ®

ä¸ºäº†å®ç°æœåŠ¡è°ƒç”¨ï¼Œä¸¤ä¸ªæœåŠ¡æ˜¯ä¸¤ä¸ªä¸åŒçš„è¿›ç¨‹ï¼Œä¸¤è€…ä¹‹é—´è¦å»ºç«‹è¿æ¥ã€‚æœåŠ¡è°ƒç”¨ï¼Œ**è°ƒç”¨çš„æ˜¯æ–¹æ³•**ï¼Œä½†æ˜¯è¿æ¥ä¼ è¾“çš„æ˜¯äºŒè¿›åˆ¶å­—èŠ‚æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦å®šä¹‰åè®®å¯¹æ•°æ®è¿›è¡Œç¼–ç å’Œè§£æã€‚è¿˜éœ€è¦å®ç°**æœåŠ¡æ²»ç†**åŠŸèƒ½ï¼Œæ¯”å¦‚æœåŠ¡çš„æ³¨å†Œå’Œè‡ªåŠ¨å‘ç°ï¼ŒæœåŠ¡è°ƒç”¨çš„è´Ÿè½½å‡è¡¡ã€‚

æœåŠ¡è°ƒç”¨ï¼ŒæœåŠ¡æ²»ç†è¿™ç§é€šç”¨åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨å·²ç»å­˜åœ¨æ¡†æ¶ï¼Œä»è€Œè®©æˆ‘ä»¬åªä¸“æ³¨äºä¸šåŠ¡ä»£ç ã€‚å·²ç»å­˜åœ¨çš„æ¡†æ¶æœ‰SpringCloudå’ŒDubboã€‚

# å¾®æœåŠ¡çš„å®ç°

![](SpringCloudç¬”è®° .assets/å¾®æœåŠ¡é¡¹ç›®.png)

ä¸€ä¸ªå¾®æœåŠ¡æ¶æ„çš„é¡¹ç›®ï¼Œå¤§è‡´ç»“æ„å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå› ä¸ºæ¯ä¸ªæœåŠ¡ç‹¬ç«‹è¿è¡Œï¼Œç‹¬ç«‹éƒ¨ç½²ï¼Œæ‰€ä»¥æƒ³è¦å°†å¾®æœåŠ¡æ¶æ„åœ¨é¡¹ç›®ä¸­è½åœ°ï¼Œè¿˜éœ€è¦è§£å†³ä¸€äº›å…¶ä»–é—®é¢˜ï¼Œ**æœåŠ¡ä¹‹é—´çš„è°ƒç”¨**ï¼Œ**æœåŠ¡çš„æ²»ç†**ï¼Œæ¯”å¦‚æœåŠ¡çš„æ³¨å†Œä¸è‡ªåŠ¨å‘ç°ï¼ŒæœåŠ¡è°ƒç”¨çš„è´Ÿè½½å‡è¡¡ç­‰ç­‰ã€‚

è€Œè¿™äº›é—®é¢˜ï¼Œéƒ½ç”±ç›¸åº”çš„æœåŠ¡æ¡†æ¶ï¼Œå·²ç»å¸®åŠ©æˆ‘ä»¬å®ç°äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨å®ç°å¾®æœåŠ¡æ¶æ„çš„é¡¹ç›®ï¼Œéƒ½éœ€è¦åŸºäºæŸä¸ªå¾®æœåŠ¡çš„æ¡†æ¶ï¼Œç›®å‰æ¯”è¾ƒæµè¡Œçš„æœ‰å¤§æ¦‚æœ‰ä¸¤ç§SpringCloudå’ŒDubboï¼Œæˆ‘ä»¬çš„å­¦ä¹ ä¸»è¦åŸºäºSæ¡†æ¶SpringCloudã€‚

ä¸¤ä¸ªæ¡†æ¶çš„ä½¿ç”¨æ–¹å‘æœ‰æ‰€åŒºåˆ«ï¼ŒDubboæ•ˆç‡æ›´é«˜ï¼Œå¤§å‚ä½¿ç”¨ã€‚ä¸­å°å…¬å¸ä½¿ç”¨SpringCloudå±…å¤šã€‚

SpringCloud åŸºäºSpringBootæä¾›äº†ä¸€å¥—å¾®æœåŠ¡æ¶æ„å®ç°çš„è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬æœåŠ¡çš„æ³¨å†Œä¸è‡ªåŠ¨å‘ç°ï¼Œé¢å‘æ¥å£çš„æœåŠ¡è°ƒç”¨ï¼ŒæœåŠ¡è°ƒç”¨çš„**è´Ÿè½½å‡è¡¡ï¼ŒæœåŠ¡ç½‘å…³ï¼ŒæœåŠ¡ç†”æ–­**ç­‰ç­‰ç»„ä»¶ï¼Œå®ƒåˆ©ç”¨SpringBootå¼€å‘çš„ä¾¿åˆ©æ€§ï¼Œå·§å¦™çš„ç®€åŒ–äº†åˆ†å¸ƒå¼ç³»ç»Ÿçš„**åŸºç¡€è®¾æ–½æ­å»º**ï¼Œä½¿å¼€å‘è€…å¯ä»¥åŸºäºSpringBootçš„å¼€å‘é£æ ¼åšåˆ°å¿«é€Ÿå¯åŠ¨å’Œéƒ¨ç½²ã€‚

>  ğŸ·ï¸APIç½‘å…³
>
> å¾®æœåŠ¡é¡¹ç›®å¿…é¡»å…·æœ‰ã€‚æ ¸å¿ƒåŠŸèƒ½æ˜¯å¯¹å¤–æ¥æ”¶è¯·æ±‚ï¼Œå¯¹å†…è¿›è¡Œè·¯ç”±ã€‚æ˜¯åç«¯å¼€å‘çš„ä¸€éƒ¨åˆ†ã€‚
>
> ğŸ·ï¸ CDNç½‘ç»œ
>
> **å†…å®¹åˆ†å‘ç½‘ç»œ**ï¼ŒContentDeliveryNetworkã€‚ç”¨æ¥æä¾›é™æ€èµ„æºã€‚ç”±å¤šä¸ªCDNæœåŠ¡å™¨æ„æˆä¸€ä¸ªCDNç½‘ç»œã€‚
>
> ä¸æƒ³è¦é™æ€èµ„æºæµªè´¹å¸¦å®½ï¼Œå¸Œæœ›å¿«é€Ÿè®¿é—®é™æ€èµ„æºã€‚å¤§å‹äº‘æœåŠ¡æä¾›å•†æ‰æœ‰èƒ½åŠ›æä¾›CDNç½‘ç»œæœåŠ¡ï¼Œå› ä¸ºä¸åŒçš„CDNæœåŠ¡å™¨åœ¨åœ°ç†ä½ç½®ä¸Šä¸åŒï¼ŒCDNæœåŠ¡å™¨é‡Œæ—©å°±å‡†å¤‡å¥½äº†é™æ€èµ„æºã€‚å½“ä»CDNç½‘ç»œè¯·æ±‚é™æ€èµ„æºæ—¶ï¼ŒCDNç½‘ç»œä¼šä»ç¦»ç”¨æˆ·æœ€è¿‘çš„CDNæœåŠ¡å™¨è¿”å›é™æ€èµ„æºï¼Œä½¿ç”¨æˆ·æ›´å¿«é€Ÿçš„æ‹¿åˆ°é™æ€èµ„æºã€‚

> Mavençˆ¶å­å·¥ç¨‹
> å¦‚æœå­å·¥ç¨‹ä¸­ä¸éœ€è¦çˆ¶å·¥ç¨‹ä¸­çš„ä¸€äº›ä¾èµ–å‘¢ï¼Ÿä½†æ˜¯ç»§æ‰¿ä¸‹æ¥ï¼Œå·¥ç¨‹æ‰“åŒ…ä¸ºjaræ—¶ä¹Ÿä¼šå°†ä¸éœ€è¦çš„ä¾èµ–æ‰“åŒ…è¿›æ¥ã€‚
>
> æ‰€ä»¥çˆ¶å·¥ç¨‹é‡Œçš„ä¾èµ–åº”è¯¥æ˜¯å­å·¥ç¨‹è¦æœ‰çš„ã€‚åœ¨çˆ¶å·¥ç¨‹é‡Œå®šä¹‰`<dependencyMangement>`ï¼Œ**åªå£°æ˜æœªå¼•å…¥**ï¼Œå½“å„ä¸ªå­å·¥ç¨‹éœ€è¦ä½¿ç”¨æ—¶ï¼Œè¿˜æ˜¯éœ€è¦å£°æ˜ä¾èµ–ï¼Œä½†æ˜¯å­å·¥ç¨‹å¯ä»¥ä¸ç”¨å†™ç‰ˆæœ¬ï¼Œè€Œæ˜¯çˆ¶å·¥ç¨‹å£°æ˜çš„ä¾èµ–ç‰ˆæœ¬ã€‚è¿™æ ·å°±å¯ä»¥é¿å…ä¾èµ–ç‰ˆæœ¬çš„å†²çªã€‚
>
> æ³¨æ„ï¼šä¸€ä¸ªå­å·¥ç¨‹åªèƒ½æœ‰ä¸€ä¸ªçˆ¶å·¥ç¨‹
>
> SpringBootå·¥ç¨‹å¤©ç”Ÿæœ‰ä¸€ä¸ªçˆ¶å·¥ç¨‹ï¼Œè€Œæˆ‘ä»¬ä½¿ç”¨springCloudæ—¶è¦ä½¿ç”¨åˆ°spring-cloud,spring-cloud-alibaba,spring-bootè¿™ä¸‰ä¸ªä¸œè¥¿ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸åˆ›å»ºSpringBootå·¥ç¨‹è€Œæ˜¯åˆ›å»ºæ™®é€šMavenå·¥ç¨‹ã€‚
>
> å¦‚ä½•æ•´åˆçˆ¶å­å·¥ç¨‹ï¼Œåœ¨æ“ä½œç³»ç»Ÿä¸­ç›´æ¥å°†å­å·¥ç¨‹çš„æ–‡ä»¶å¤¹æ”¾åœ¨çˆ¶å·¥ç¨‹çš„pom.xmlæ‰€åœ¨æ–‡ä»¶å¤¹ä¸‹ã€‚

## æœåŠ¡è°ƒç”¨çš„åœºæ™¯

å¡«å†™å¹¶æ ¸å¯¹è®¢å•ä¿¡æ¯

è®¢å•æœåŠ¡åœ¨ä¸‹å•æ—¶è¦è°ƒç”¨ç”¨æˆ·æœåŠ¡æ¥è·å–ç”¨æˆ·çš„åœ°å€ä¿¡æ¯ã€‚

## æœåŠ¡é—´çš„è°ƒç”¨

å®é™…ä¸Šï¼Œåœ¨åŸºäºSpringCloudå®ç°çš„å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œä¸€ä¸ªå¾®æœåŠ¡å®ä¾‹(è¿›ç¨‹)çš„æœ¬è´¨ï¼Œ**å°±æ˜¯ä¸€ä¸ªéƒ¨ç½²åœ¨Tomcatä¸­çš„ï¼Œæ»¡è¶³å•ä¸€èŒè´£åŸåˆ™çš„åº”ç”¨ç¨‹åºã€‚**ä¹Ÿå°±æ˜¯å¤©ç”Ÿæ”¯æŒHTTPåè®®ï¼Œä¹Ÿå°±è¯´æœåŠ¡é—´è°ƒç”¨çš„åè®®å¯ä»¥ä½¿ç”¨HTTPåè®®ã€‚

ä½†æ­¤æ—¶å°±æœ‰ä¸€ä¸ªé—®é¢˜äº†ï¼Œå¦‚æœä¸€ä¸ªæœåŠ¡æƒ³è¦ä½¿ç”¨å¦ä¸€ä¸ªæœåŠ¡çš„åŠŸèƒ½ï¼Œå³ä¸€ä¸ªæœåŠ¡æƒ³è¦è°ƒç”¨å¦ä¸€ä¸ªæœåŠ¡ï¼Œé‚£ä¹ˆæœåŠ¡ä¹‹é—´çš„è°ƒç”¨å¦‚ä½•å®ç°å‘¢ï¼Ÿè°ƒç”¨å¦ä¸€ä¸ªæœåŠ¡çš„controlleræ–¹æ³•ã€‚é‚£ä¹ˆ**å¦‚ä½•é€šè¿‡JAVAä»£ç å‘é€HTTPè¯·æ±‚ï¼Ÿ**è¿™å°±æ˜¯å­¦ä¹ çš„é‡ç‚¹

> å‘é€HTTPè¯·æ±‚çš„æ–¹å¼ï¼š
>
> + é€šè¿‡æµè§ˆå™¨å‘é€
>
> + é€šè¿‡Postmanå‘é€
> + é€šè¿‡JAVAä»£ç å‘é€

### æœåŠ¡è°ƒç”¨çš„ç†è®º

ä¸¤ä¸ªæœåŠ¡æ˜¯ä¸¤ä¸ªä¸åŒçš„è¿›ç¨‹ï¼Œè¿›ç¨‹é—´é€šä¿¡ä½¿ç”¨ç½‘ç»œçš„æ–¹å¼ã€‚

å®é™…ä¸Šï¼ŒæœåŠ¡é—´çš„è°ƒç”¨ï¼ŒåŸºäºæˆ‘ä»¬ä»¥å‰å­¦ä¹ è¿‡çš„çŸ¥è¯†ï¼Œå°±å¯ä»¥è½»æ¾è§£å†³ï¼š

- åŸºäºSpringCloudå®ç°çš„å¾®æœåŠ¡ï¼Œå…¶æœ¬è´¨æ˜¯Tomcatä¸­çš„ä¸€ä¸ªåº”ç”¨ï¼Œå®ƒä»¬éƒ½æ”¯æŒåŸºäºHttpåè®®çš„é€šä¿¡ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡Httpåè®®å®ç°æœåŠ¡è¿›ç¨‹(å®ä¾‹)é—´çš„é€šä¿¡
- äºæ˜¯æœåŠ¡é—´çš„é€šä¿¡è¿‡ç¨‹å°±å˜æˆäº†ï¼Œè°ƒç”¨è€…å‘é€Httpè¯·æ±‚ï¼Œè¢«è°ƒç”¨è¿™è¿”å›Httpå“åº”ï¼Œä¸€æ¬¡è¯·æ±‚å“åº”è¿‡ç¨‹ï¼Œå°±ç­‰ä»·äºä¸€æ¬¡æœåŠ¡è°ƒç”¨è¿‡ç¨‹
- åœ¨ä¸€æ¬¡æœåŠ¡è°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç§°è°ƒç”¨è€…ä¸º**æœåŠ¡æ¶ˆè´¹è€…**(ä½¿ç”¨æˆ–è€…æ¶ˆè´¹å¦ä¸€ä¸ªæœåŠ¡çš„åŠŸèƒ½)ï¼Œæˆ‘ä»¬ç§°è¢«è°ƒç”¨è€…ä¸º**æœåŠ¡æä¾›è€…**(æä¾›è¢«æ¶ˆè´¹çš„åŠŸèƒ½)

å› æ­¤ï¼ŒæœåŠ¡æä¾›è€…åªè¦å¯¹å¤–æš´éœ²äº†æ¥å£ï¼Œé‚£ä¹ˆæœåŠ¡æ¶ˆè´¹è€…å°±èƒ½é€šè¿‡è°ƒç”¨æœåŠ¡æä¾›è€…å¯¹å¤–æä¾›çš„æ¥å£ï¼Œä»è€Œå®ç°å¯¹æœåŠ¡æä¾›è€…çš„è°ƒç”¨ï¼Œä½¿ç”¨æœåŠ¡æä¾›è€…çš„åŠŸèƒ½ã€‚

> å¦‚ä½•ç†è§£â€œå¯¹å¤–æš´éœ²çš„æ¥å£â€ï¼Ÿ
>
> Controllerå±‚çš„æ–¹æ³•ã€‚é€šè¿‡HTTPåè®®è°ƒç”¨æ–¹æ³•ï¼Œéœ€è¦æ¥æ”¶HTTPè¯·æ±‚ï¼Œåªæœ‰Controllerå±‚çš„æ–¹æ³•å¯ä»¥å¤„ç†HTTPè¯·æ±‚ã€‚

### å®ç°æœåŠ¡è°ƒç”¨çš„å‡†å¤‡`RestTemplate`

> å®ç°æœåŠ¡è°ƒç”¨çš„æ­¥éª¤
>
> 1. æ„é€ HTTPè¯·æ±‚
> 2. å‘é€HTTPè¯·æ±‚ï¼ˆå®ç°æœåŠ¡è°ƒç”¨ï¼‰
>
> é€šè¿‡æœåŠ¡è°ƒç”¨çš„ç†è®ºåˆ†æï¼Œæˆ‘ä»¬çŸ¥é“æœåŠ¡è°ƒç”¨å…¶å®å°±æ˜¯å‘é€Httpè¯·æ±‚ï¼Œæ¥æ”¶Httpå“åº”çš„è¿‡ç¨‹ï¼Œåœ¨å®ç°æœåŠ¡è°ƒç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ â­**å¦‚ä½•é€šè¿‡ä»£ç å‘é€Httpè¯·æ±‚**â€”â€”ä½¿ç”¨`RestTemplate`ã€‚

`RestTemplate`æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨æ¥å‘é€Httpè¯·æ±‚çš„å·¥å…·ï¼Œé€šè¿‡å°è£…JDKä¸­çš„`HttpURLConnection`ç±»åº“ï¼Œæä¾›ç®€å•æ˜“ç”¨çš„æ¨¡æ¿æ–¹æ³•APIï¼Œå®ƒæ‰€æä¾›çš„æ¨¡æ¿æ–¹æ³•å‡ ä¹è¦†ç›–äº†å¸¸ç”¨çš„æ‰€æœ‰Httpè¯·æ±‚ç±»å‹çš„åœºæ™¯ã€‚

æˆ‘ä»¬é€šå¸¸ä½¿ç”¨å…¶æ— å‚æ„é€ æ–¹æ³•ï¼Œæ¥è·å–ä¸€ä¸ª`RestTemplate`å¯¹è±¡

```java
RestTemplate()
Create a new instance of the RestTemplate using default settings.
```

åŒæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ª`RestTemplate`å¯¹è±¡ï¼Œå‘èµ·`POST`,`GET`,`DELETE`,`PUT`,`PATCH` ç­‰ä¸åŒç§ç±»çš„Httpè¯·æ±‚ï¼Œæˆ‘ä»¬ä»¥æœ€å¸¸ç”¨çš„`GET`å’Œ`POST`ä¸¤ç§æ–¹å¼ä¸ºä¾‹æ¥å­¦ä¹ `RestTemplate`çš„ç”¨æ³•ã€‚

```java
// RestTemplateçš„API
/*
	å½“æˆ‘ä»¬åªæƒ³è¦è·å–ä¸€ä¸ªGETè¯·æ±‚çš„ç»“æœçš„æ—¶å€™ï¼Œå¯ä»¥è°ƒç”¨å…¶getForObjectæ–¹æ³•ï¼Œå…¶ä¸­
	String url: å‘èµ·è¯·æ±‚çš„url
	Class<T> responseType: å“åº”ä½“è¿”å›å€¼ç±»å‹
	ç¬¬ä¸‰ä¸ªå‚æ•°: è¡¨ç¤ºGETè¯·æ±‚æºå¸¦çš„å‚æ•°
*/
public <T> T getForObject(String url, Class<T> responseType, Map<String,?> uriVariables)
// Mapçš„keyæ˜¯ç”¨æ¥æŒ‡æ˜å“ªä¸ªå ä½ç¬¦ 
public <T> T getForObject(String url,Class<T> responseType, Object... uriVariables)

/* 
    å¦‚æœæˆ‘ä»¬ä¸ä»…æƒ³è¦è·å–GETè¯·æ±‚çš„å“åº”ä½“æ•°æ®ï¼Œè¿˜æƒ³è·å–å“åº”å¤´ï¼Œä»¥åŠå“åº”ç ç­‰ä¿¡æ¯ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨getForEntityæ–¹æ³•ï¼Œå…¶ä¸­
	String url: GETè¯·æ±‚çš„url
	Class<T> responseTypeï¼š å“åº”ä½“è¿”å›å€¼ç±»å‹
	ç¬¬ä¸‰ä¸ªå‚æ•°: è¡¨ç¤ºGETè¯·æ±‚æºå¸¦çš„å‚æ•°
*/
  // è¿™é‡Œçš„æ³›å‹ç±»å‹æŒ‡çš„æ˜¯å“åº”ä½“ä¸­çš„æ•°æ®ç±»å‹ 
public <T> ResponseEntity<T> getForEntity(String url, Class<T> responseType, Object... uriVariables)
public <T> ResponseEntity<T> getForEntity(String url, Class<T> responseType, Map<String,?> uriVariables)
    
/*
	å½“æˆ‘ä»¬åªæƒ³è¦è·å–ä¸€ä¸ªPOSTè¯·æ±‚çš„ç»“æœçš„æ—¶å€™ï¼Œå¯ä»¥è°ƒç”¨å…¶postForObjectæ–¹æ³•ï¼Œå…¶ä¸­
	String url: å‘èµ·è¯·æ±‚çš„url
	requestï¼šè¡¨ç¤ºpostè¯·æ±‚çš„è¯·æ±‚ä½“æ•°æ®ï¼Œä¹Ÿå¯ä»¥ä¸ä¼ è¿™ä¸ªå‚æ•°
	Class<T> responseType: å“åº”ä½“è¿”å›å€¼ç±»å‹
	ç¬¬ä¸‰ä¸ªå‚æ•°: è¡¨ç¤ºGETè¯·æ±‚æºå¸¦çš„å‚æ•°
*/
public <T> T postForObject(String url, @Nullable Object request, Class<T> responseType, Map<String,?> uriVariables)
public <T> T postForObject(URI url, @Nullable Object request, Class<T> responseType)
    
/* 
    å¦‚æœæˆ‘ä»¬ä¸ä»…æƒ³è¦è·å–GETè¯·æ±‚çš„å“åº”ä½“æ•°æ®ï¼Œè¿˜æƒ³è·å–å“åº”å¤´ï¼Œä»¥åŠå“åº”ç ç­‰ä¿¡æ¯ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨getForEntityæ–¹æ³•ï¼Œå…¶ä¸­
	String url: POSTè¯·æ±‚çš„url
	Object requestï¼š è¡¨ç¤ºpostè¯·æ±‚çš„è¯·æ±‚ä½“æ•°æ®ï¼Œä¹Ÿå¯ä»¥ä¸ä¼ è¿™ä¸ªå‚æ•°
	Class<T> responseTypeï¼š å“åº”ä½“è¿”å›å€¼ç±»å‹
	ç¬¬ä¸‰ä¸ªå‚æ•°: è¡¨ç¤ºGETè¯·æ±‚æºå¸¦çš„å‚æ•°
*/
public <T> ResponseEntity<T> postForEntity(String url, @Nullable Object request, Class<T> responseType, Object... uriVariables)
public <T> ResponseEntity<T> postForEntity(String url, @Nullable Object request, Class<T> responseType, Map<String,?> uriVariables)
```

æˆ‘ä»¬ä»¥å‘é€GETè¯·æ±‚ä¸ºä¾‹æ¥è¯´æ˜ï¼š

```java
// å‡†å¤‡å¥½è¯·æ±‚çš„urlï¼Œæºå¸¦åä¸ºnameçš„è¯·æ±‚å‚æ•°ï¼Œå ä½ç¬¦çš„åç§°ä¸ºname 
String url = "http://localhost:8002/say/hello?name={name}";
// mapä¸­å‚æ•°å€¼çš„keyä¸€å®šè¦å’Œurlä¸­å‚æ•°çš„å ä½ç¬¦åŒå
HashMap<String, Object> param = new HashMap<>();
param.put("name", name);
//mapå‚æ•°æ–¹å¼
String rest = restTemplate.getForObject(url, String.class, param);
```

```java
/*
  å‡†å¤‡å¥½è¯·æ±‚çš„urlï¼Œæºå¸¦åä¸ºnameçš„è¯·æ±‚å‚æ•°ï¼Œå ä½ç¬¦çš„åç§°å°±ä¸é‡è¦äº†ï¼Œå› ä¸ºé€šè¿‡å¯å˜å‚æ•°å¯ä»¥é€šè¿‡å‚æ•°ä½ç½®ç¡® å®šè¯·æ±‚å‚æ•°å¯¹åº”å‚æ•°å€¼
*/
String url = "http://localhost:8002/say/hello?name={1}";
// ç”¨å¯å˜å‚æ•°çš„æ–¹å¼æ¥ä¼ é€’è¯·æ±‚å‚æ•°, è¿™é‡Œåªæœ‰ä¸€ä¸ªå‚æ•°å€¼name
String rest = restTemplate.getForObject(url,String.class, name);
```

```java
// è·å–æ›´å®Œæ•´çš„å“åº”ä¿¡æ¯
ResponseEntity<String> forEntity = restTemplate.getForEntity(url, String.class);
// è·å–httpå“åº”çš„å“åº”ç 
HttpStatus statusCode = forEntity.getStatusCode();
System.out.println(statusCode);
// è¿”å›å“åº”ä½“æ•°æ®
return forEntity.getBody();
```

### æœåŠ¡è°ƒç”¨çš„å®ç°

#### è¢«è°ƒç”¨æ¥å£

é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªæœåŠ¡æ¶ˆè´¹è€…è°ƒç”¨æœåŠ¡æä¾›è€…çš„ä¾‹å­ï¼Œå‡è®¾æœåŠ¡æä¾›è€…å¯¹å¤–æš´éœ²çš„æ¥å£ä¸º

| å…¥å‚   | ç±»å‹ |
| ------ | ---- |
| userId | Long |

è¯·æ±‚è·¯å¾„ï¼š/user/address/{userId}

è¯·æ±‚ç±»å‹: GET

è¯·æ±‚ç¤ºä¾‹ï¼š

http://localhost:9001/user/address/{userId}

| å‡ºå‚    | ç±»å‹   |
| ------- | ------ |
| address | String |

#### çˆ¶å·¥ç¨‹ä¾èµ–

å› ä¸ºä»£ç åŒ…å«å¤šä¸ªmavenå·¥ç¨‹ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨çˆ¶å­å·¥ç¨‹æ¥å®ç°ï¼Œåˆ›å»ºçˆ¶å·¥ç¨‹ï¼Œçˆ¶å·¥ç¨‹ä¸­å¹¶ä¸åŒ…å«ä»£ç ï¼Œä¸»è¦ç”¨æ¥ç®¡ç†å­Mavenå·¥ç¨‹

![](.\assets\springcloudé¡¹ç›®ç»“æ„.png)

```xml
<properties>
    <spring-boot.version>2.2.2.RELEASE</spring-boot.version>
    <spring-cloud.version>Hoxton.SR1</spring-cloud.version>
    <spring-cloud-alibaba.version>2.2.0.RELEASE</spring-cloud-alibaba.version>
    <mysql.version>8.0.20</mysql.version>
    <mybatis.version>2.1.1</mybatis.version>
    <lombok.verion>1.18.8</lombok.verion>
</properties>
<dependencyManagement>
    <dependencies>
        <!-- spring-boot -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-dependencies</artifactId>
            <version>${spring-boot.version}</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>

        <!--spring cloud alibaba-->
        <dependency>
            <groupId>com.alibaba.cloud</groupId>
            <artifactId>spring-cloud-alibaba-dependencies</artifactId>
            <version>${spring-cloud-alibaba.version}</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>

        <!--spring cloud-->
        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-dependencies</artifactId>
            <version>${spring-cloud.version}</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>

        <!-- mysqlé©±åŠ¨ -->
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>${mysql.version}</version>
        </dependency>
        <!--mybatis-->
        <dependency>
            <groupId>org.mybatis.spring.boot</groupId>
            <artifactId>mybatis-spring-boot-starter</artifactId>
            <version>${mybatis.version}</version>
        </dependency>

        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <version>${lombok.verion}</version>
        </dependency>
    </dependencies>
</dependencyManagement>
```

#### æœåŠ¡æä¾›è€…å®ç°

ä¾èµ–å¦‚ä¸‹

```xml
<dependencies>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>

    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
    </dependency>
    <!--mybatis-->
    <dependency>
        <groupId>org.mybatis.spring.boot</groupId>
        <artifactId>mybatis-spring-boot-starter</artifactId>
    </dependency>

    <dependency>
        <groupId>org.projectlombok</groupId>
        <artifactId>lombok</artifactId>
    </dependency>
</dependencies>
```

é…ç½®å¦‚ä¸‹

```yml
server:
  port: 9001
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/demo_user?useSSL=false&serverTimezone=Asia/Shanghai
    username: root
    password: xxxxxx
    driver-class-name: com.mysql.jdbc.Driver
```

ä»£ç å¦‚ä¸‹(SpringBootå·¥ç¨‹çš„å¯åŠ¨ç±»å°±ä¸å±•ç¤ºäº†)

```java
@RestController
@RequestMapping("/user")
public class UserController {

    @Autowired
    private UserService userService;
    
    /**
     * @param id ç”¨æˆ·id
     * @return ç”¨æˆ·
     */
    @GetMapping("/address/{id}")
    public String queryById(@PathVariable("id") Long id) {
        // æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·çš„åœ°å€ä¿¡æ¯
        return userService.queryById(id);
    }
}
```

```java
@Service
public class UserService {

    @Autowired
    private UserMapper userMapper;

    public String queryById(Long id) {
        User user = userMapper.findById(id);
        return user.getAddress();
    }
}
```

#### æœåŠ¡æ¶ˆè´¹è€…å®ç°

ä¾èµ–å¦‚ä¸‹

```xml
<dependencies>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>

    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
    </dependency>
    <!--mybatis-->
    <dependency>
        <groupId>org.mybatis.spring.boot</groupId>
        <artifactId>mybatis-spring-boot-starter</artifactId>
    </dependency>

    <dependency>
        <groupId>org.projectlombok</groupId>
        <artifactId>lombok</artifactId>
    </dependency>
</dependencies>
```

é…ç½®å¦‚ä¸‹

```yaml
server:
  port: 9002
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/demo_order?useSSL=false&serverTimezone=Asia/Shanghai
    username: root
    password: xxxxxx
    driver-class-name: com.mysql.jdbc.Driver
```

ä»£ç å¦‚ä¸‹

å…ˆå‡†å¤‡å¥½ä¸€ä¸ªç”¨äºå‘èµ·`Http`è¯·æ±‚çš„`RestTemplate`å¯¹è±¡

```java
@Configuration
public class ClientConfig {

    @Bean
    @LoadBalanced
    public RestTemplate template() {
        return new RestTemplate();
    }
}
```

```java
@RestController
@RequestMapping("order")
public class OrderController {

   @Autowired
   private OrderService orderService;

    @GetMapping("{orderId}")
    public Order queryOrderByUserId(@PathVariable("orderId") Long orderId) {
        // æ ¹æ®idæŸ¥è¯¢è®¢å•å¹¶è¿”å›
        return orderService.queryOrderById(orderId);
    }
}
```

```java
@Service
public class OrderService {

    @Autowired
    private OrderMapper orderMapper;


    @Autowired
    private RestTemplate restTemplate;

    public Order queryOrderById(Long orderId) {
        // 1.æŸ¥è¯¢è®¢å•
        Order order = orderMapper.findById(orderId);
        // 2.åˆ©ç”¨RestTemplateå‘èµ·httpè¯·æ±‚ï¼ŒæŸ¥è¯¢ç”¨æˆ·
        // 2.1.urlåœ°å€
        String url = "http://localhost:9001/user/address/{userId}";
        // 2.2.å‘é€httpè¯·æ±‚ï¼Œå®ç°è¿œç¨‹è°ƒç”¨
        String userAddress = restTemplate.getForObject(url, String.class,order.getUserId());
        // 3.å°è£…useråˆ°Order
        order.setUserAdress(userAddress);
        // 4.è¿”å›
        return order;
    }
}
```

> ğŸ·ï¸ æ–°çš„é—®é¢˜
>
> å¤šä¸ªè®¢å•æœåŠ¡è¿›ç¨‹ï¼Œä»£è¡¨å¤šä¸ªè®¢å•æœåŠ¡å®ä¾‹ï¼Œå¯ä»¥ç»„æˆè®¢å•æœåŠ¡é›†ç¾¤ã€‚ä½†æ˜¯urlé‡Œå°†ç«¯å£å·å†™å®šäº†ï¼Œåªèƒ½å‘ç»™ä¸€ä¸ªæœåŠ¡å™¨ã€‚

å¦‚æœä¸€ä¸ªæœåŠ¡æ¶ˆè´¹è€…å®ä¾‹å¯ä»¥**è‡ªåŠ¨å‘ç°æœåŠ¡æä¾›è€…**å°±å¯ä»¥è§£å†³äº†ã€‚è¿™å°±éœ€è¦ä½¿ç”¨æ–°çš„ç»„ä»¶ï¼ŒæœåŠ¡æ³¨å†Œä¸­å¿ƒã€‚

æœåŠ¡å®ä¾‹ï¼Œåœ¨**å¯åŠ¨çš„æ—¶å€™**ä¼šå‘æœåŠ¡æ³¨å†Œä¸­å¿ƒæ³¨å†Œï¼Œæ³¨å†ŒæœåŠ¡å®ä¾‹æ‰€å±çš„æœåŠ¡åç§°ï¼Œipåœ°å€ï¼Œç«¯å£å·ã€‚

æœåŠ¡æ³¨å†Œä¸­å¿ƒå’ŒæœåŠ¡çš„äº¤äº’è¿‡ç¨‹ï¼š

1. æœåŠ¡å®ä¾‹åœ¨å¯åŠ¨çš„æ—¶å€™ï¼Œå‘æœåŠ¡æ³¨å†Œä¸­å¿ƒæ³¨å†Œï¼Œä¸Šä¼ ä¿¡æ¯
2. æœåŠ¡æ³¨å†Œä¸­å¿ƒå®æ—¶è·å–æœåŠ¡å®ä¾‹çš„çŠ¶æ€
   1. é˜²æ­¢æœåŠ¡æ¶ˆè´¹è€…å®ä¾‹æ— æ³•è®¿é—®æˆåŠŸ
3. æœåŠ¡å®ä¾‹ä»æ³¨å†Œä¸­å¿ƒä¸‹è½½æœåŠ¡å®ä¾‹åœ°å€åˆ—è¡¨
4. æ³¨å†Œä¸­å¿ƒè¿˜éœ€è¦ç»™æœåŠ¡å®ä¾‹åŒæ­¥æœ€æ–°çš„æœåŠ¡å®ä¾‹åˆ—è¡¨ä¿¡æ¯

> ä¸€ä¸ªè¿›ç¨‹å¦‚ä½•æ„ŸçŸ¥å¦ä¸€ä¸ªè¿›ç¨‹çš„çŠ¶æ€ï¼Ÿ
>
> é€šè¿‡å¿ƒè·³åè®®

## æœåŠ¡çš„æ³¨å†Œä¸å‘ç°

æœåŠ¡é—´è°ƒç”¨çš„é—®é¢˜ï¼Œä½†æ˜¯ä»…ä»…å®ç°åˆ°è¿™ç§ç¨‹åº¦ï¼Œè¿˜è¿œè¿œä¸å¤Ÿ

### é—®é¢˜çš„å¼•å‡º

é¦–å…ˆå›é¡¾ä¸€ä¸‹ï¼Œå¯¹äºæœåŠ¡æ¶ˆè´¹è€…è€Œè¨€ï¼Œå®ƒå¦‚ä½•çŸ¥é“æœåŠ¡æä¾›è€…çš„ä¿¡æ¯ï¼Œä»è€Œè°ƒç”¨è¿œç¨‹æœåŠ¡çš„åŠŸèƒ½å‘¢? å†æ¥çœ‹çœ‹ä»£ç 

```java
String url = "http://localhost:9001/user/address/{userId}";
// å®ç°è¿œç¨‹è°ƒç”¨
String userAddress = restTemplate.getForObject(url, String.class, order.getUserId());
```

ä½†æ˜¯ï¼Œå°†æœåŠ¡æ¶ˆè´¹è€…è¦è°ƒç”¨çš„æœåŠ¡æä¾›è€…åœ°å€å†™æ­»ï¼Œè¿™æ ·å¥½å—ï¼Ÿæˆ‘ä»¬æ¥è®¾æƒ³å¦‚åœºæ™¯

![](.\assets\æ³¨å†Œä¸­å¿ƒå¼•å‡º.png)

- å‡è®¾å¯¹äºç”¨æˆ·æœåŠ¡çš„è¯·æ±‚é‡å¾ˆå¤§ï¼Œä¸€ä¸ªç”¨æˆ·æœåŠ¡å®ä¾‹(è¿›ç¨‹)å¤„ç†ä¸äº†è¿™ä¹ˆå¤šçš„è¯·æ±‚äº†ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥å¯åŠ¨å¤šä¸ªç”¨æˆ·æœåŠ¡å®ä¾‹(è¿›ç¨‹)ï¼Œæ­¤æ—¶ï¼Œè¿™å¤šä¸ªç”¨æˆ·æœåŠ¡å®ä¾‹å°±ç»„æˆäº†**ç”¨æˆ·æœåŠ¡çš„é›†ç¾¤**
- ä½†æ˜¯æˆ‘ä»¬å¦‚æœå†™æ­»äº†è°ƒç”¨çš„æœåŠ¡æä¾›è€…çš„åœ°å€ï¼Œå³ä½¿æœ‰ç”¨æˆ·æœåŠ¡çš„é›†ç¾¤ï¼Œæœ‰æ„ä¹‰å—ï¼Ÿæ²¡æœ‰ï¼Œå› ä¸ºå†™æ­»äº†æœåŠ¡è°ƒç”¨çš„åœ°å€ï¼Œæ‰€ä»¥æˆ‘ä»¬æ°¸è¿œåªèƒ½è°ƒç”¨åˆ°é›†ç¾¤ä¸­çš„ä¸€ä¸ªæœåŠ¡å®ä¾‹ï¼

 æ­¤æ—¶çŸ›ç›¾å°±å‡ºç°äº†ï¼ŒæœåŠ¡è°ƒç”¨æ—¶å¿…é¡»çŸ¥é“æœåŠ¡æä¾›è€…çš„åœ°å€ï¼Œä½†æ˜¯åœ¨ä»£ç é‡ŒæŠŠæ”¹åœ°å€å†™æ­»ï¼Œå°±æ°¸è¿œåªèƒ½è°ƒç”¨ç¡®å®šçš„é‚£ä¸€ä¸ªæœåŠ¡å®ä¾‹ï¼Œä½†æ˜¯å¦‚æœä¸åœ¨ä»£ç é‡Œå†™æœåŠ¡è°ƒç”¨çš„åœ°å€ï¼Œæˆ‘ä»¬åˆä»å“ªé‡Œå¾—åˆ°æœåŠ¡æä¾›è€…å®ä¾‹çš„åœ°å€å‘¢ï¼Ÿ

### æœåŠ¡æ³¨å†Œä¸­å¿ƒ

é‚£ä¹ˆï¼Œå¦‚æœåœ¨å®šä¹‰æœåŠ¡æ¶ˆè´¹è€…çš„æ—¶å€™ï¼Œä¸æŒ‡æ˜æœåŠ¡æ¶ˆè´¹è€…è°ƒç”¨çš„æœåŠ¡æä¾›è€…åœ°å€ï¼Œé‚£ä¹ˆæœåŠ¡æ¶ˆè´¹è€…æ€ä¹ˆçŸ¥é“å»å“ªé‡Œè°ƒç”¨æœåŠ¡æä¾›è€…å‘¢ï¼Ÿæ­¤æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦å¼•å…¥ä¸€ä¸ªæ–°çš„è§’è‰²â€”â€”æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œç”±æœåŠ¡æ³¨å†Œä¸­å¿ƒæ¥ç»Ÿä¸€ç®¡ç†æœåŠ¡çš„çŠ¶æ€å’Œä¿¡æ¯ï¼Œé‚£ä¹ˆè¿™ä¸ªé—®é¢˜å°±å¯ä»¥è§£å†³äº†ã€‚

![æœåŠ¡æ³¨å†Œä¸­å¿ƒ (1)](SpringCloudç¬”è®°  .assets/æœåŠ¡æ³¨å†Œä¸­å¿ƒ (1).png)

å¯¹äºæ¯ä¸€ä¸ªæœåŠ¡

- åœ¨æœåŠ¡å¯åŠ¨æ—¶ï¼Œä¼šå°†è‡ªå·±çš„ä¿¡æ¯ï¼Œæ³¨å†Œåˆ°æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œå…¶ä¸­å°±åŒ…æ‹¬ipåœ°å€ï¼Œç«¯å£å·ç­‰ä¿¡æ¯ã€‚å³å®ç°æœåŠ¡çš„æ³¨å†Œ
- åœ¨æœåŠ¡è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œä¼šå®æ—¶å‘æœåŠ¡æ³¨å†Œä¸­å¿ƒ"æŠ¥å‘Š"è‡ªå·±çš„çŠ¶æ€ï¼Œå› æ­¤æœåŠ¡æ³¨å†Œä¸­å¿ƒå°±å¯ä»¥å®æ—¶æ„ŸçŸ¥åˆ°æœåŠ¡çš„è¿è¡ŒçŠ¶æ€

- åŒæ—¶ï¼Œåœ¨æœåŠ¡å¯åŠ¨æ—¶ï¼Œä¹Ÿä¼šå»æ³¨å†Œä¸­å¿ƒæ‹‰å–ï¼Œå…¶ä»–æœåŠ¡ä¿¡æ¯ï¼Œå³å°†æœåŠ¡æ³¨å†Œè¡¨ä¿¡æ¯ä¸‹è½½åˆ°æœ¬åœ°ï¼Œè¿™æ ·ä¸€æ¥ä¸€ä¸ªæœåŠ¡å°±å¯ä»¥çŸ¥é“ï¼Œå…¶ä»–æœåŠ¡è°ƒç”¨åœ°å€ç­‰ä¿¡æ¯
- åœ¨æœåŠ¡è¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡ä¼šä»æ³¨å†Œä¸­å¿ƒå®æ—¶æ‹‰å–æœ€æ–°çš„æœåŠ¡æ³¨å†Œè¡¨ä¿¡æ¯ï¼Œä»è€Œå®ç°æœåŠ¡çš„å®æ—¶å‘ç°

é‚£ä¹ˆæœåŠ¡æ³¨å†Œä¸­å¿ƒéœ€è¦æˆ‘ä»¬è‡ªå·±å»å®ç°å—ï¼Ÿä¸æ˜¯ï¼Œå·²ç»æœ‰å¾ˆå¤šçš„æ³¨å†Œä¸­å¿ƒå®ç°ä¾›æˆ‘ä»¬ä½¿ç”¨äº†ï¼Œæ¯”å¦‚SpringCloud Netflixä¸­çš„**Eureka**ï¼Œæ¯”å¦‚SpringCloud Alibabaä¸­çš„**Nacos**ç­‰ç­‰ã€‚

> å¾®æœåŠ¡çš„é¼»ç¥–å°±æ˜¯Netflix

### Eureka æ³¨å†Œä¸­å¿ƒ

Eurekaæ˜¯å¦ä¸€ä¸ªå…¸å‹çš„C/Sæ¶æ„äº§å“ã€‚

![](SpringCloudç¬”è®° .assets/Eureka.png)

Eurekaæ˜¯SpringCloud Netflixä¸­åŒ…å«çš„æ³¨å†Œä¸­å¿ƒçš„ç»„ä»¶ï¼Œå®ƒæ‰®æ¼”æ³¨å†Œä¸­å¿ƒçš„è§’è‰²ï¼Œå®ç°æœåŠ¡çš„æ³¨å†Œä¸è‡ªåŠ¨å‘ç°ã€‚

Eurekaé‡‡ç”¨äº†C/Sçš„æ¶æ„è®¾è®¡ï¼Œå…¶ä¸­

- EurekaServerä½œä¸ºæœåŠ¡å™¨ç«¯ï¼Œå®ƒå…·ä½“å°±å®ç°äº†æœåŠ¡æ³¨å†Œä¸­å¿ƒçš„åŠŸèƒ½
- EurekaClientä½œä¸ºå®¢æˆ·ç«¯ï¼ŒæœåŠ¡æä¾›è€…å¯é€šè¿‡å®ƒå®ç°å’ŒEurekaServerçš„é€šä¿¡å®ŒæˆæœåŠ¡çš„æ³¨å†Œï¼ŒæœåŠ¡æ¶ˆè´¹è€…å¯é€šè¿‡å®ƒä¸EurekaServeré€šä¿¡å®ŒæˆæœåŠ¡çš„è‡ªåŠ¨å‘ç°

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±åŸºäºEurekaæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œå®ç°æœåŠ¡çš„æ³¨å†Œä¸è‡ªåŠ¨å‘ç°ã€‚

#### é…ç½®å¹¶å¯åŠ¨EurekaServer

> æ³¨æ„ï¼šä¸æ˜¯ç›´æ¥åˆ›å»ºä¸€ä¸ªSpringBootå·¥ç¨‹ï¼Œè€Œæ˜¯åˆ›å»ºä¸€ä¸ªæ™®é€šçš„Mavenå·¥ç¨‹ä¹‹åå†å†™`@SpringBootApplication`æ³¨è§£é…ç½®å¯åŠ¨ç±»

åœ¨çˆ¶å·¥ç¨‹ä¸­ï¼Œæ·»åŠ SpringCloudä¾èµ–

```xml
<!--springCloudçš„ä¾èµ–-->
<dependency>
   <groupId>org.springframework.cloud</groupId>
   <artifactId>spring-cloud-dependencies</artifactId>
   <version>Hoxton.SR1</version>
   <type>pom</type>
   <scope>import</scope>
</dependency>
```

æ–°å»ºä¸€ä¸ªå­Mavenå·¥ç¨‹ï¼Œè¿™ä¸ªå·¥ç¨‹ä»…ä»…åªæ˜¯ä¸ºäº†å¯åŠ¨ä¸€ä¸ª`EurekaServer`è¿›ç¨‹

![](SpringCloudç¬”è®° .assets/æ·»åŠ EurekaServer.png)

åœ¨å­å·¥ç¨‹ä¸­æ·»åŠ ä¾èµ–

```xml
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-netflix-eureka-server</artifactId>
</dependency>
```

åœ¨å­å·¥ç¨‹ä¸­éœ€è¦æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š

```yaml
server:
  port: 7001
# Eurekaé…ç½®
eureka:
  instance:
    # EurekaæœåŠ¡ç«¯çš„å®ä¾‹åå­—
    hostname: localhost
  client:
    # è¡¨ç¤ºæ˜¯å¦å‘ Eureka æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±(è¿™ä¸ªæ¨¡å—æœ¬èº«æ˜¯æœåŠ¡å™¨,æ‰€ä»¥ä¸éœ€è¦)
    register-with-eureka: false
    # fetch-registryå¦‚æœä¸ºfalse,åˆ™è¡¨ç¤ºè‡ªå·±ä¸ºæ³¨å†Œä¸­å¿ƒ,å®¢æˆ·ç«¯çš„ä¸º ture
    fetch-registry: false
    service-url:
      defaultZone: http://localhost:7001/eureka/
```

> æ³¨å†Œä¸­å¿ƒæ—¢ä¸è°ƒç”¨åˆ«çš„æœåŠ¡ï¼Œä¹Ÿä¸è¢«åˆ«çš„æœåŠ¡è°ƒç”¨ã€‚æ‰€ä»¥é…ç½®ä¸­æ³¨å†Œè®¾ä¸ºfalseï¼Œå–å¾—æ³¨å†Œä¹Ÿè®¾ä¸ºfalseã€‚
>
> EurekaServeræœ‰è‡ªèº«çš„æ¬¢è¿ç•Œé¢ï¼Œæµè§ˆå™¨è®¿é—®service-urlã€‚

å¯åŠ¨ç±»ä¸Šæ·»åŠ æ³¨è§£`@EnableEurekaServer`

```java
@SpringBootApplication
@EnableEurekaServer
public class EurekaServer {

    public static void main(String[] args) {
        SpringApplication.run(EurekaServer.class, args);
    }
}
```

#### æœåŠ¡æä¾›è€…æ•´åˆEureka

 ğŸƒåœ¨æœåŠ¡æä¾›è€…çš„Mavenå·¥ç¨‹ä¸­ï¼Œæ·»åŠ å¦‚ä¸‹ä¾èµ–

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
</dependency>

<!--Eurekaä¾èµ–-->
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>
</dependency>
```

 ğŸƒæ·»åŠ å¦‚ä¸‹é…ç½®

```yaml
spring:
  application:
    name: registry-provider
server:
  port: 7101
  
#å‘Šè¯‰clientåˆ°å“ªé‡Œè®¿é—®server
eureka:
  client:
    service-url:
      defaultZone: http://localhost:7001/eureka/
      # å¯ä»¥å»æ³¨å†Œçš„ä¿¡æ¯
  instance:
    instance-id: provider-7101 
    hostname: localhost
```

 ğŸƒä¸»å¯åŠ¨ç±»æ·»åŠ æ³¨è§£`@EnableEurekaClient`

```java
@SpringBootApplication
@EnableEurekaClient
public class RegistryProviderApplication {
    public static void main(String[] args) {
        SpringApplication.run(RegistryProviderApplication.class, args);
    }
}
```

#### æœåŠ¡æ¶ˆè´¹è€…æ•´åˆ Eureka

æœåŠ¡æ¶ˆè´¹è€…ä¸å†ç›´æ¥è®¿é—®æœåŠ¡æä¾›è€…ï¼Œè€Œæ˜¯å…ˆè®¿é—®æ³¨å†Œä¸­å¿ƒã€‚åŸºäºæœåŠ¡çš„è‡ªåŠ¨å‘ç°ï¼Œå‘ç°æœåŠ¡çš„åœ°å€ã€‚

æ·»åŠ å¦‚ä¸‹ä¾èµ–

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
</dependency>

<!--Eurekaä¾èµ–-->
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>
</dependency>
```

æ·»åŠ å¦‚ä¸‹é…ç½®

```yaml
spring:
  application:
    name: registry-consumer
server:
  port: 7102

# Eurekaé…ç½®
eureka:
  client:
    service-url:
      defaultZone: http://localhost:7001/eureka/
  instance:
    instance-id: consumer-7102 #ä¿®æ”¹Eurekaä¸Šçš„é»˜è®¤æè¿°ä¿¡æ¯
    hostname: localhost
```

ä¸»å¯åŠ¨ç±»ï¼Œæ·»åŠ æ³¨è§£

```java
@SpringBootApplication
@EnableEurekaClient
public class RegistryConsumerApplication {

    public static void main(String[] args) {
        SpringApplication.run(RegistryConsumerApplication.class, args);
    }
}
```

åœ¨æœåŠ¡æ¶ˆè´¹è€…ä¸­æ·»åŠ æµ‹è¯•ä»£ç 

```java
// æ³¨å…¥æœåŠ¡å‘ç°çš„å®¢æˆ·ç«¯å¯¹è±¡ï¼Œé€šè¿‡è¯¥å¯¹è±¡è®¿é—®ä»æ³¨å†Œä¸­å¿ƒä¸‹è½½çš„æœåŠ¡ä¿¡æ¯ 
@Autowired
 DiscoveryClient discoveryClient;   

@GetMapping("/eureka")
    public String consumeByEureka(String name) {
        // è·å–åä¸ºregistry-providerçš„æœåŠ¡å®ä¾‹
        List<ServiceInstance> instances = discoveryClient.getInstances("registry-provider");
        // uriçš„æ ¼å¼ä¸ºhttp://æœåŠ¡å®ä¾‹ip:æœåŠ¡å®ä¾‹å¯åŠ¨ç«¯å£
        URI uri = instances.get(0).getUri();
	    // å‘æ³¨å†Œè¡¨ä¸­çš„æœåŠ¡å‘èµ·è¯·æ±‚
        ResponseEntity<String> response = template.getForEntity(uri.toString() + "/registry/hello?name={1}", String.class, name);
        String result = response.getBody();
        return result;
    }
```

#### Eurekaçš„è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶

> è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ä¸æ˜¯æ‰€æœ‰æ³¨å†Œä¸­å¿ƒéƒ½æœ‰ã€‚

è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶è§¦å‘çš„åœºæ™¯å¦‚ä¸‹:

- é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“eureka serveråœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°å®ä¾‹çš„å¿ƒè·³ï¼Œä¾¿ä¼šæŠŠè¯¥å®ä¾‹ä»æ³¨å†Œè¡¨ä¸­åˆ é™¤ï¼ˆ**é»˜è®¤æ˜¯90ç§’**ï¼‰
- ä½†æ˜¯ï¼Œå¦‚æœçŸ­æ—¶é—´å†…ä¸¢å¤±å¤§é‡çš„å®ä¾‹å¿ƒè·³ï¼Œè¿™æ„å‘³ç€çŸ­æ—¶é—´å†…å¤§é‡çš„æœåŠ¡è¿æ¥ä¸¢å¤±äº†ï¼Œæ­¤æ—¶å°±ä¼šè§¦å‘Eurekaçš„è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶
- è§¦å‘è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶çš„ç»“æœå°±æ˜¯ï¼ŒEurekaè®¤ä¸ºè™½ç„¶æ”¶ä¸åˆ°å®ä¾‹çš„å¿ƒè·³ï¼Œä½†å®ƒè®¤ä¸ºå®ä¾‹è¿˜æ˜¯å¥åº·çš„ï¼Œeurekaä¼šä¿æŠ¤è¿™äº›å®ä¾‹ï¼Œ**ä¸ä¼šæŠŠå®ƒä»¬ä»æ³¨å†Œè¡¨ä¸­åˆ æ‰**ã€‚

é‚£ä¹ˆEurekaçš„è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶çš„æ„ä¹‰åœ¨å“ªé‡Œå‘¢ï¼Ÿ

- è¯¥ä¿æŠ¤æœºåˆ¶çš„ç›®çš„æ˜¯**é¿å…ç½‘ç»œè¿æ¥æ•…éšœ**ï¼Œåœ¨å‘ç”Ÿç½‘ç»œæ•…éšœæ—¶ï¼Œå¾®æœåŠ¡å’Œæ³¨å†Œä¸­å¿ƒä¹‹é—´æ— æ³•æ­£å¸¸é€šä¿¡ï¼Œä½†æœåŠ¡æœ¬èº«æ˜¯å¥åº·çš„
- æ­¤æ—¶ï¼Œä¸ºäº†é¿å…æ³¨å†Œä¸­å¿ƒåŒæ—¶åˆ é™¤å¤§é‡æœ¬æ¥æ˜¯æ­£å¸¸è¿è¡Œ(å¥åº·çš„)çš„æœåŠ¡å®ä¾‹ï¼Œäºæ˜¯å°±ä¼šè‡ªåŠ¨è§¦å‘è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶
- è¯¥è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶å¼€å¯ä¹‹åï¼ŒEurekaä¼šä¿æŠ¤æ³¨å†Œè¡¨ä¸­çš„ä¿¡æ¯ï¼Œä¸å†æ³¨é”€ä»»ä½•å¾®æœåŠ¡ï¼Œå½“ç½‘ç»œæ•…éšœæ¢å¤åï¼Œ**Eurekaä¼šè‡ªåŠ¨é€€å‡ºä¿æŠ¤æ¨¡å¼**ï¼Œä»è€Œä½¿é›†ç¾¤æ›´åŠ å¥å£®ã€‚

è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ä¼šæœ‰è¯¯åˆ¤çš„é£é™©ã€‚å› ä¸ºåœ¨å¼€å¯è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶çš„é˜¶æ®µï¼Œå¦‚æœçœŸæœ‰æœåŠ¡æä¾›è€…å®ä¾‹æ— æ³•æ­£å¸¸è¿è¡Œï¼Œæ³¨å†Œä¿¡æ¯ä¸åŠæ—¶åˆ é™¤ï¼Œä¼šå¸¦æ¥é—®é¢˜ã€‚

ä½†æ˜¯æˆ‘ä»¬åœ¨å¼€å‘æµ‹è¯•é˜¶æ®µï¼Œéœ€è¦é¢‘ç¹åœ°é‡å¯å‘å¸ƒï¼Œå¦‚æœè§¦å‘äº†ä¿æŠ¤æœºåˆ¶ï¼Œåˆ™æ—§çš„æœåŠ¡å®ä¾‹æ²¡æœ‰è¢«åˆ é™¤ï¼Œè¿™æ—¶æœåŠ¡æ¶ˆè´¹è€…æŒ‰ç…§æ³¨å†Œè¡¨ä¸­çš„æœåŠ¡æä¾›è€…ä¿¡æ¯ï¼Œå‘å‡ºæœåŠ¡è°ƒç”¨è¯·æ±‚ï¼Œä¼šå› ä¸ºè¯¥å®ä¾‹å…³é—­è€Œå¤±è´¥ï¼Œè¿™å°±å¯¼è‡´è¯·æ±‚é”™è¯¯ï¼Œå½±å“å¼€å‘æµ‹è¯•ã€‚

æ‰€ä»¥ï¼Œåœ¨å¼€å‘æµ‹è¯•é˜¶æ®µï¼Œæˆ‘ä»¬å¯ä»¥**æŠŠè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼å…³é—­**ï¼Œåªéœ€åœ¨eureka serveré…ç½®æ–‡ä»¶ä¸­åŠ ä¸Šå¦‚ä¸‹é…ç½®å³å¯

```yaml
eureka:
  server:
    enable-self-preservation: false
```

![è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶è¢«è§¦å‘](.\assets\image-20231002163707880.png)

### Nacos  æ³¨å†Œä¸­å¿ƒ

Nacos(Dynamic Naming and Configuration Service)æ˜¯æœåŠ¡ä¸­å¿ƒçš„å¦å¤–ä¸€ç§å®ç°ã€‚ä»æ³¨å†Œä¸­å¿ƒçš„åŠŸèƒ½å®ç°è§’åº¦ï¼Œä¸Eurekaç­‰ä»·ï¼Œåªæ˜¯å®ç°æ–¹å¼æœ‰æ‰€å·®å¼‚ã€‚ä¸Eurekaä¸åŒçš„æ˜¯ï¼ŒNacosæ³¨å†Œä¸­å¿ƒç±»ä¼¼äºTomcatï¼Œæ˜¯ç‹¬ç«‹å¯åŠ¨çš„æœåŠ¡å™¨ã€‚å› æ­¤åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­ï¼Œæ— éœ€åœ¨ä¸“é—¨åˆ›å»ºä¸€ä¸ªå·¥ç¨‹ç”¨äºå¯åŠ¨æ³¨å†Œä¸­å¿ƒã€‚

#### å¯åŠ¨nacosæœåŠ¡å™¨

é¦–å…ˆï¼Œä¸‹è½½å¥½Nacoså®‰è£…åŒ…(.zipå‹ç¼©åŒ…)ï¼Œè§£å‹åï¼Œå¦‚ä¸‹å›¾

![](SpringCloudç¬”è®° .assets/nacoså®‰è£….png)

è¿›å…¥binç›®å½•ï¼Œæ‰“å¼€å‘½ä»¤è¡Œï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤

```bash
windows: startup.cmd -m standalone
linux: startup.sh -m standalone
```

> æ¬¢è¿é¡µé¢ï¼š
>
> localhost:8848/nacos
>
> ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯nacos

å¯åŠ¨ä¹‹åçœ‹åˆ°å¦‚ä¸‹ç•Œé¢ï¼Œè¿™é‡Œä¸Šé¢çš„éƒ¨åˆ†æ²¡æˆªå…¨

![nacoså¯åŠ¨](SpringCloudç¬”è®°  .assets/nacoså¯åŠ¨.png)

#### ä½¿ç”¨NacosæœåŠ¡æ³¨å†Œä¸­å¿ƒ

ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨Nacosä½œä¸ºæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œå®ç°æœåŠ¡çš„æ³¨å†Œä¸è‡ªåŠ¨å‘ç°ã€‚

![](SpringCloudç¬”è®° .assets/nacosç»“æ„å›¾.png)

é¦–å…ˆï¼Œåœ¨çˆ¶å·¥ç¨‹ä¸­ï¼Œå¯¼å…¥å¦‚ä¸‹ä¾èµ–

```xml
<dependencyManagement>
    <dependencies>
        <!--SpringCloudAlibaba-->
        <dependency>
            <groupId>com.alibaba.cloud</groupId>
            <artifactId>spring-cloud-alibaba-dependencies</artifactId>
            <version>2.1.0.RELEASE</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
        <!--springCloudçš„ä¾èµ–-->
        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-dependencies</artifactId>
            <version>Hoxton.SR1</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
        <!--SpringBoot-->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-dependencies</artifactId>
            <version>2.2.2.RELEASE</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
    </dependencies>
</dependencyManagement>
```

åœ¨nacos-provider-8002æœåŠ¡æä¾›è€…å·¥ç¨‹ä¸­ï¼Œæ·»åŠ å¦‚ä¸‹ä¾èµ–

```xml
<dependencies>
    <!--SpringCloud ailibaba nacos -->
    <dependency>
        <groupId>com.alibaba.cloud</groupId>
        <artifactId>spring-cloud-starter-alibaba-nacos-discovery</artifactId>
    </dependency>

    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>
</dependencies>
```

åœ¨nacos-provider-8002æ¨¡å—ä¸­ï¼Œæ·»åŠ å¦‚ä¸‹é…ç½®

```yaml
server:
  port: 8002
spring:
  application:
    name: nacos-provider
  cloud:
    nacos:
      discovery:
       # nacosæœåŠ¡å™¨åœ°å€
        server-addr: localhost:8848 
```

nacos-provider-8002æ¨¡å—ä»£ç ä¸­ï¼Œä»£ç å¦‚ä¸‹

```java
@RestController
@RequestMapping("/nacos")
public class RegistryProviderController {

    @GetMapping("/registry/hello")
    public String hello(String name) {
        return "hello, " + name;
    }
}
```

åœ¨å¯åŠ¨ç±»ä¸ŠåŠ æ³¨è§£`@EnableDiscoveryClient`

```java
@SpringBootApplication
@EnableDiscoveryClient
public class NacosProvider8002Application {
    public static void main(String[] args) {
        SpringApplication.run(NacosProvider8002Application.class, args);
    }
}

```

æ¥ç€æ˜¯nacos-consumer-8001æ¨¡å—ï¼Œä¾èµ–ï¼Œé…ç½®åŒnacos-provider-8002ï¼Œå°±æ˜¯server.portç«¯å£æ”¹ä¸º8001,**è¿™é‡Œä¸å†èµ˜è¿°**ã€‚ä»£ç å¦‚ä¸‹

```java
@Configuration
public class ClientConfig {

    @Bean
    public RestTemplate template() {
        return new RestTemplate();
    }
}
```

```java
@RestController
@RequestMapping("/call")
public class RegistryConsumerController {

    @Autowired
    DiscoveryClient discoveryClient;

    @Autowired
    RestTemplate template;

    @GetMapping("/nacos")
    public String consumeNacos(String name) {
        // æœåŠ¡å‘ç°ï¼Œè·å–nacos-provider-8002æœåŠ¡çš„æœåŠ¡æ³¨å†Œä¿¡æ¯(å³æœåŠ¡æ³¨å†Œè¡¨)
        List<ServiceInstance> instances = discoveryClient.getInstances("nacos-provider-8002");
        URI uri = instances.get(0).getUri();
		String url = uri + "/registry/hello?name={1}";
        ResponseEntity<String> response = template.getForEntity(url, String.class, name);
        String result = response.getBody();
        return result;
    }
}
```
