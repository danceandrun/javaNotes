è®¾è®¡æ¨¡å¼æ€ç»´å¯¼å›¾

![Day12è®¾è®¡æ¨¡å¼æ€ç»´å¯¼å›¾](.\assets\Day12è®¾è®¡æ¨¡å¼æ€ç»´å¯¼å›¾.jpg)

# å‰è¨€

## å­¦ä¹ ç›®æ ‡

> 1. ç†è§£ä½¿ç”¨è®¾è®¡æ¨¡å¼çš„ç›®çš„
> 2. æŒæ¡è½¯ä»¶è®¾è®¡çš„SOLIDåŸåˆ™
> 3. ç†è§£å•ä¾‹çš„æ€æƒ³ï¼Œå¹¶ä¸”èƒ½å¤Ÿè®¾è®¡ä¸€ä¸ªå•ä¾‹
> 4. ç†è§£å·¥å‚è®¾è®¡æ¨¡å¼çš„æ€æƒ³ï¼Œèƒ½å¤Ÿè®¾è®¡ç®€å•å·¥å‚ï¼Œç†è§£å·¥å‚æ–¹æ³•
> 5. äº†è§£å»ºé€ è€…æ¨¡å¼çš„æ€æƒ³ï¼ŒæŒæ¡å…¶ä»£ç é£æ ¼
> 6. ç†è§£ä»£ç†è®¾è®¡æ¨¡å¼çš„æ€æƒ³ï¼Œç†è§£åŠ¨æ€ä»£ç†ç±»å’Œå§”æ‰˜ç±»ï¼ˆç›®æ ‡ç±»ï¼‰ä¹‹é—´çš„å…³ç³»ï¼Œâš¡ç†Ÿæ‚‰**ä»£ç†**å¯¹è±¡è°ƒç”¨æ–¹æ³•çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œç†Ÿç»ƒä½¿ç”¨åŠ¨æ€ä»£ç†å®Œæˆä»£ç è®¾è®¡
> 7. äº†è§£è´£ä»»é“¾è®¾è®¡æ¨¡å¼çš„æ€æƒ³

**ä»£ç†**å¯ä»¥èµ·åˆ°å¾ˆå¤§ä½œç”¨ï¼Œå°å‹æ ¸æ­¦å™¨

## å‰ç½®å‡†å¤‡

> - ç†è§£æŠ½è±¡éƒ¨åˆ†ï¼šä¸ºä»€ä¹ˆä½¿ç”¨æ¥å£æˆ–æŠ½è±¡ç±»ï¼Œåœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨æ¥å£ï¼Œä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨æŠ½è±¡ç±» ï¼ˆæ¥å£å’ŒæŠ½è±¡ç±»ä¸»è¦å®šä¹‰æ–¹æ³•çš„è§„èŒƒï¼‰
>
> - é™æ€å†…éƒ¨ç±»çš„ç±»åŠ è½½è¿‡ç¨‹
>
> - åŒ¿åå†…éƒ¨ç±»çš„å®šä¹‰å’Œä½¿ç”¨ 
>
> - åå°„ï¼šåå°„è¿‡ç¨‹ä¸­çš„å¸¸ç”¨åè¯Classã€Fieldã€Methodã€Parameterã€Constructorã€‚åå°„è¿‡ç¨‹ä¸­çš„å¸¸ç”¨æ–¹æ³•
>   - è·å¾—classã€fieldã€methodã€parameterã€constructor  â†’ getDeclaredXXX
>   - é€šè¿‡åå°„è·å¾—å®ä¾‹ classå’Œconstructor
>   - é€šè¿‡åå°„è°ƒç”¨æ–¹æ³• method.invoke(instance,args)
>
> - Lombokä½¿ç”¨
>

# è®¾è®¡æ¨¡å¼ç®€ä»‹

## ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼

è®¾è®¡æ¨¡å¼æ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨çš„ã€å¤šæ•°äººçŸ¥æ™“çš„ã€ç»è¿‡åˆ†ç±»ç¼–ç›®çš„ã€ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ã€‚è®¾è®¡æ¨¡å¼ä»£è¡¨äº†æœ€ä½³çš„å®è·µï¼Œé€šå¸¸è¢«æœ‰ç»éªŒçš„è½¯ä»¶å¼€å‘äººå‘˜æ‰€ä½¿ç”¨ã€‚

## ä¸ºä»€ä¹ˆå­¦ä¹ è®¾è®¡æ¨¡å¼

- å¯ä»¥é¢å¯¹é¢è¯•ä¸­çš„å…³äºè®¾è®¡æ¨¡å¼çš„é—®é¢˜ï¼Œæ¯”å¦‚**å•ä¾‹æ¨¡å¼**çš„å‡ ç§å®ç°æ–¹å¼ï¼›æ¯”å¦‚**æ‡’æ±‰å¼å’Œé¥¿æ±‰å¼**ä½ å¦‚ä½•ç†è§£ï¼ˆ**æ‡’åŠ è½½å’Œç«‹å³åŠ è½½**ï¼‰
- å€ŸåŠ©äºè®¾è®¡æ¨¡å¼å¯ä»¥ç¼–å†™å‡ºéå¸¸é«˜æ•ˆçš„ä»£ç ï¼Œå¯å¤ç”¨æ€§ä»¥åŠç¨³å¥æ€§éƒ½ä¼šæ¯”è¾ƒå¼ºã€‚
- æœ‰åŠ©äºé˜…è¯»æºç æ¡†æ¶ï¼Œåç»­è¿›é˜¶æå‡æ‰€å¿…é¡»è¦æŒæ¡çš„æŠ€èƒ½
  - çœ‹æºç çš„èƒ½åŠ›ï¼š
    - æ‰¾åˆ°æºç ï¼šctrl + n
    - ç±»çš„ç»§æ‰¿å…³ç³»: ctrl + h
    - debugæ‰§è¡Œ

> ğŸ·ï¸ ä¸€äº›é—®é¢˜ï¼š
>
> 1. è®¾è®¡æ¨¡å¼åˆ†ä¸ºå“ªå‡ ç§ç±»å‹ï¼Ÿ
>    1. åˆ›å»ºå‹
>    2. ç»“æ„å‹
>    3. è¡Œä¸ºå‹
>
> 2. SOLIDåˆ†åˆ«æŒ‡çš„æ˜¯å“ªå‡ ç§åŸåˆ™ï¼Œåˆ†åˆ«ç®€å•ä»‹ç»ä¸€ä¸‹
>
>    1. å•ä¸€èŒè´£åŸåˆ™ï¼šå°½é‡ä½¿æ¯ä¸€ä¸ªç±»åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½
>
>    2. å¼€é—­åŸåˆ™ï¼šæƒé™å¯¹æ–°å¢å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­
>
>    3. é‡Œæ°æ›¿æ¢åŸåˆ™ï¼š**å¦‚æœSæ˜¯Tçš„å­ç±»å‹ï¼Œå¯¹äºSç±»å‹çš„ä»»æ„å¯¹è±¡ï¼Œå¦‚æœå°†ä»–ä»¬çœ‹ä½œæ˜¯Tç±»å‹çš„å¯¹è±¡ï¼Œåˆ™å®ƒçš„è¡Œä¸ºä¹Ÿç†åº”å’Œé¢„æœŸçš„è¡Œä¸ºä¸€è‡´**ã€‚
>
>       > è¿™é‡Œçš„é¢„æœŸè¡Œä¸ºæŒ‡çš„æ˜¯Tç±»å‹çš„è¡Œä¸ºï¼Œå› ä¸ºç”¨çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡æ—¶ï¼Œä¼šæœ‰å¤šæ€çš„å‡ºç°ã€‚å¦‚æœæ–¹æ³•è°ƒç”¨å’Œå¼•ç”¨å®šä¹‰ä¹‹é—´éš”äº†å¾ˆé•¿ï¼Œåœ¨ä½¿ç”¨è¿™ä¸ªå¼•ç”¨æ—¶ï¼Œé¢„æœŸæ˜¯å‡ºç°çˆ¶ç±»çš„è¡Œä¸ºã€‚**æ‰€ä»¥é‡Œæ°åŸåˆ™çš„æ„æ€æ˜¯ä¸ä½¿ç”¨æ–¹æ³•é‡å†™ã€‚**
>
>    4. è¿ªç±³ç‰¹æ³•åˆ™ï¼šå°½é‡ä¸ä¾èµ–ï¼Œéå¾—ä¾èµ–çš„è¯å°±ä¾èµ–æ¥å£ã€‚ä¹Ÿå«åšæœ€å°‘çŸ¥é“åŸåˆ™ã€‚
>
>    5. æ¥å£éš”ç¦»åŸåˆ™ï¼šä¸€ä¸ªç±»å¯¹å¦å¤–ä¸€ä¸ªç±»çš„ä¾èµ–åº”å½“å»ºç«‹åœ¨**æœ€å°çš„æ¥å£**ä¸Šã€‚æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•å†™çš„åº”å°½é‡çš„å°‘ã€‚
>
>    6. ä¾èµ–å€’ç½®åŸåˆ™ï¼šæŒ‡çš„æ˜¯å‚ç›´å…³ç³»ä¸Šçš„ä¾èµ–å…³ç³»ï¼Œé«˜å±‚ä¸åº”è¯¥ä¾èµ–åº•å±‚ï¼ŒæŠ½è±¡ä¸åº”è¯¥ä¾èµ–å…·ä½“ã€‚
>
> 3. å•ä¾‹å®ç°é‡Œæœ‰ä¸€ä¸ªdouble checkï¼Œè¯·æ€è€ƒä¸ºä»€ä¹ˆè¦åšç¬¬ä¸€æ¬¡ç©ºå€¼åˆ¤æ–­ï¼Ÿ
>
>    1. å¤–éƒ¨çš„ç©ºå€¼åˆ¤æ–­æ˜¯ä¸ºäº†å‡å°‘äº‰å¤ºé”çš„æ¬¡æ•°ï¼Œéç©ºå€¼è¡¨ç¤ºå·²ç»åˆ›å»ºäº†å¯¹è±¡ï¼Œä¸éœ€è¦æ‰§è¡Œåˆ›å»ºçš„åŸå­æ“ä½œï¼Œæ— æ³•é€šè¿‡åˆ¤æ–­è‡ªç„¶å°±ä¸ä¼šè¿›å…¥äº‰å¤ºé”çš„è¿‡ç¨‹
>    2. å†…éƒ¨çš„ç©ºå€¼åˆ¤æ–­æ˜¯ä¸ºäº†é¿å…è¿™æ ·ä¸€ç§æƒ…å†µï¼ŒAçº¿ç¨‹é€šè¿‡äº†å¤–éƒ¨åˆ¤æ–­æ­¤æ—¶è¢«Bçº¿ç¨‹äº‰å¤ºäº†é”ï¼Œå½“Bå®Œæˆå¯¹è±¡åˆ›å»ºä¹‹åï¼Œå¦‚æœä¸åŠ åˆ¤æ–­Aä¼šå†æ¬¡æ‰§è¡Œåˆ›å»ºå¯¹è±¡ã€‚
>
> 4. è¯·æè¿°å§”æ‰˜ç±»å’Œä»£ç†ç±»ä¹‹é—´çš„è”ç³»
>
>    1.
>
>    å¦‚æœæ˜¯JDKåŠ¨æ€ä»£ç†ï¼Œä»£ç†ç±»å®ç°äº†å’Œå§”æ‰˜ç±»ç›¸åŒçš„æ¥å£
>
>    å¦‚æœæ˜¯CGlibåŠ¨æ€ä»£ç†ï¼Œä»£ç†ç±»ç»§æ‰¿å§”æ‰˜ç±»
>
>    2.
>
>    ä»£ç†ç±»ä¸­ä¸€å®šä¼šåŒ…å«å’Œå§”æ‰˜ç±»å¤–è§‚ä¸€è‡´çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸­ä¸€å®šä¼šæœ‰å§”æ‰˜ç±»æ–¹æ³•çš„è°ƒç”¨
>
>    > å§”æ‰˜ç±»å’Œä»£ç†ç±»æ˜¯ä¸¤ç§åœ¨è½¯ä»¶å¼€å‘ä¸­å¸¸è§çš„è®¾è®¡æ¨¡å¼ï¼Œå®ƒä»¬ä¹‹é—´æœ‰ä¸€äº›è”ç³»ï¼Œä½†åˆæœ‰ä¸åŒçš„ç”¨é€”å’Œå®ç°æ–¹å¼ã€‚
>    >
>    > 1. å§”æ‰˜ç±»ï¼ˆDelegator Classï¼‰ï¼š
>    >   - å§”æ‰˜ç±»æ˜¯ä¸€ä¸ªåŒ…å«æŸä¸ªå¯¹è±¡æˆ–åŠŸèƒ½çš„ç±»ï¼Œå®ƒé€šå¸¸å…·æœ‰ä¸€äº›å…¬å…±æ¥å£æˆ–æ–¹æ³•ï¼Œå…è®¸å…¶ä»–å¯¹è±¡å°†ä»»åŠ¡å§”æ‰˜ç»™å®ƒæ¥æ‰§è¡Œã€‚
>    >    - å§”æ‰˜ç±»é€šå¸¸ç”¨äºåˆ†ç¦»è´£ä»»ï¼Œå°†å¤æ‚çš„åŠŸèƒ½æ‹†åˆ†æˆå¤šä¸ªå°çš„éƒ¨åˆ†ï¼Œç„¶åå°†è¿™äº›éƒ¨åˆ†å§”æ‰˜ç»™å…¶ä»–ç±»æ¥å¤„ç†ã€‚
>    >    - å§”æ‰˜ç±»çš„ä¸»è¦ä½œç”¨æ˜¯ç®¡ç†ä»»åŠ¡çš„åˆ†å‘å’Œå§”æ‰˜ç»™å…¶ä»–å¯¹è±¡ï¼Œå®ƒé€šå¸¸ä¸ç›´æ¥å¤„ç†ä»»åŠ¡çš„å…·ä½“å®ç°ã€‚
>    > 
>    > 2. ä»£ç†ç±»ï¼ˆProxy Classï¼‰ï¼š
>    >   - ä»£ç†ç±»æ˜¯ä¸€ç§ç»“æ„å‹è®¾è®¡æ¨¡å¼ï¼Œå……å½“å¦ä¸€ä¸ªå¯¹è±¡çš„æ¥å£ï¼Œä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚
>    >    - ä»£ç†ç±»çš„ä¸»è¦ç›®çš„æ˜¯åœ¨ä¸æ”¹å˜åŸå§‹å¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œä¸ºå…¶æ·»åŠ é¢å¤–çš„åŠŸèƒ½ï¼Œä¾‹å¦‚å»¶è¿ŸåŠ è½½ã€æƒé™æ§åˆ¶ã€ç¼“å­˜ç­‰ã€‚
>    >    - ä»£ç†ç±»å’ŒåŸå§‹å¯¹è±¡é€šå¸¸éƒ½å®ç°ç›¸åŒçš„æ¥å£ï¼Œä»¥ä¿è¯å¯¹å®¢æˆ·ç«¯ä»£ç çš„é€æ˜æ€§ã€‚
>    > 
>    > è”ç³»ï¼š
>    >
>    > - å§”æ‰˜ç±»å’Œä»£ç†ç±»éƒ½æ¶‰åŠåˆ°å°†ä»»åŠ¡å§”æ‰˜ç»™å…¶ä»–å¯¹è±¡ã€‚å§”æ‰˜ç±»é€šå¸¸æ˜¯ä¸ºäº†åˆ†ç¦»å¤æ‚åŠŸèƒ½çš„ä¸åŒéƒ¨åˆ†ï¼Œè€Œä»£ç†ç±»é€šå¸¸æ˜¯ä¸ºäº†åœ¨è®¿é—®ä¸€ä¸ªå¯¹è±¡æ—¶å¢åŠ æ§åˆ¶æˆ–é™„åŠ åŠŸèƒ½ã€‚
>    >- å§”æ‰˜ç±»å¯ä»¥è¢«è§†ä¸ºä¸€ç§æ›´é€šç”¨çš„æ¨¡å¼ï¼Œå®ƒä¸ä»…å¯ä»¥ç”¨äºä»£ç†ï¼Œè¿˜å¯ä»¥ç”¨äºå…¶ä»–ç›®çš„ï¼Œå¦‚ç­–ç•¥æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼ç­‰ã€‚
>    > - ä»£ç†ç±»é€šå¸¸åŒ…å«å¯¹å§”æ‰˜ç±»çš„å¼•ç”¨ï¼Œä»¥ä¾¿åœ¨å¿…è¦æ—¶å°†ä»»åŠ¡å§”æ‰˜ç»™å§”æ‰˜ç±»ã€‚ä»£ç†ç±»å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©æ€§åœ°è°ƒç”¨å§”æ‰˜ç±»çš„æ–¹æ³•ã€‚
>    > 
>    > æ€»ä¹‹ï¼Œå§”æ‰˜ç±»å’Œä»£ç†ç±»éƒ½æœ‰ä¸€ä¸ªå…±åŒçš„ç›®æ ‡ï¼Œå³å°†ä»»åŠ¡å§”æ‰˜ç»™å…¶ä»–å¯¹è±¡æ¥æ‰§è¡Œï¼Œä½†å®ƒä»¬çš„å®ç°æ–¹å¼å’Œä¸»è¦ç”¨é€”ç•¥æœ‰ä¸åŒã€‚å§”æ‰˜ç±»é€šå¸¸æ›´åŠ é€šç”¨ï¼Œè€Œä»£ç†ç±»é€šå¸¸ç”¨äºæ§åˆ¶å¯¹æŸä¸ªå¯¹è±¡çš„è®¿é—®æˆ–ä¸ºå…¶æ·»åŠ é¢å¤–çš„åŠŸèƒ½ã€‚


## è®¾è®¡æ¨¡å¼çš„å‘å±•å†å²

> è¦æ¥è§¦æ–°æ¦‚å¿µ
>
> æ¯”å¦‚ChatGptä¸­`GPT`
>
>
> The acronym(é¦–å­—æ¯ç¼©ç•¥è¯) "GPT" stands for "Generative Pre-trained Transformer." Let's break down what each part of the acronym means:
>
> 1. **Generative**: This refers to the model's ability to generate text or other types of data. In the case of GPT models, they are primarily used for generating human-like text, but they can also generate code, images, and more.
> 2. **Pre-trained**: Before being fine-tuned for specific tasks, GPT models are trained on a massive amount of text data from the internet. This pre-training helps the model learn grammar, facts, and some level of reasoning.
> 3. **Transformer**: The Transformer is a type of deep learning architecture that was introduced in a paper titled "Attention is All You Need" by Vaswani et al. in 2017. It revolutionized natural language processing tasks by introducing a mechanism called "self-attention" that allows the model to weigh the importance of different parts of the input data when making predictions.
>
> So, when you put it all together, "GPT" signifies a type of AI model that is capable of generating text and has been pre-trained on a large corpus of data using the Transformer architecture. GPT models are known for their versatility in various natural language understanding and generation tasks.

è®¾è®¡æ¨¡å¼æ˜¯ç”±è°æ¥å‘æ˜çš„å‘¢ï¼Ÿå…¶å®æœ€æ—©æå‡ºè®¾è®¡æ¨¡å¼æ¦‚å¿µçš„äººå¹¶ä¸æ˜¯æ¥è‡ªäºè½¯ä»¶é¢†åŸŸï¼Œè€Œæ˜¯æ¥è‡ªäºå»ºç­‘æ–¹å‘ã€‚ç”±å…‹é‡Œæ–¯æ‰˜ä½›Â·äºšå†å±±å¤§åœ¨å…¶è‘—ä½œ ã€Šå»ºç­‘æ¨¡å¼è¯­è¨€ã€‹ ä¸­é¦–æ¬¡æå‡ºçš„ã€‚æ¯”å¦‚åŒ…å«å¯¹çª—æˆ·åº”è¯¥åœ¨å¤šé«˜ã€ ä¸€åº§å»ºç­‘åº”è¯¥æœ‰å¤šå°‘å±‚ä»¥åŠä¸€ç‰‡è¡—åŒºåº”è¯¥æœ‰å¤šå¤§é¢ç§¯çš„æ¤è¢«ç­‰ä¿¡æ¯çš„æè¿°ã€‚

åæ¥åŸƒé‡Œå¸ŒÂ·ä¼½ç›ã€ çº¦ç¿°Â·å¼—åˆ©èµ›å¾·æ–¯ã€ æ‹‰å°”å¤«Â·çº¦ç¿°é€Šå’Œç†æŸ¥å¾·Â·èµ«å°”å§†è¿™å››ä½ä½œè€…æ¥å—äº†æ¨¡å¼çš„æ¦‚å¿µã€‚ 1994 å¹´ï¼Œ ä»–ä»¬å‡ºç‰ˆäº† ã€Šè®¾è®¡æ¨¡å¼ï¼š å¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ã€‹ä¸€ä¹¦ï¼Œ å°†è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µåº”ç”¨åˆ°ç¨‹åºå¼€å‘é¢†åŸŸä¸­ã€‚ è¯¥ä¹¦æä¾›äº† 23 ä¸ªæ¨¡å¼æ¥è§£å†³é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­çš„å„ç§é—®é¢˜ï¼Œ å¾ˆå¿«ä¾¿æˆä¸ºäº†ç•…é”€ä¹¦ã€‚ ç”±äºä¹¦åå¤ªé•¿ï¼Œ äººä»¬å°†å…¶ç®€ç§°ä¸º â€œå››äººç»„ ï¼ˆGang of Fourï¼Œ GoFï¼‰ çš„ä¹¦â€ï¼Œ å¹¶ä¸”å¾ˆå¿«è¿›ä¸€æ­¥ç®€åŒ–ä¸º â€œGoF çš„ä¹¦â€ã€‚

![image-20230226161500631](.\assets\image-20230226161500631.png)

## è®¾è®¡æ¨¡å¼çš„åˆ†ç±»

GoFï¼ˆ4äººç»„ï¼‰è®¾è®¡æ¨¡å¼å…±æœ‰23ç§ï¼Œæ ¹æ®ç”¨é€”çš„ä¸åŒï¼Œè®¾è®¡æ¨¡å¼å¯ä»¥åˆ†ä¸ºï¼š**åˆ›å»ºå‹ã€ç»“æ„å‹ã€è¡Œä¸ºå‹**ä¸‰ç§ã€‚

- **åˆ›å»ºå‹æ¨¡å¼**

  è¿™ç±»æ¨¡å¼æä¾›**åˆ›å»ºå¯¹è±¡**çš„æœºåˆ¶ï¼Œ èƒ½å¤Ÿæå‡å·²æœ‰ä»£ç çš„çµæ´»æ€§å’Œå¯å¤ç”¨æ€§ã€‚å¸¸è§çš„æœ‰å•ä¾‹ã€å·¥å‚ã€å»ºé€ è€…(ç”Ÿæˆå™¨)æ¨¡å¼ã€‚

  ![image-20230226210728330](.\assets\image-20230226210728330.png)
  
  <img src=".\assets\image-20230226210825852.png" alt="image-20230226210825852" style="zoom: 50%;" /><img src=".\assets\image-20230226210902155.png" alt="image-20230226210902155" style="zoom:50%;" />

â€‹      <img src=".\assets\image-20230226211039002.png" alt="image-20230226211039002" style="zoom:50%;" />

- **ç»“æ„å‹æ¨¡å¼**

  è¿™ç±»æ¨¡å¼ä»‹ç»å¦‚ä½•å°†å¯¹è±¡å’Œç±»**ç»„è£…æˆè¾ƒå¤§çš„ç»“æ„**ï¼Œ å¹¶åŒæ—¶ä¿æŒç»“æ„çš„çµæ´»å’Œé«˜æ•ˆã€‚å¸¸ç”¨çš„æœ‰ä»£ç†ã€æ¡¥æ¥ã€è£…é¥°è€…ã€é€‚é…å™¨æ¨¡å¼ã€‚

  <img src=".\assets\image-20230226211324405.png" alt="image-20230226211324405" style="zoom:50%;" />

  <img src=".\assets\image-20230226211343900.png" alt="image-20230226211343900" style="zoom:50%;" />

  <img src=".\assets\image-20230226211547825.png" alt="image-20230226211547825" style="zoom:50%;" />

  <img src=".\assets\image-20230226211436160.png" alt="image-20230226211436160" style="zoom:50%;" />

  <img src=".\assets\image-20230226211510513.png" alt="image-20230226211510513" style="zoom:50%;" />

  <img src=".\assets\image-20230226211529699.png" alt="image-20230226211529699" style="zoom:50%;" />

  <img src=".\assets\image-20230226211411774.png" alt="image-20230226211411774" style="zoom:50%;" />

- **è¡Œä¸ºå‹æ¨¡å¼**

  è¿™ç±»æ¨¡å¼è´Ÿè´£å¯¹è±¡é—´çš„**é«˜æ•ˆæ²Ÿé€šå’ŒèŒè´£å§”æ´¾**ã€‚å¸¸è§çš„æœ‰è§‚å¯Ÿè€…ã€æ¨¡æ¿ã€ç­–ç•¥ã€è´£ä»»é“¾ã€è¿­ä»£å™¨ã€çŠ¶æ€æ¨¡å¼ã€‚

  <img src="F:/projectforme/java-53-course-materials/03-JavaEE&SpringFramework/02-ç¬”è®°/image/Content06-DesignPattern/image-20230226212028023.png" alt="image-20230226212028023" style="zoom:33%;" /><img src="F:/projectforme/java-53-course-materials/03-JavaEE&SpringFramework/02-ç¬”è®°/image/Content06-DesignPattern/image-20230226212106641.png" alt="image-20230226212106641" style="zoom:33%;" /><img src="F:/projectforme/java-53-course-materials/03-JavaEE&SpringFramework/02-ç¬”è®°/image/Content06-DesignPattern/image-20230226212047381.png" alt="image-20230226212047381" style="zoom:33%;" /><img src="F:/projectforme/java-53-course-materials/03-JavaEE&SpringFramework/02-ç¬”è®°/image/Content06-DesignPattern/image-20230226212130009.png" alt="image-20230226212130009" style="zoom:33%;" /><img src=".\assets\image-20230226212221808.png" alt="image-20230226212221808" style="zoom:33%;" />

  <img src=".\assets\image-20230226212530214.png" alt="image-20230226212530214" style="zoom:33%;" /><img src="F:/projectforme/java-53-course-materials/03-JavaEE&SpringFramework/02-ç¬”è®°/image/Content06-DesignPattern/image-20230226212545672.png" alt="image-20230226212545672" style="zoom:33%;" /><img src=".\assets\image-20230226212601769-1694047584734-18.png" alt="image-20230226212601769" style="zoom:33%;" /><img src=".\assets\image-20230907084637424.png" alt="image-20230907084637424" style="zoom:33%;" />



## ğŸ·ï¸ è®¾è®¡æ¨¡å¼åŸåˆ™

è®¾è®¡æ¨¡å¼éœ€è¦æœ‰è®¾è®¡çš„åŸåˆ™ä½œä¸º**æŒ‡å¯¼çº²é¢†**ï¼Œè®¾è®¡æ¨¡å¼æ˜¯åœ¨è®¾è®¡åŸåˆ™çš„æŒ‡å¼•ä¸‹è®¾è®¡å‡ºæ¥çš„ã€‚å› ä¸ºæˆ‘ä»¬éœ€è¦å¯¹è®¾è®¡åŸåˆ™æœ‰ä¸€ä¸ªæ¸…æ™°çš„è®¤è¯†ã€‚

è®¾è®¡åŸåˆ™æŒ‰ç…§é¦–å­—æ¯ç®€å†™å¯ä»¥æ¦‚æ‹¬ä¸º`SOLID`åŸåˆ™ã€‚

å•ä¸€èŒè´£åŸåˆ™ï¼ˆ**S**ingle Responsibility Principleï¼‰

å¼€æ”¾å°é—­åŸåˆ™ï¼ˆ**O**pen Close Principleï¼‰

é‡Œæ°æ›¿æ¢åŸåˆ™ï¼ˆ**L**iskov Substitution Principleï¼‰

è¿ªç±³ç‰¹æ³•åˆ™ï¼ˆ**L**east Knowledge Principleï¼‰

æ¥å£åˆ†ç¦»åŸåˆ™ï¼ˆ**I**nterface Segregation Principleï¼‰

ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆ**D**ependency Inversion Principleï¼‰

### å•ä¸€èŒè´£åŸåˆ™

å°½é‡ä½¿å¾—**æ¯ä¸ªç±»åªè´Ÿè´£**æ•´ä¸ªè½¯ä»¶çš„åŠŸèƒ½æ¨¡å—ä¸­çš„**ä¸€ä¸ª**ã€‚å½“ç¨‹åºä¸æ–­å£®å¤§ä¹‹åï¼Œç±»ä¹Ÿä¼šå˜å¾—éå¸¸çš„åºæ‚ï¼ŒæŸ¥æ‰¾æŸéƒ¨åˆ†ä»£ç ä¹Ÿä¼šå˜å¾—éå¸¸çš„åƒåŠ›ï¼›å¦‚æœæ­¤æ—¶éœ€è¦åšä»»ä½•ä¸€å¤„çš„ä¿®æ”¹ï¼Œé‚£ä¹ˆæ•´ä¸ªç±»çš„ä»£ç éƒ½ä¼šå—åˆ°å½±å“ã€‚

å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ˜¯ä¸€ä¸ªé›‡å‘˜ç±»ã€‚å‡è®¾æˆ‘ä»¬éœ€è¦å¯¹é›‡å‘˜è¡¨è¿›è¡Œä¿®æ”¹ã€‚**ä½†æ˜¯å‡ºäºä¸¤æ–¹é¢åŸå› ï¼Œæˆ‘ä»¬éœ€è¦å¯¹è¿™ä¸ªç±»è¿›è¡Œä¿®æ”¹**ï¼š

1. å’Œå½“å‰ç±»ä¸»è¦åŠŸèƒ½ç›¸å…³çš„ï¼Œæ¯”å¦‚ç®¡ç†é›‡å‘˜çš„ä¿¡æ¯ç­‰ï¼›
2. æ‰“å°é›‡å‘˜çš„ä¿¡æ¯ï¼Œæ‰“å°çš„ä¿¡æ¯éšç€æ—¶é—´çš„ä¸åŒï¼Œå¯¹äºæ ¼å¼è¦æ±‚ä¹Ÿä¸å¤ªç›¸åŒã€‚

![image-20230907084927063](.\assets\image-20230907084927063.png)

å‡ºäºä¸Šè¿°ä¸¤æ–¹é¢åŸå› ï¼Œæˆ‘ä»¬éœ€è¦å¯¹é›‡å‘˜ç±»è¿›è¡Œä¿®æ”¹ï¼Œä½†æ˜¯ä¿®æ”¹è¯¥ç±»çš„åŸå› å´ä¸æ˜¯ä¸€ä¸ªï¼Œè€Œæ˜¯æœ‰å¤šä¸ªåŸå› ã€‚é‚£ä¹ˆæ­¤æ—¶ï¼Œé›‡å‘˜ç±»çš„è®¾è®¡å°±ä¸ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ã€‚æˆ‘ä»¬å¯ä»¥å°è¯•æŒ‰ç…§å¦‚ä¸‹æ–¹å¼æ¥è¿›è¡Œä¿®æ”¹ï¼š

![image-20230907084940783](.\assets\image-20230907084940783.png)

å°†æ‰“å°ç›¸å…³çš„ä»£ç å…¨éƒ¨ç§»åŠ¨åˆ°ä¸€ä¸ªæ–°çš„ç±»ä¸­ï¼Œè¯¥ç±»éœ€è¦ä¾èµ–äº`Employee`ç±»ã€‚

> 1. **å¦‚ä½•ç†è§£å•ä¸€èŒè´£åŸåˆ™ï¼ˆSRPï¼‰ï¼Ÿ**ä¸€ä¸ªç±»åªè´Ÿè´£å®Œæˆä¸€ä¸ªèŒè´£æˆ–è€…åŠŸèƒ½ã€‚ä¸è¦è®¾è®¡å¤§è€Œå…¨çš„ç±»ï¼Œè¦è®¾è®¡ç²’åº¦å°ã€åŠŸèƒ½å•ä¸€çš„ç±»ã€‚å•ä¸€èŒè´£åŸåˆ™æ˜¯ä¸ºäº†å®ç°ä»£ç é«˜å†…èšã€ä½è€¦åˆï¼Œæé«˜ä»£ç çš„å¤ç”¨æ€§ã€å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§ã€‚
> 2. **å¦‚ä½•åˆ¤æ–­ç±»çš„èŒè´£æ˜¯å¦è¶³å¤Ÿå•ä¸€ï¼Ÿ**ä¸åŒçš„åº”ç”¨åœºæ™¯ã€ä¸åŒé˜¶æ®µçš„éœ€æ±‚èƒŒæ™¯ã€ä¸åŒçš„ä¸šåŠ¡å±‚é¢ï¼Œå¯¹åŒä¸€ä¸ªç±»çš„èŒè´£æ˜¯å¦å•ä¸€ï¼Œå¯èƒ½ä¼šæœ‰ä¸åŒçš„åˆ¤å®šç»“æœã€‚å®é™…ä¸Šï¼Œä¸€äº›ä¾§é¢çš„åˆ¤æ–­æŒ‡æ ‡æ›´å…·æœ‰æŒ‡å¯¼æ„ä¹‰å’Œå¯æ‰§è¡Œæ€§ï¼Œæ¯”å¦‚ï¼Œå‡ºç°ä¸‹é¢è¿™äº›æƒ…å†µå°±æœ‰å¯èƒ½è¯´æ˜è¿™ç±»çš„è®¾è®¡ä¸æ»¡è¶³å•ä¸€èŒè´£åŸåˆ™ï¼šç±»ä¸­çš„ä»£ç è¡Œæ•°ã€å‡½æ•°æˆ–è€…å±æ€§è¿‡å¤šï¼›ç±»ä¾èµ–çš„å…¶ä»–ç±»è¿‡å¤šï¼Œæˆ–è€…ä¾èµ–ç±»çš„å…¶ä»–ç±»è¿‡å¤šï¼›ç§æœ‰æ–¹æ³•è¿‡å¤šï¼›æ¯”è¾ƒéš¾ç»™ç±»èµ·ä¸€ä¸ªåˆé€‚çš„åå­—ï¼›ç±»ä¸­å¤§é‡çš„æ–¹æ³•éƒ½æ˜¯é›†ä¸­æ“ä½œç±»ä¸­çš„æŸå‡ ä¸ªå±æ€§ã€‚
> 3. **ç±»çš„èŒè´£æ˜¯å¦è®¾è®¡å¾—è¶Šå•ä¸€è¶Šå¥½ï¼Ÿ**å•ä¸€èŒè´£åŸåˆ™é€šè¿‡é¿å…è®¾è®¡å¤§è€Œå…¨çš„ç±»ï¼Œé¿å…å°†ä¸ç›¸å…³çš„åŠŸèƒ½è€¦åˆåœ¨ä¸€èµ·ï¼Œæ¥æé«˜ç±»çš„å†…èšæ€§ã€‚åŒæ—¶ï¼Œç±»èŒè´£å•ä¸€ï¼Œç±»ä¾èµ–çš„å’Œè¢«ä¾èµ–çš„å…¶ä»–ç±»ä¹Ÿä¼šå˜å°‘ï¼Œå‡å°‘äº†ä»£ç çš„è€¦åˆæ€§ï¼Œä»¥æ­¤æ¥å®ç°ä»£ç çš„é«˜å†…èšã€ä½è€¦åˆã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‹†åˆ†å¾—è¿‡ç»†ï¼Œå®é™…ä¸Šä¼šé€‚å¾—å…¶åï¼Œåå€’ä¼šé™ä½å†…èšæ€§ï¼Œä¹Ÿä¼šå½±å“ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚

### å¼€æ”¾å°é—­åŸåˆ™

**å¯¹æ–°å¢å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­**

å¼€é—­åŸåˆ™è§„å®šè½¯ä»¶è®¾è®¡ä¸­çš„å¯¹è±¡ã€ç±»ã€æ¨¡å—ä»¥åŠå‡½æ•°ç­‰å¯¹äºæ‰©å±•æ˜¯å¼€æ”¾çš„ï¼Œä½†æ˜¯å¯¹äºä¿®æ”¹æ˜¯å°é—­çš„ã€‚å¦‚æœä¸€ä¸ªåŠŸèƒ½æ¨¡å—å·²ç»å¼€å‘ã€æµ‹è¯•å®Œæ¯•ï¼Œé‚£ä¹ˆå¯¹å…¶ä»£ç ç›´æ¥è¿›è¡Œä¿®æ”¹ä¾¿æ˜¯æœ‰å¾ˆå¤§é£é™©çš„ã€‚å¦‚æœæœ‰æ–°çš„ä¸šåŠ¡åŠŸèƒ½ï¼Œé‚£ä¹ˆåº”å½“åšçš„äº‹æƒ…æ˜¯å¯¹äºç°æœ‰ä»£ç è¿›ä¸€æ­¥**æ‰©å±•**ï¼Œè€Œä¸æ˜¯ä¿®æ”¹ç°æœ‰ä»£ç ã€‚

æ¯”å¦‚å¯ä»¥åˆ›å»ºä¸€ä¸ªå­ç±»æ¥é‡å†™è¿™éƒ¨åˆ†ä¸šåŠ¡é€»è¾‘ä»¥è¾¾åˆ°ç›®çš„ç­‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åº”è¯¥é€‰æ‹©ä½¿ç”¨æŠ½è±¡æ¥å®šä¹‰ç»“æ„ï¼Œç”¨å…·ä½“å®ç°æ¥æ‰©å±•ç»†èŠ‚ã€‚

> ä¸Šè¿°è®¨è®ºçš„å‰ææ˜¯ä»£ç ä¸­æ²¡æœ‰ç¼ºé™·ç­‰é—®é¢˜ï¼Œå¦‚æœä»£ç ä¸­å­˜åœ¨ç¼ºé™·ã€bugç­‰ï¼Œé‚£ä¹ˆç›´æ¥å¯¹å…¶è¿›è¡Œä¿®å¤å³å¯ã€‚

æ¯”å¦‚ï¼Œæˆ‘ä»¬åœ¨å­¦ä¹ æ•°æ®åº“æ—¶ï¼Œä½¿ç”¨`Java`è¯­è¨€è¿æ¥æ•°æ®åº“ï¼Œè¿™ç§æ–¹å¼æˆ‘ä»¬ç§°ä¹‹ä¸º`JDBC`ã€‚ä½¿ç”¨`Java`è¯­è¨€è¿æ¥æ•°æ®åº“ï¼Œå¯ä»¥è¿æ¥`Mysql`æ•°æ®åº“ï¼Œä¹Ÿå¯ä»¥è¿æ¥`Oracle`æ•°æ®åº“ã€‚å¦‚æœæˆ‘ä»¬ä¹‹å‰ä½¿ç”¨`Mysql`æ•°æ®åº“ï¼Œå¦‚ä½•æ‰©å±•åˆ°å¯¹äº`Oracle`æ•°æ®åº“çš„æ”¯æŒå‘¢ï¼Ÿç›¸ä¿¡å¤§å®¶åº”è¯¥éƒ½ä¸ä¼šé™Œç”Ÿçš„ã€‚

è®¾è®¡ä¸€ä¸ª`Connection`æ¥å£ï¼Œä¸åŒçš„æ•°æ®åº“å‚å•†é’ˆå¯¹è¯¥æ¥å£ï¼Œè®¾è®¡è‡ªå·±çš„`Connection`å®ç°ç±»ã€‚

![image-20230907084956955](.\assets\image-20230907084956955.png)



### é‡Œæ°æ›¿æ¢åŸåˆ™

å®ƒç”±èŠ­èŠ­æ‹‰Â·åˆ©æ–¯ç§‘å¤«ï¼ˆBarbara Liskovï¼‰åœ¨1987å¹´åœ¨ä¸€æ¬¡ä¼šè®®ä¸Šåä¸ºã€Šæ•°æ®çš„æŠ½è±¡ä¸å±‚æ¬¡ã€‹çš„æ¼”è¯´ä¸­é¦–å…ˆæå‡ºã€‚ä¸»è¦å†…å®¹å¦‚ä¸‹ï¼š

**å¦‚æœSæ˜¯Tçš„å­ç±»å‹ï¼Œå¯¹äºSç±»å‹çš„ä»»æ„å¯¹è±¡ï¼Œå¦‚æœå°†ä»–ä»¬çœ‹ä½œæ˜¯Tç±»å‹çš„å¯¹è±¡ï¼Œåˆ™å®ƒçš„è¡Œä¸ºä¹Ÿç†åº”å’Œé¢„æœŸçš„è¡Œä¸ºä¸€è‡´**ã€‚

> è¿™é‡Œçš„é¢„æœŸè¡Œä¸ºæŒ‡çš„æ˜¯Tç±»å‹çš„è¡Œä¸ºï¼Œå› ä¸ºç”¨çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡æ—¶ï¼Œä¼šæœ‰å¤šæ€çš„å‡ºç°ã€‚å¦‚æœæ–¹æ³•è°ƒç”¨å’Œå®šä¹‰ä¹‹é—´éš”äº†å¾ˆé•¿ï¼Œåœ¨ä½¿ç”¨è¿™ä¸ªå¯¹è±¡æ—¶ï¼Œé¢„æœŸæ˜¯å‡ºç°çˆ¶ç±»çš„è¡Œä¸ºã€‚**æ‰€ä»¥é‡Œæ°åŸåˆ™çš„æ„æ€æ˜¯ä¸ä½¿ç”¨æ–¹æ³•é‡å†™ã€‚**

è¿™æ„å‘³ç€**å­ç±»å¿…é¡»ä¿æŒä¸çˆ¶ç±»è¡Œä¸ºçš„å…¼å®¹**ã€‚*åœ¨é‡å†™ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œä½ è¦å¯¹åŸºç±»è¡Œä¸ºè¿›è¡Œæ‰©å±•ï¼Œè€Œä¸æ˜¯å°†å…¶å®Œå…¨æ›¿æ¢ã€‚* **åœ¨ä½¿ç”¨çˆ¶ç±»çš„ç¨‹åºä¸­ï¼Œæ›¿æ¢ä¸ºä½¿ç”¨å­ç±»ï¼Œé‚£ä¹ˆç¨‹åºçš„è¿è¡Œç»“æœåº”è¯¥æ˜¯ä¸€è‡´çš„ï¼Œä¸ä¼šå‘ç”Ÿä»»ä½•å¼‚å¸¸**ã€‚ä¸‹é¢çš„ä¸€ä¸ªæ¡ˆä¾‹ä¾¿æ˜¯è¿åäº†é‡Œæ°æ›¿æ¢åŸåˆ™ã€‚

![image-20230907085040109](.\assets\image-20230907085040109.png)

ä¸Šè¿°æ¡ˆä¾‹å¦‚ä½•æ”¹è¿›å‘¢ï¼Ÿ**å­ç±»çš„è¡Œä¸ºåº”å½“å’Œçˆ¶ç±»ä¿æŒä¸€è‡´**ï¼Œä½†æ˜¯**å­ç±»å¯ä»¥åœ¨çˆ¶ç±»çš„åŸºç¡€ä¸Šåšè¿›ä¸€æ­¥çš„æ‰©å±•**ã€‚ä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼š

![image-20230907085053003](.\assets\image-20230907085053003.png)

### è¿ªç±³ç‰¹æ³•åˆ™

> å°½é‡ä¸ä¾èµ–ï¼Œéå¾—ä¾èµ–çš„è¯ï¼Œä¾èµ–æ¥å£

åˆå«ä½œ**æœ€å°‘çŸ¥é“åŸåˆ™**ï¼ŒæŒ‡çš„æ˜¯ä¸€ä¸ªç±»/æ¨¡å—å¯¹äºå…¶ä»–çš„ç±»/æ¨¡å—æœ‰è¶Šå°‘çš„äº†è§£è¶Šå¥½ã€‚ç®€å•æ¥è¯´å°±æ˜¯ä¸åº”è¯¥æœ‰**ä¾èµ–å…³ç³»**çš„ç±»ä¹‹é—´ï¼Œä¸è¦å­˜åœ¨ä¾èµ–å…³ç³»ï¼›æœ‰ä¾èµ–å…³ç³»çš„ç±»ä¹‹é—´ï¼Œå°½é‡åªä¾èµ–äºæ¥å£ã€‚

è¿ªç±³ç‰¹æ³•åˆ™è¿˜æœ‰ä¸€ä¸ªæ›´ç®€å•çš„å®šä¹‰ï¼š**åªä¸ç›´æ¥çš„æœ‹å‹é€šä¿¡**ã€‚ä»€ä¹ˆæ˜¯ç›´æ¥çš„æœ‹å‹å‘¢ï¼Ÿæˆ‘ä»¬ç§°å‡ºç°æˆå‘˜å˜é‡ã€æ–¹æ³•å‚æ•°ã€æ–¹æ³•è¿”å›å€¼ä¸­çš„ç±»ä¸ºç›´æ¥çš„æœ‹å‹ï¼Œè€Œå‡ºç°åœ¨å±€éƒ¨å˜é‡ä¸­çš„ç±»åˆ™ä¸æ˜¯ç›´æ¥çš„æœ‹å‹ã€‚**ä¹Ÿå°±æ˜¯è¯´ï¼Œé™Œç”Ÿçš„ç±»æœ€å¥½ä¸è¦ä½œä¸ºå±€éƒ¨å˜é‡çš„å½¢å¼å‡ºç°åœ¨ç±»çš„å†…éƒ¨ã€‚**ä¸è¦å’Œ"é™Œç”Ÿäºº"è¯´è¯ã€‚æ¯”å¦‚æ˜æ˜Ÿå’Œç»çºªäººä¹‹é—´çš„å…³ç³»ï¼Œæ˜æ˜Ÿå¤„ç†å„ç§äº‹é¡¹ï¼Œæ¯”å¦‚ç²‰ä¸è§é¢ä¼šã€å•†ä¸šåˆä½œã€å‰§é‚€çº¦ç­‰äº‹é¡¹ï¼Œå¦‚æœå…¨éƒ¨éƒ½äº²åŠ›äº²ä¸ºï¼Œæ˜¾ç„¶æ²¡æœ‰é‚£ä¹ˆå¤šçš„ç²¾åŠ›ï¼›å¯ä»¥å°†è¿™äº›äº‹é¡¹å…¨éƒ¨å§”æ‰˜ç»™ç»çºªäººä»£ä¸ºåŠç†ã€‚

å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå…¨éƒ¨çš„äº‹æƒ…éƒ½ç”±è‡ªå·±äº²åŠ›äº²ä¸ºã€‚æ­¤æ—¶ä¸€ä¸ªç±»ä¸­æœ‰è¿‡å¤šçš„ä¾èµ–ã€‚

![image-20230907085137742](.\assets\image-20230907085137742.png)

å¯ä»¥æŒ‰ç…§å¦‚ä¸‹æ–¹å¼æ¥è¿›è¡Œä¿®æ”¹ï¼Œåœ¨æœ¬æ¡ˆä¾‹ä¸­ï¼Œç»çºªäººæ˜¯æ˜æ˜Ÿçš„æœ‹å‹ï¼Œå…¶ä»–å‡æ˜¯é™Œç”Ÿäººï¼Œå°½é‡ä¸è¦å’Œé™Œç”Ÿäººä¹‹é—´äº§ç”Ÿä¾èµ–ã€‚

![image-20230907085151959](.\assets\image-20230907085151959.png)

è¿˜æ¯”å¦‚ï¼Œè€å¸ˆè®©ç­é•¿ç‚¹åï¼Œç»Ÿè®¡å½“å¤©åˆ°çš„å­¦ç”Ÿçš„äººæ•°ã€‚å¦‚æœè€å¸ˆé™¤äº†ä¾èµ–ç­é•¿ï¼Œè¿˜ä¾èµ–å­¦ç”Ÿï¼Œé‚£ä¹ˆå°±ä¸æ»¡è¶³è¿ªç±³ç‰¹æ³•åˆ™ï¼Œä¸åº”è¯¥æœ‰ä¾èµ–å…³ç³»çš„ç±»ä¹‹é—´å°½é‡ä¸è¦æœ‰ä¾èµ–å…³ç³»ï¼›ç›¸åï¼Œè€å¸ˆåªéœ€è¦ä¾èµ–ç­é•¿å³å¯ã€‚

é”™è¯¯ä»£ç ï¼š

```java
public class Teacher {
    public void command(){
        //è€¦åˆäº†studentç±»
        List<Student> students = new ArrayList<Student>();
        for(int i=0; i<20; i++){
            students.add(new Student());
        }
        
        //è€¦åˆäº†studentleaderç±»
        StudentLeader leader = new StudentLeader();
        System.out.println("æ¸…ç‚¹äººæ•°å®Œæ¯•ï¼Œæ€»å…±æœ‰:"+leader.counts(students)+"äºº");
        
    }
}

public class Student {

}

//ç­å¹²éƒ¨è´Ÿè´£æ¸…ç‚¹äººæ•°
public class StudentLeader {
    public int counts(List<Student> lists){
        return lists.size();
    }
}
public class Client{
    public static void main(String[] args){
        System.out.println("å‘¨æœ«æ”¶å‡ï¼Œå­¦æ ¡é¢†å¯¼å‘½ä»¤è€å¸ˆå»ç‚¹å.....");
        Teacher teacher = new Teacher();
        teacher.command();
    }
}
```

æ­£ç¡®ä»£ç 

```java
public class LODTeacher {
    //ä»…ä»…è€¦åˆäº†LODStudentLeaderç±»
    public void command(LODStudentLeader leader){
        System.out.println("æ¸…ç‚¹äººæ•°å®Œæ¯•ï¼Œæ€»å…±æœ‰:"+leader.counts()+"äºº");
    }
}

public class LODStudentLeader {
    //ä»…ä»…è€¦åˆäº†studentç±»
    private List<Student> students;
    
    public LODStudentLeader(List<Student> students){
        this.students = students;
    }
    public int counts(){
        return students.size();
    }
}

public class TaskTest {
    public static void main(String[] args) {
        System.out.println("å‘¨æœ«æ”¶å‡ï¼Œå­¦æ ¡é¢†å¯¼å‘½ä»¤è€å¸ˆå»ç‚¹å.....");
        List<Student> students = new ArrayList<Student>();
        for(int i = 0; i < 20; i++ ){
              students.add(new Student());
        }
        LODTeacher teacher = new LODTeacher();
        teacher.command(new LODStudentLeader(students));
    }
}
```

### æ¥å£éš”ç¦»åŸåˆ™

ä¸€ä¸ªç±»å¯¹å¦å¤–ä¸€ä¸ªç±»çš„ä¾èµ–åº”å½“å»ºç«‹åœ¨**æœ€å°çš„æ¥å£**ä¸Šã€‚è¿™å¥è¯çš„å«ä¹‰å…¶å®æ˜¯è¦ä¸ºå„ä¸ªç±»å»ºç«‹å®ƒä»¬éœ€è¦çš„**ä¸“ç”¨æ¥å£**ï¼Œè€Œä¸è¦è¯•å›¾å»å»ºç«‹ä¸€ä¸ªå¾ˆåºå¤§çš„æ¥å£ä¾›æ‰€æœ‰ä¾èµ–å®ƒçš„ç±»å»è°ƒç”¨ã€‚

> å°†æ¥å£é‡Œçš„æŠ½è±¡æ–¹æ³•å†™çš„å°½é‡å°‘

å‡è®¾ç›®å‰æˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€å¥—ç¨‹åºï¼Œè¯¥ç¨‹åºå¯ä»¥å¾ˆæ–¹ä¾¿åœ°å’Œç›®å‰å¸‚é¢ä¸Šçš„äº‘æœåŠ¡å™¨è¿›è¡Œæ•´åˆã€‚è™½ç„¶æœ€åˆç‰ˆæœ¬æ˜¯ä»¥é˜¿é‡Œäº‘æœåŠ¡å™¨æ¥è¿›è¡Œå¼€å‘å¯¹æ¥ï¼Œä½†æ˜¯å¸Œæœ›åæœŸå¯ä»¥å»¶å±•åˆ°æ‰€æœ‰çš„äº‘æœåŠ¡å™¨ä¹‹ä¸Šã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¼€å‘è®¾è®¡äº†ä¸€å¥—æ¥å£åŒ…å«äº†å„ä¸ªé˜¶æ®µçš„åŠŸèƒ½ã€‚

![image-20230907085213239](.\assets\image-20230907085213239.png)

é€šè¿‡ä¸Šå›¾ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œåç»­æ•´åˆè…¾è®¯äº‘æœåŠ¡å™¨æ—¶ï¼Œæˆ‘ä»¬å‘ç°ï¼Œæœ‰å‡ ä¸ªåŠŸèƒ½æš‚æœªå®ç°ã€‚éµå¾ªæ¥å£éš”ç¦»åŸåˆ™ï¼Œæˆ‘ä»¬æ­¤æ—¶è®¾è®¡çš„æ¥å£å°±ä¸ç¬¦åˆæœ€å°æ¥å£çš„è¦æ±‚ã€‚æˆ‘ä»¬åº”å½“å°†ä¸Šè¿°å¤æ‚ã€åºå¤§çš„æ¥å£æ‹†åˆ†ä¸ºä¸€ç»„**é¢—ç²’åº¦**æ›´å°çš„æ¥å£ã€‚

![image-20230907085229339](.\assets\image-20230907085229339.png)



### ä¾èµ–å€’ç½®åŸåˆ™

æŒ‡çš„æ˜¯è®¾è®¡ä»£ç æ¶æ„æ—¶ï¼Œ**é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–äºåº•å±‚æ¨¡å—ï¼ŒäºŒè€…éƒ½åº”è¯¥ä¾èµ–äºæŠ½è±¡**ã€‚**æŠ½è±¡ä¸åº”è¯¥ä¾èµ–äºç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚**å…¶æ‰€è¡¨è¾¾çš„å«ä¹‰æ˜¯æŒ‡åœ¨è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­ï¼Œç»†èŠ‚å…·æœ‰å¤šå˜æ€§ï¼Œè€ŒæŠ½è±¡åˆ™ç›¸å¯¹ç¨³å®šï¼Œå› æ­¤ä»¥æŠ½è±¡ä¸ºåŸºç¡€æ­å»ºèµ·æ¥çš„æ¶æ„è¦æ¯”ä»¥ç»†èŠ‚ä¸ºåŸºç¡€æ­å»ºèµ·æ¥çš„æ¶æ„ç¨³å®šçš„å¤šã€‚

å‡è®¾ï¼Œæˆ‘ä»¬æ­£åœ¨ç»„è£…ä¸€å°ç”µè„‘ï¼Œ`CPU`æ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©`Intel`æˆ–è€…`AMD`;å†…å­˜æ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©`Kingston`æˆ–è€…`ADATA`;ç¡¬ç›˜æ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©`SEAGATE`æˆ–è€…`SanDisk`.æˆ‘ä»¬å¯ä»¥æŒ‰ç…§å¦‚ä¸‹æ–¹å¼æ¥è¿›è¡Œç»„ç»‡ï¼š

![image-20230907085250272](.\assets\image-20230907085250272.png)

ä¸Šå›¾çš„è®¾è®¡æ¶æ„ï¼Œåˆçœ‹æ²¡è§‰å¾—æœ‰ä½•ä¸å¦¥ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬éœ€è¦æ›´æ¢ä¸åŒçš„å“ç‰Œå‹å·ï¼Œé‚£ä¹ˆæ­¤æ—¶ï¼Œæˆ‘ä»¬çš„`Computer`ç±»éœ€è¦è¿›è¡Œå¤§å¹…çš„ä¿®æ”¹ã€‚

éµå¾ªä¾èµ–å€’ç½®åŸåˆ™ï¼Œé«˜å±‚æ¨¡å—ä»£ç åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚

![image-20230907085313563](.\assets\image-20230907085313563.png)



# å¸¸ç”¨è®¾è®¡æ¨¡å¼

## åˆ›å»ºå‹æ¨¡å¼

åˆ›å»ºå‹æ¨¡å¼æä¾›äº†åˆ›å»ºå¯¹è±¡çš„æœºåˆ¶ï¼Œèƒ½å¤Ÿæå‡å·²æœ‰ä»£ç çš„çµæ´»æ€§å’Œå¯å¤ç”¨æ€§ã€‚

### å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰

> å•ä¾‹ï¼šå•ä¸ªå®ä¾‹
>
> âš¡âš¡ è¦ä¼šæ‰‹å†™å•ä¾‹
>
> ```java
> public class SingletonUltra{
> 	private SingletonUltra instance;
> 	private SingletonUltra(){}
> 	public static getSingletonUltra(){
> 		if(instance == null){
> 			synchronized(Singlton.class){
> 				if(instance == null){
> 					instance = new SingletonUltra();
> 				}
> 			}
> 		}
> 		return instance;
> 	}
> }
> ```
>
> `Servlet`å’Œ`ServletContext`å°±æ˜¯å•ä¾‹æ¨¡å¼
>
> æ³¨æ„å•ä¾‹æœ‰çº¿ç¨‹ä¸å®‰å…¨çš„é£é™©ã€‚

å•ä¾‹æ˜¯ä¸€ç§åˆ›å»ºå‹è®¾è®¡æ¨¡å¼ï¼Œè®©ä½ ä¿è¯ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œå¹¶æä¾›äº†ä¸€ä¸ªè®¿é—®è¯¥å®ä¾‹å¯¹è±¡çš„**å…¨å±€èŠ‚ç‚¹**ã€‚

> åœ¨ä»»æ„ä½ç½®ï¼Œå¯ä»¥é€šè¿‡æ–¹æ³•è·å¾—è¯¥å•ä¾‹å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåº”è¯¥æ˜¯**è°ƒç”¨é™æ€æ–¹æ³•**

![image-20230907085353236](.\assets\image-20230907085353236.png)

> æ»¡è¶³çš„æ¡ä»¶ï¼š
>
> 1. ç§æœ‰åŒ–æ„é€ å™¨
> 2. æä¾›ä¸€ä¸ªé™æ€æ–¹æ³•è¿”å›è¿™ä¸ªå•ä¾‹
> 3. å®šä¹‰ä¸€ä¸ªå…¨å±€çš„é™æ€æˆå‘˜å˜é‡ï¼Œæ¥æ”¾ç½®è¿™ä¸ªå•ä¾‹

å¯¹åº”çš„UMLç±»å›¾å¦‚ä¸‹

![image-20230907085414178](.\assets\image-20230907085414178.png)

#### é¥¿æ±‰æ¨¡å¼

ç«‹å³åŠ è½½

åœ¨ç±»åŠ è½½çš„è¿‡ç¨‹ä¸­åˆå§‹åŒ–äº†ç§æœ‰çš„é™æ€å®ä¾‹å¯¹è±¡ï¼Œä¿è¯äº†è¯¥å®ä¾‹å¯¹è±¡çš„çº¿ç¨‹å®‰å…¨æ€§ã€‚å› ä¸ºè¯¥å®ä¾‹å¯¹è±¡å…ˆäºä½¿ç”¨å‰æä¾›ï¼Œæ‰€ä»¥ç§°ä¹‹ä¸ºé¥¿æ±‰æ¨¡å¼ã€‚

```java
package com.cskaoyan.pattern.singleton;

public class Singleton1 {

    //åˆ›å»ºç§æœ‰é™æ€å®ä¾‹å¯¹è±¡
    private static final Singleton1 instance = new Singleton1();

    //ç§æœ‰åŒ–æ„é€ å‡½æ•°
    private Singleton1(){}

    public static Singleton1 getInstance(){
        return instance;
    }
}
```

é¥¿æ±‰å¼ç‰¹ç‚¹ï¼šä¸æ”¯æŒå»¶æ—¶åŠ è½½ï¼ˆæ‡’åŠ è½½ï¼‰ï¼Œè·å–å¯¹è±¡é€Ÿåº¦æ¯”è¾ƒå¿«ï¼›ä½†æ˜¯å¦‚æœå¯¹è±¡æ¯”è¾ƒå¤§ï¼Œæˆ–è€…ä¸€ç›´æ²¡æœ‰å»ä½¿ç”¨ï¼Œé‚£ä¹ˆæ¯”è¾ƒæµªè´¹å†…å­˜ç©ºé—´ã€‚

#### æ‡’æ±‰æ¨¡å¼(çº¿ç¨‹ä¸å®‰å…¨)

> 1. ä½¿ç”¨çš„æ—¶å€™æ‰åŠ è½½
> 2. åªåŠ è½½ä¸€æ¬¡
>
> ä¹Ÿå°±æ˜¯ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨çš„æ—¶å€™å®ä¾‹åŒ–ã€‚
>
>  âš¡å¦‚ä½•åˆ¤æ–­å‡ºæ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨å‘¢,åˆ¤æ–­è¯¥å®ä¾‹å¯¹è±¡æ˜¯éä¸º`null`
>
> çº¿ç¨‹ä¸å®‰å…¨çš„åŸå› ï¼Œå¤šä¸ªçº¿ç¨‹æŠ¢å `if`åˆ¤æ–­ã€‚æƒ³è¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œå°±éœ€è¦ä½¿ç”¨`sychronized`è¿›è¡Œä¸Šé”ã€‚è¿›ä¸€æ­¥åœ°ï¼Œ`double check`ï¼Œåœ¨é”å¤–é¢å†åŠ ä¸€ä¸ª`if`åˆ¤æ–­ï¼Œ**å‡å°‘é”çš„äº‰æŠ¢æ¬¡æ•°**ï¼Œå¦‚æœæ˜¯ç©ºæ‰ä¼šç»§ç»­æŠ¢é”ï¼Œå¦åˆ™ç›´æ¥è¿”å›ã€‚

```java
package com.cskaoyan.pattern.singleton;

public class Singleton2 {

    private static Singleton2 instance;

    //ç§æœ‰åŒ–æ„é€ å‡½æ•°
    private Singleton2(){}

    //åˆ¤æ–­å½“å‰å¯¹è±¡æ˜¯å¦å·²ç»è¢«åˆ›å»º
    public static Singleton2 getInstance(){
        if(instance == null){
            instance = new Singleton2();
        }
        return instance;
    }
}
```

ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œæˆ‘ä»¬ä½¿ç”¨`1000`ä¸ªçº¿ç¨‹æ¥åˆ›å»º`Singleton2`å¯¹è±¡ï¼Œå‘ç°å¯¹è±¡çš„åœ°å€ä¸åŒã€‚**äº§ç”Ÿä¸Šè¿°é—®é¢˜çš„ä¸»è¦åŸå› åœ¨äºæˆ‘ä»¬æ‰§è¡Œçš„ä»£ç å…¶å®éƒ½ä¸æ˜¯åŸå­æ€§ï¼Œåœ¨å¤šçº¿ç¨‹æ“ä½œçš„è¿‡ç¨‹ä¸­ï¼Œä¼šè¿›è¡Œçº¿ç¨‹åˆ‡æ¢ã€‚æ¯”å¦‚çº¿ç¨‹Aæ‰§è¡Œåˆ°` if(instance == null)`ï¼Œç»§ç»­æ‰§è¡Œä»£ç ä¾¿ä¼šåˆ›å»ºinstanceå®ä¾‹å¯¹è±¡ï¼Œ ä½†æ˜¯æ­¤æ—¶è¿›è¡Œäº†çº¿ç¨‹åˆ‡æ¢ï¼›åˆ‡æ¢åˆ°äº†çº¿ç¨‹Bï¼Œçº¿ç¨‹Båˆ›å»ºäº†instanceå¯¹è±¡ï¼›éšåå†æ¬¡çº¿ç¨‹åˆ‡æ¢ç»™çº¿ç¨‹Aï¼Œå› ä¸ºçº¿ç¨‹Aå·²ç»æ‰§è¡Œè¿‡åˆ¤æ–­ï¼Œæ‰€ä»¥ä¾¿ä¼šç›´æ¥æ‰§è¡Œ`instance = new Singleton2();`ï¼Œä¾¿åˆä¼šåˆ›å»ºä¸€ä¸ªå¯¹è±¡**ã€‚

![image-20230907085438018](.\assets\image-20230907085438018.png)

#### æ‡’æ±‰æ¨¡å¼(çº¿ç¨‹å®‰å…¨)

å¦‚ä½•ä¿è¯çº¿ç¨‹å®‰å…¨å‘¢ï¼Ÿä½¿ç”¨`synchronized`å…³é”®å­—å³å¯ã€‚

```java
package com.cskaoyan.pattern.singleton;

public class Singleton3 {

    private static Singleton3 instance;

    //ç§æœ‰åŒ–æ„é€ å‡½æ•°
    private Singleton3(){}

    //å¼•å…¥synchronizedï¼Œä¿è¯å¤šçº¿ç¨‹æ¨¡å¼ä¸‹å®ä¾‹å¯¹è±¡çš„å”¯ä¸€æ€§
    public static synchronized Singleton3 getInstance(){
        if(instance == null){
            instance = new Singleton3();
        }
        return instance;
    }
}
```

ä½¿ç”¨`synchronized`é”ä½å¯¹è±¡åˆ›å»ºçš„æ–¹æ³•ï¼Œé˜²æ­¢è¯¥æ–¹æ³•è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è°ƒç”¨ã€‚

ä½†æ˜¯è¿™ç§æ–¹å¼æœ€åˆé€‚å—ï¼Ÿ

**å› ä¸ºæˆ‘ä»¬å¯¹`getInstance()`æ·»åŠ äº†é”ï¼Œé™ä½äº†è¯¥æ–¹æ³•çš„å¹¶å‘é‡ï¼›å®é™…ä¸Šï¼Œæˆ‘ä»¬åªéœ€è¦é’ˆå¯¹æœ€å¼€å§‹æŠ¢å…ˆåˆ›å»ºå®ä¾‹å¯¹è±¡çš„çº¿ç¨‹åŠ é”å³å¯ï¼Œåç»­çš„çº¿ç¨‹åœ¨æ‰§è¡Œæ—¶ï¼Œå› ä¸º`if(instance == null)`æ¡ä»¶å·²ç»ä¸æ»¡è¶³ï¼Œæ‰€ä»¥ç›´æ¥æ‰§è¡Œè¿”å›å®ä¾‹å¯¹è±¡å³å¯ï¼Œæ­¤æ—¶ä¸éœ€è¦åŠ é”**ã€‚

#### åŒé‡æ£€æŸ¥(`Double Check`)

é’ˆå¯¹ä¸Šè¿°å­˜åœ¨çš„é—®é¢˜ï¼Œæˆ‘ä»¬åšäº†è¿›ä¸€æ­¥ä¿®æ”¹ã€‚è¿™ç§æ–¹å¼æœ€æ˜æ˜¾çš„ç‰¹å¾æ˜¯`synchronized`å…³é”®å­—ä¸æ˜¯ä¿®é¥°æ•´ä¸ªæ–¹æ³•ï¼Œè€Œæ˜¯ä»…ä¿®é¥°åˆ›å»ºå¯¹è±¡çš„ä»£ç å—ï¼Œå¯ä»¥**æé«˜å¹¶å‘**ï¼›æ­¤å¤–ï¼Œå­˜åœ¨ä¸¤ä¸ª`if`æ¡ä»¶åˆ¤æ–­è¯­å¥ã€‚è¿™ä¹Ÿæ˜¯åŒé‡æ£€æŸ¥çš„ç”±æ¥ã€‚

**ä¸ºä»€ä¹ˆéœ€è¦åŒé‡æ£€æŸ¥å‘¢ï¼Ÿ**

çº¿ç¨‹Aå¯èƒ½å…ˆæ‰§è¡Œåˆ°äº†å¤–å±‚çš„`if`æ¡ä»¶åˆ¤æ–­ï¼Œæ‰§è¡Œé€šè¿‡ä¹‹åå¹¶æ²¡æœ‰è¿›ä¸€æ­¥æ‰§è¡Œï¼Œè€Œæ˜¯è¿›è¡Œäº†çº¿ç¨‹çš„åˆ‡æ¢ï¼Œåˆ‡æ¢æˆäº†çº¿ç¨‹Bï¼›çº¿ç¨‹Bä¹Ÿæ‰§è¡Œäº†å¤–å±‚çš„`if`æ¡ä»¶åˆ¤æ–­ï¼Œå¹¶ä¸”é¡ºåˆ©åœ°è·å–åˆ°äº†é”ï¼Œæ‰§è¡Œå®Œäº†å†…éƒ¨çš„`if`æ¡ä»¶åˆ¤æ–­ï¼Œåˆ›å»ºäº†å®ä¾‹å¯¹è±¡ï¼›å¦‚æœæ­¤æ—¶çº¿ç¨‹å†æ¬¡åˆ‡æ¢ç»™çº¿ç¨‹Aï¼Œçº¿ç¨‹Aå› ä¸ºåˆšåˆšå·²ç»æ‰§è¡Œå®Œå¤–å±‚çš„`if`æ¡ä»¶åˆ¤æ–­ï¼Œæ­¤æ—¶é¡ºåˆ©çš„è·å–åˆ°äº†é”ï¼Œå¦‚æœæ²¡æœ‰å†…éƒ¨çš„`if`æ¡ä»¶åˆ¤æ–­ï¼Œåˆ™ä¼šå†æ¬¡åˆ›å»ºä¸€ä¸ªå®ä¾‹å¯¹è±¡ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä½•ä¸€å®šè¦åŒé‡æ£€æŸ¥çš„åŸå› ã€‚

 ```java
package com.cskaoyan.pattern.singleton;

public class Singleton4 {

    private static Singleton4 instance;

    //ç§æœ‰åŒ–æ„é€ å‡½æ•°
    private Singleton4(){}
    
    public static Singleton4 getInstance(){
        if(instance == null){
            synchronized (Singleton4.class){
                if(instance == null){
                    instance = new Singleton4();
                }
            }
        }
        return instance;
    }
}
 ```

#### é™æ€å†…éƒ¨ç±»

> é™æ€å†…éƒ¨ç±»ç±»åŠ è½½çš„æ—¶å€™æ‰§è¡Œï¼Œå¹¶ä¸”åªæ‰§è¡Œä¸€æ¬¡.

åˆ©ç”¨**é™æ€å†…éƒ¨ç±»æ¥è§£å†³å»¶è¿ŸåŠ è½½ã€çº¿ç¨‹å®‰å…¨çš„é—®é¢˜**ï¼›å¹¶ä¸”å¯ä»¥ä½¿å¾—ä»£ç æ›´åŠ ç®€æ´ã€‚ç”±`JVM`æ¥ä¿éšœçº¿ç¨‹å®‰å…¨æ€§ã€‚

```java
public class Singleton5 {

    private static Singleton5 instance;

    //ç§æœ‰åŒ–æ„é€ å‡½æ•°
    private Singleton5(){}
	
    //é™æ€å†…éƒ¨ç±»
    private static class SingletonHolder{
        private static Singleton5 instance = new Singleton5();
    }

    public static Singleton5 getInstance(){

        return SingletonHolder.instance;
    }
}
```

#### æšä¸¾(ä¸å»ºè®®å†™)

```java
public enum Singleton6 {

    INSTANCE;

    public static Singleton6 getInstance(){
        return INSTANCE;
    }
}
```

#### æ€»ç»“

- é¥¿æ±‰å¼ï¼šåœ¨ç±»åŠ è½½æ—¶æœŸï¼Œä¾¿å·²ç»å°†instanceå®ä¾‹å¯¹è±¡åˆ›å»ºäº†ï¼›æ‰€ä»¥è¿™ç§æ–¹å¼æ˜¯çº¿ç¨‹å®‰å…¨çš„æ–¹å¼ï¼Œä½†æ˜¯ä¸æ”¯æŒæ‡’åŠ è½½ã€‚
- æ‡’æ±‰å¼ï¼šè¯¥ç§æ–¹å¼æ”¯æŒæ‡’åŠ è½½ï¼Œä½†æ˜¯è¦ä¹ˆä¸æ˜¯çº¿ç¨‹å®‰å…¨ï¼Œè¦ä¹ˆè™½ç„¶æ˜¯çº¿ç¨‹å®‰å…¨ï¼Œä½†æ˜¯éœ€è¦é¢‘ç¹é‡Šæ”¾é”ã€æŠ¢å¤ºé”ï¼Œå¹¶å‘é‡è¾ƒä½ã€‚
- åŒé‡æ£€æŸ¥ï¼šæ—¢å¯ä»¥å®ç°æ‡’åŠ è½½ï¼Œåˆå¯ä»¥å®ç°é«˜å¹¶å‘çš„éœ€æ±‚ã€‚è¿™ç§æ–¹å¼æ¯”è¾ƒå®Œç¾ï¼Œä½†æ˜¯ä»£ç æœ‰ä¸€äº›å¤æ‚ã€‚
- é™æ€å†…éƒ¨ç±»ï¼šä½¿ç”¨è¯¥ç§æ–¹å¼ä¹Ÿå¯ä»¥è§£å†³æ‡’åŠ è½½ä»¥åŠé«˜å¹¶å‘çš„é—®é¢˜ï¼Œä»£ç å®ç°èµ·æ¥æ¯”åŒé‡æ£€æŸ¥ä¹Ÿæ˜¯æ¯”è¾ƒç®€æ´ã€‚
- æšä¸¾ï¼šæœ€ç®€å•ã€æœ€å®Œç¾çš„å®ç°æ–¹å¼ã€‚

### å·¥å‚æ¨¡å¼ï¼ˆFactoryï¼‰

å·¥å‚é¡¾åæ€ä¹‰å°±æ˜¯ç”Ÿäº§äº§å“çš„åœ°æ–¹ã€‚æˆ‘ä»¬é€šå¸¸ä¼šå®šä¹‰å·¥å‚ï¼ˆç±»ã€æ¥å£ï¼‰ï¼Œé€šè¿‡è¯¥å·¥å‚ç±»ï¼ˆæˆ–å…¶å·¥å‚å®ä¾‹ï¼‰æä¾›çš„æ–¹æ³•èƒ½å¤Ÿè·å¾—è¿”å›å€¼ï¼Œè¯¥è¿”å›å€¼å°±æ˜¯é€šè¿‡å·¥å‚ç”Ÿäº§çš„å®ä¾‹ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œ<span style='color:yellow;background:red;font-size:æ–‡å­—å¤§å°;font-family:å­—ä½“;'>**å·¥å‚ä¸­ä¸€å®šä¼šæä¾›ä¸€ä¸ªè¿”å›å®ä¾‹çš„æ–¹æ³•ã€‚å…¶ä¸­æ ¸å¿ƒçš„å¥½å¤„æ˜¯å°è£…ï¼ˆéšè—ï¼‰ç”Ÿäº§çš„å…·ä½“ç»†èŠ‚**</span>

<font color='red'>**å·¥å‚ç±»æˆ–æ¥å£çš„å‘½åæ–¹å¼ï¼Œé€šå¸¸ä¸ºXxxFactory**</font>

#### ç®€å•å·¥å‚æ¨¡å¼

ä¹‹æ‰€ä»¥å«ç®€å•å·¥å‚æ˜¯å› ä¸ºçœŸçš„éå¸¸ç®€å•ï¼Œåªè¦ä¸€ä¸ªå·¥å‚ï¼ˆå‡½æ•°ï¼‰å°±å¯ä»¥äº†ï¼Œ**é‚£ä¹ˆåªéœ€è¦ä¼ å…¥ä¸åŒçš„å‚æ•°ï¼Œå°±å¯ä»¥è¿”å›ä¸åŒçš„äº§å“ï¼ˆå®ä¾‹**ï¼‰ï¼Œè¿™ç§æ¨¡å¼å°±å«**ç®€å•å·¥å‚æ¨¡å¼**ã€‚

æ¯”å¦‚ï¼Œæˆ‘ä»¬è¦ç”Ÿäº§Teslaæ±½è½¦ï¼ŒTeslaä¸‹åˆæœ‰ä¸åŒçš„äº§å“ï¼Œæ¯”å¦‚Model3ã€ModelYã€ModelSç­‰ï¼Œæˆ‘ä»¬å…¶å®å¯ä»¥é€šè¿‡ç»™ç®€å•å·¥å‚ä¼ å…¥ä¸åŒçš„å‚æ•°ï¼Œæ¥ç”Ÿäº§ä¸åŒçš„äº§å“

é¦–å…ˆå®šä¹‰ä¸åŒçš„äº§å“

```java
public abstract class Tesla {
    String name;
    public Tesla(String name) {
        this.name = name;
    }
    public void run(){
        System.out.println(name + "åœ¨è·¯ä¸Šè·‘");
    }    
}
public class Model3 extends Tesla{
    public Model3() {
        super("model 3");
    }
}
public class ModelS extends Tesla{
    public ModelS() {
        super("model S");
    }
}
public class ModelY extends Tesla{
    public ModelY() {
        super("model Y");
    }
}
```

æˆ‘ä»¬åœ¨ä¸Šé¢å®šä¹‰äº†æŠ½è±¡ç±»Teslaï¼Œé€šè¿‡ä¸åŒçš„å­ç±»å®šä¹‰ä¸åŒçš„è½¦å‹

æ¥ä¸‹æ¥ï¼Œ**å…ˆä¸ä½¿ç”¨å·¥å‚**

```java
Scanner scanner = new Scanner(System.in);
String keyword = scanner.nextLine();
Tesla tesla = null;
switch (keyword) {
    case "model3":
        tesla = new Model3();
        break;
    case "modely":
        tesla = new ModelY();
        break;
    case "models":
        tesla = new ModelS();
        break;
    default:
        tesla = new Tesla("æœªçŸ¥è½¦è¾†") {
            @Override
            public void run() {
                System.out.println(name + "è·¯ä¸Šè¯·æ³¨æ„ï¼Œé“è·¯åƒä¸‡æ¡ï¼Œå®‰å…¨ç¬¬ä¸€æ¡");
            }
        };
        break;
}
tesla.run();
```

ç„¶åå†**ä½¿ç”¨å·¥å‚**

å°†è·å¾—teslaå¯¹è±¡çš„è¿‡ç¨‹æ”¾å…¥åˆ°å·¥å‚çš„ç”Ÿäº§æ–¹æ³•ä¸­ï¼Œæ•…å®šä¹‰ä¸€ä¸ªè¿™æ ·çš„å·¥å‚

```java
public class SimpleTeslaFactory {
    
    public static Tesla create(String keyword) {
        Tesla tesla = null;
        switch (keyword) {
            case "model3":
                tesla = new Model3();
                break;
            case "modely":
                tesla = new ModelY();
                break;
            case "models":
                tesla = new ModelS();
                break;
            default:
                tesla = new Tesla("æœªçŸ¥è½¦è¾†") {
                    @Override
                    public void run() {
                        System.out.println(name + "è·¯ä¸Šè¯·æ³¨æ„ï¼Œé“è·¯åƒä¸‡æ¡ï¼Œå®‰å…¨ç¬¬ä¸€æ¡");
                    }
                };
                break;
        }
        return tesla;
    }
}
```

å…¶ä¸­çš„createæ–¹æ³•å¯ä»¥å®šä¹‰ä¸º**é™æ€**

æˆ‘ä»¬é€šè¿‡å·¥å‚æä¾›çš„createæ–¹æ³•å¯ä»¥ç›´æ¥è·å¾—teslaå¯¹è±¡

```java
Scanner scanner = new Scanner(System.in);
String keyword = scanner.nextLine();
Tesla tesla = SimpleTeslaFactory.create(keyword);
tesla.run();
```

#### å·¥å‚æ–¹æ³•æ¨¡å¼

![image-20230907085615765](.\assets\image-20230907085615765.png)

å·¥å‚æ–¹æ³•æ¨¡å¼ï¼Œæ˜¯ä¸€ç§åˆ›å»ºå‹è®¾è®¡æ¨¡å¼ï¼Œå…¶åœ¨çˆ¶ç±»ä¸­æä¾›ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æ–¹æ³•ï¼Œå…è®¸å­ç±»å†³å®šå®ä¾‹åŒ–å¯¹è±¡çš„ç±»å‹ã€‚
å®ƒçš„ä¸»è¦æ„å›¾æ˜¯å®šä¹‰ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å…¶å­ç±»è‡ªå·±å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªå·¥å‚ç±»ï¼Œå·¥å‚æ¨¡å¼**ä½¿å…¶åˆ›å»ºè¿‡ç¨‹å»¶è¿Ÿåˆ°å­ç±»è¿›è¡Œ**ã€‚

æˆ‘ä»¬é€šè¿‡æ¨¡æ‹Ÿå®¢æˆ·ä¸‹å•ä¸€è¾†ç‰¹æ–¯æ‹‰ç”µåŠ¨è½¦ï¼Œç‰¹æ–¯æ‹‰ç”Ÿäº§è½¦é—´éœ€è¦äº¤ä»˜ä¸€è¾†è¯¥å‹å·æ±½è½¦æ¥è®²è¿°è¯¥è®¾è®¡æ¨¡å¼ã€‚é¦–å…ˆä¸å€ŸåŠ©äºä»»ä½•è®¾è®¡æ¨¡å¼ï¼Œæˆ‘ä»¬å…ˆå®Œæˆè¯¥åŠŸèƒ½ã€‚

```java
import java.util.Scanner;

public class OrderCar {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        String keyword = scanner.nextLine();
        Tesla tesla = SimpleTeslaFactory.create(keyword);
        tesla.run();
    }
}
```

ä¸Šè¿°çš„æ¡ˆä¾‹ï¼Œæˆ‘ä»¬ä¾¿å®ç°äº†æ ¹æ®è®¢è´­çš„è½¦å‹ä¸åŒï¼Œç”Ÿäº§ä¸åŒçš„è½¦è¾†ã€‚ä½†æ˜¯é¢ä¸´æœ€å¤§çš„é—®é¢˜ä¾¿æ˜¯åœ¨äºæ‰©å±•è½¦å‹æ—¶éå¸¸çš„éº»çƒ¦ã€‚å½“æˆ‘ä»¬éœ€è¦é‡æ„ä»£ç æ—¶ï¼Œä»£ç ä¸­æ¶‰åŠåˆ°çš„åœ°æ–¹åƒä¸ä¸‡ç¼•ã€é”™ç»¼å¤æ‚ä¼šä½¿å¾—å¼€å‘äººå‘˜æœ›è€Œå´æ­¥ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°è¯•ä½¿ç”¨å·¥å‚æ–¹æ³•æ¥é‡æ„ä¸Šè¿°ä»£ç ã€‚

å¯¹åº”çš„ç±»å…³ç³»å¦‚ä¸‹

![image-20230907085639694](.\assets\image-20230907085639694.png)

```java
public interface TeslaFactory {

    public Tesla getTesla();
}
```

```java
public class ModelYFactory implements TeslaFactory{
    @Override
    public Tesla getTesla() {
        return new ModelY();
    }
}
public class Model3Factory implements TeslaFactory{
    @Override
    public Tesla getTesla() {
        return new Model3();
    }
}
//å…¶ä»–å·¥å‚ç±»ä¼¼ï¼Œå°±ä¸å…¨éƒ¨åˆ—ä¸¾äº†
```

```java
public class OrderTesla {

    private static Map<String, TeslaFactory> factoryMap = new HashMap<>();

    static {
        factoryMap.put("modelx", new ModelXFactory());
        factoryMap.put("modely", new ModelYFactory());
        factoryMap.put("models", new ModelSFactory());
        factoryMap.put("model3", new Model3Factory());
    }

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        String keywords = scanner.nextLine();
        TeslaFactory teslaFactory = factoryMap.get(keywords.toLowerCase());
        Tesla tesla = teslaFactory.getTesla();
        tesla.run();
    }
}
```

é€šè¿‡`OrderTesla`ç±»çš„ä»£ç å’Œ`OrderCar`ä»£ç è¿›è¡Œæ¯”è¾ƒï¼Œæˆ‘ä»¬å‘ç°ä»£ç æ˜æ˜¾å˜å¾—æ›´åŠ ç®€æ´äº†ã€‚



#### æŠ½è±¡å·¥å‚æ¨¡å¼

![image-20230907085653958](.\assets\image-20230907085653958.png)

æ˜¯æ‰€æœ‰å·¥å‚æ¨¡å¼ä¸­æŠ½è±¡ç¨‹åº¦æœ€é«˜çš„ä¸€ç§æ¨¡å¼ã€‚æŠ½è±¡å·¥å‚æ¨¡å¼å¯ä»¥å‘å®¢æˆ·ç«¯æä¾›ä¸€ä¸ªæ¥å£ï¼Œä½¿å¾—å®¢æˆ·ç«¯å¯ä»¥åœ¨ä¸å¿…æŒ‡å®šå…·ä½“ç±»å‹çš„æƒ…å†µä¸‹ï¼Œèƒ½å¤Ÿåˆ›å»ºå¤šä¸ªä¸€ç³»åˆ—æˆ–è€…ç›¸å…³è”çš„å¯¹è±¡ã€‚

å·¥å‚æ–¹æ³•å’ŒæŠ½è±¡å·¥å‚ï¼Œé¦–å…ˆéƒ½æ˜¯è¦å°†å·¥å‚æŠ½è±¡ä¸ºæ¥å£æˆ–æŠ½è±¡ç±»ã€‚å·¥å‚æ–¹æ³•ä¸»è¦æ˜¯ç”Ÿäº§çš„æ˜¯å•ä¸ªäº§å“ï¼ŒæŠ½è±¡å·¥å‚ä¸»è¦æ˜¯ç”Ÿäº§æ˜¯ä¸€ç³»åˆ—çš„äº§å“ã€‚

å·¥å‚æ–¹æ³•ï¼šå•å“

æŠ½è±¡å·¥å‚ï¼šäº§å“çŸ©é˜µ

æˆ‘ä»¬ä»¥ä¸‹é¢è¿™ä¸ªæ¡ˆä¾‹æ¥è¿›è¡Œè®²è¿°ã€‚éšç€æ™ºèƒ½å®¶å±…çš„å…´èµ·ï¼Œè®¸å¤šå®¶åº­åœ¨é€‰æ‹©å®¶å±…ç”µå™¨æ—¶ï¼Œä¼šå€¾å‘äºé€‰æ‹©åŒä¸€å‚å®¶çš„äº§å“ã€‚æ¯”å¦‚ç›®å‰å¸‚é¢ä¸Šæœ‰`Haier`ä»¥åŠ`Mi`çš„å®¶å±…äº§å“ã€‚ä¸åŒçš„å‚å®¶äº§å“çº¿éƒ½éå¸¸ä¸°å¯Œï¼Œæ¶µç›–`TV`ã€`Freezer`ç­‰ã€‚è®¾è®¡ä¸€å¥—ä»£ç ç¨‹åºï¼Œæ ¹æ®ç”¨æˆ·é€‰æ‹©çš„å‚å®¶ï¼Œæä¾›å¯¹åº”çš„é…å¥—äº§å“ã€‚

å¯¹åº”çš„ç±»å…³ç³»å¦‚ä¸‹ï¼š

![image-20230907085712058](.\assets\image-20230907085712058.png)

```java
public abstract class AbstractFurnitureFactory {

    public abstract TV createTV();
    public abstract Freezer createFreezer();
}
```

```java
public class MiFurnitureFactory extends AbstractFurnitureFactory{
    @Override
    public TV createTV() {
        return new MiTV();
    }

    @Override
    public Freezer createFreezer() {
        return new MiFreezer();
    }
}
```

```java
public class HaierFurnitureFactory extends AbstractFurnitureFactory{
    @Override
    public TV createTV() {
        return new HaierTV();
    }

    @Override
    public Freezer createFreezer() {
        return new HaierFreezer();
    }
}
```

```java
public class OrderFurniture {
    public static void main(String[] args) {
        MiFurnitureFactory miFactory = new MiFurnitureFactory();
        TV tv = miFactory.createTV();
        Freezer freezer = miFactory.createFreezer();
        System.out.println("tv instanceof MiTV = " + (tv instanceof MiTV));
        System.out.println("freezer instanceof MiFreezer = " + (freezer instanceof MiFreezer));
    }
}
```

### å»ºé€ è€…æ¨¡å¼ï¼ˆBuilderï¼‰

![image-20230907085740047](.\assets\image-20230907085740047.png)

å»ºé€ è€…æ¨¡å¼ä¹Ÿå«ä½œç”Ÿæˆå™¨æ¨¡å¼ï¼Œå°±æ˜¯åˆ†æ­¥éª¤åˆ›å»ºå¤æ‚å¯¹è±¡ï¼Œè¯¥æ¨¡å¼å…è®¸ä½¿ç”¨ç›¸åŒçš„åˆ›å»ºä»£ç ç”Ÿæˆä¸åŒç±»å‹å’Œå½¢å¼çš„å¯¹è±¡ã€‚

> 1. Lombokçš„`@Builder`ä¼šåˆ›å»ºä¸€ä¸ª`XxxBuilder`çš„å†…éƒ¨ç±»,ä½¿ç”¨Lombokçš„æ—¶å€™ä¼šè‡ªåŠ¨ç”Ÿæˆå…¨å‚æ„é€ ,è¿™æ—¶å°±ä¼šè¦†ç›–æ‰é»˜è®¤çš„æ— å‚æ„é€ ,æ‰€ä»¥ä¸ºäº†é˜²æ­¢å…¶ä»–æ–¹æ³•ä¸­é€šè¿‡åå°„è°ƒç”¨æ— å‚æ„é€ æŠ¥é”™,éœ€è¦åŒæ—¶åŠ æ— å‚æ„é€ çš„æ³¨è§£å’Œå…¨å‚æ„é€ æ³¨è§£
> 2. `StringBuffer`ä¹Ÿæ˜¯å»ºé€ è€…æ¨¡å¼,æ–¹æ³•`append()`è¿”å›å€¼ä»æ˜¯ä¸€ä¸ª`StringBuffer`

åœ¨å¼€å‘ä¸­ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åˆ›å»ºå‡ºä¸€ä¸ªå¾ˆå¤æ‚çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„åˆ›å»ºæœ‰ä¸€ä¸ªå›ºå®šçš„æ­¥éª¤ï¼Œå¹¶ä¸”æ¯ä¸ªæ­¥éª¤ä¸­ä¼šæ¶‰åŠåˆ°å¤šä¸ªç»„ä»¶å¯¹è±¡ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥è€ƒè™‘ä½¿ç”¨å»ºé€ è€…æ¨¡å¼ã€‚ä½¿ç”¨å»ºé€ è€…æ¨¡å¼å°†åŸæœ¬å¤æ‚çš„å¯¹è±¡åˆ›å»ºè¿‡ç¨‹æŒ‰ç…§è§„å¾‹å°†å…¶åˆ†è§£æˆå¤šä¸ªå°æ­¥éª¤ï¼Œè¿™æ ·åœ¨æ„å»ºå¯¹è±¡æ—¶å¯ä»¥çµæ´»çš„é€‰æ‹©æˆ–ä¿®æ”¹æ­¥éª¤ã€‚å»ºé€ è€…æ¨¡å¼å°†å¯¹è±¡çš„åˆ›å»ºå’Œè¡¨ç¤ºè¿‡ç¨‹è¿›è¡Œåˆ†ç¦»ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŒæ ·çš„è¿‡ç¨‹ï¼Œåªéœ€ä¿®æ”¹è¿™ä¸ªè¿‡ç¨‹ä¸­çš„å°æ­¥éª¤ï¼Œä¾¿èƒ½å¤Ÿæ„å»ºå‡ºä¸åŒçš„å¯¹è±¡ã€‚è€Œå¯¹äºè°ƒç”¨æ–¹æ¥è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦ä¼ å…¥éœ€è¦æ„å»ºçš„ç±»å‹ï¼Œä¾¿èƒ½å¤Ÿå¾—åˆ°éœ€è¦çš„å¯¹è±¡ï¼Œå¹¶ä¸éœ€è¦å…³ç³»åˆ›å»ºçš„è¿‡ç¨‹ï¼Œä»è€Œå®ç°è§£è€¦ã€‚

æ¯”å¦‚æˆ‘ä»¬è¦åˆ¶é€ æ‰‹æœºï¼Œæ‰‹æœºé‡ŒåŒ…å«å±å¹•ã€é¢œè‰²ã€ç”µæ± ã€æ‘„åƒå¤´ã€ç³»ç»Ÿç­‰ç»„æˆï¼Œé‚£ä¹ˆæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªPhoneå¦‚ä¸‹

```java
@Data
public class Phone {
    private String battery;
    private String screen;
    private String os;
    private String camera;
    private String color;
    // é€šè¿‡@Dataæä¾›äº†getter/setteræ–¹æ³•ï¼Œä»¥åŠæˆ‘ä»¬æ‰“å°çš„æ—¶å€™ç”¨çš„toStringæ–¹æ³•
}
```

ç„¶åæˆ‘ä»¬è¦æä¾›ä¸€ä¸ªPhoneBuilderç±»

> 1. é€šè¿‡Builderç±»æä¾›çš„buildæ–¹æ³•èƒ½å¤Ÿè·å¾—Phoneå®ä¾‹
> 2. åŒæ—¶æä¾›ä¸€äº›æ–¹æ³•ï¼Œé€šè¿‡è¿™äº›æ–¹æ³•èƒ½å¤Ÿè®¾ç½®buildæ–¹æ³•è·å¾—çš„è¯¥phoneå®ä¾‹çš„å±æ€§å€¼
> 3. è¦ä¿è¯è¿™äº›æ–¹æ³•æ“ä½œçš„æ˜¯åŒä¸€ä¸ªphoneå®ä¾‹ï¼Œè¦åœ¨Builderä¸­æä¾›phoneæˆå‘˜å˜é‡

åŸºäºä»¥ä¸Šï¼Œæˆ‘ä»¬å®šä¹‰çš„PhoneBuilderå¦‚ä¸‹

```java
public class PhoneBuilder {
    private Phone phone = new Phone();

    public PhoneBuilder color(String color) {
        this.phone.setColor(color);
        return this;
    }

    public PhoneBuilder battery(String battery) {
        this.phone.setBattery(battery);
        return this;
    }

    public PhoneBuilder screen(String screen) {
        this.phone.setScreen(screen);
        return this;
    }

    public PhoneBuilder os(String os) {
        this.phone.setOs(os);
        return this;
    }

    public PhoneBuilder camera(String camera) {
        this.phone.setCamera(camera);
        return this;
    }

    public Phone build() {
        return this.phone;
    }
}
```

ä½¿ç”¨å¦‚ä¸‹

```java
public class UseBuilder {
    public static void main(String[] args) {
        PhoneBuilder builder = new PhoneBuilder();
        Phone phone = builder.battery("4000æ¯«å®‰å¤§å®¹é‡")
                .camera("å¾•å¡é¡¶çº§é•œå¤´")
                .color("å°Šè´µé»‘")
                .screen("2Ké«˜æ¸…åˆ†è¾¨ç‡")
                .os("Android")
                .build();
        System.out.println("phone = " + phone);
    }
}
```

ä¸Šè¿°ä»£ç æ˜¯å»ºé€ è€…æ¨¡å¼æœ€ç»å…¸çš„ä½¿ç”¨æ–¹å¼ã€‚

å»ºé€ è€…æ¨¡å¼çš„ä¼˜ç‚¹å¦‚ä¸‹ï¼š

- å¯ä»¥æ„é€ å‡ºå¤æ‚çš„å¯¹è±¡ã€‚è¿™ä¸ªæ¨¡å¼é€‚ç”¨äºï¼šæŸä¸ªå¯¹è±¡çš„æ„å»ºè¿‡ç¨‹å¤æ‚çš„æƒ…å†µã€‚
- **ä¸åŒçš„æ„å»ºå™¨ï¼Œç›¸åŒçš„è£…é…ï¼Œä¹Ÿå¯ä»¥åšå‡ºä¸åŒçš„å¯¹è±¡**ï¼Œå®ç°äº†æ›´å¥½çš„å¤ç”¨ã€‚
- å»ºé€ è€…æ¨¡å¼å¯ä»¥å°†éƒ¨ä»¶å’Œå…¶ç»„è£…è¿‡ç¨‹åˆ†å¼€ï¼Œä¸€æ­¥ä¸€æ­¥åˆ›å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ã€‚ç”¨æˆ·åªéœ€è¦æŒ‡å®šå¤æ‚å¯¹è±¡çš„ç±»å‹å°±å¯ä»¥å¾—åˆ°è¯¥å¯¹è±¡ï¼Œè€Œæ— é¡»çŸ¥é“å…¶å†…éƒ¨çš„å…·ä½“æ„é€ ç»†èŠ‚ã€‚

é‡‡ç”¨é“¾å¼è°ƒç”¨ï¼Œä¸€æ­¥ä¸€æ­¥æŠŠä¸€ä¸ªå®Œæ•´çš„å¯¹è±¡æ„å»ºå‡ºæ¥ã€‚ä½¿ç”¨è¯¥æ¨¡å¼æ˜¯ä¸€æ¬¡æ€§å°†ä¸€ä¸ªå®Œæ•´çš„å¯¹è±¡æ„å»ºå‡ºæ¥ï¼Œæ›´åŠ çš„ç´§å‡‘ï¼ŒåŒæ—¶ä¹Ÿé¿å…äº†å¯¹è±¡åœ¨å…¶ä»–å¤„è°ƒç”¨äº†setæ–¹æ³•å¯¼è‡´å±æ€§èµ‹å€¼é”™è¯¯ã€‚



å»ºé€ è€…è®¾è®¡æ¨¡å¼å’Œå·¥å‚è®¾è®¡æ¨¡å¼éƒ½æ˜¯ä¸ºäº†åˆ›å»ºå…·ä½“çš„å®ä¾‹ï¼šå·¥å‚æ¨¡å¼æ›´å…³æ³¨é€šè¿‡ä»€ä¹ˆå·¥å‚ç”Ÿäº§ä»€ä¹ˆå®ä¾‹ï¼Œå»ºé€ è€…æ¨¡å¼ä¸»è¦æ˜¯é€šè¿‡ç»„è£…é›¶é…ä»¶è€Œäº§ç”Ÿä¸€ä¸ªæ–°äº§å“

## ç»“æ„å‹æ¨¡å¼

### âš¡ğŸŸ ä»£ç†

> éœ€è¦å¢åŠ é¢å¤–çš„å†…å®¹,æŠŠé¢å¤–å†…å®¹æ”¾åœ¨ä»£ç†é‡Œ.æ¯”å¦‚"å¼€å¯äº‹åŠ¡" "æäº¤äº‹åŠ¡" "æ“ä½œæ—¥å¿—"

![image-20230907085827998](.\assets\image-20230907085827998.png)

ä»£ç†æ˜¯ä¸€ç§ç»“æ„å‹è®¾è®¡æ¨¡å¼ï¼Œå¯ä»¥å…è®¸æˆ‘ä»¬ç”Ÿæˆå¯¹è±¡çš„æ›¿ä»£å“ã€‚ä»£ç†æ§åˆ¶ç€å¯¹äºåŸå¯¹è±¡çš„è®¿é—®ï¼ŒåŒæ—¶ä¹Ÿå…è®¸åœ¨åŸå¯¹è±¡çš„æ–¹æ³•ä¹‹å‰ååšä¸€äº›å¤„ç†ï¼Œä¾¿å¯ä»¥å®ç°åœ¨åŸæ–¹æ³•æ‰§è¡Œå‰åéƒ½ä¼šæ‰§è¡ŒæŸæ®µä»£ç é€»è¾‘çš„åŠŸèƒ½ã€‚è¿™ä¸ªä¹Ÿæ˜¯**é¢å‘åˆ‡é¢ç¼–ç¨‹**çš„æŒ‡å¯¼æ€æƒ³ã€‚
ä»£ç†æ¨¡å¼åœ¨æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­ç”¨å¤„è¿˜æ˜¯ç›¸å½“å¹¿æ³›çš„ï¼Œæ¯”å¦‚**æµ·å¤–è´­ç½‘ç«™**å°±æ˜¯ä¸€ä¸ªä»£ç†ã€‚æµ·å¤–è´­ç½‘ç«™è´Ÿè´£ä»£ç†ç”¨æˆ·åˆ°å›½å¤–çš„ç”µå•†ç½‘ç«™å»ä¸‹å•è´­ä¹°å•†å“ï¼Œä¹Ÿå¯ä»¥åœ¨å•†å“é€è¾¾åˆ°æµ·å¤–è´­ç½‘ç«™æ—¶ï¼Œå†æ‰§è¡Œè¿›ä¸€æ­¥åŠ å›ºæ“ä½œï¼Œå†æ¬¡è½¬é€ç»™ç”¨æˆ·ã€‚
ä»£ç†æ¨¡å¼åœ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­çš„åº”ç”¨åœºæ™¯ä¹Ÿéå¸¸å¸¸è§ã€‚åœ¨å®¢æˆ·ç«¯ä»¥åŠå®¢æˆ·ç«¯è®¿é—®çš„ç›®æ ‡ç±»å¯¹è±¡ä¸­é—´ï¼Œé¢å¤–å†å¼•å…¥ä¸€ä¸ªç¬¬ä¸‰æ–¹ä»£ç†ç±»å¯¹è±¡ã€‚å¦‚æœç›´æ¥è®¿é—®ç›®æ ‡ç±»å¯¹è±¡ï¼Œå°±æ˜¯æ‰§è¡Œå¯¹åº”çš„æ–¹æ³•ï¼›å¦‚æœå®¢æˆ·ç«¯è®¿é—®çš„æ˜¯ä»£ç†ç±»å¯¹è±¡ï¼Œé‚£ä¹ˆä¸ä»…å¯ä»¥è®¿é—®å¯¹åº”çš„æ–¹æ³•ï¼Œè¿˜ä¼šåœ¨æ–¹æ³•çš„æ‰§è¡Œå‰åæ‰§è¡Œå¯¹åº”çš„**å‰ç½®ã€åç½®é€šçŸ¥**ã€‚

![image-20230907085851936](.\assets\image-20230907085851936.png)

#### é™æ€ä»£ç†

```java
public interface UserService {
    void insert();
}
```

```java
public class UserServiceImpl implements UserService {
    @Override
    public void insert() {
        System.out.println("ç›®æ ‡ç±»æ‰§è¡Œäº†insertæ–¹æ³•");
    }
}
```

```java
public class UserServiceProxy implements UserService {

    UserService target;

    public UserServiceProxy(UserService target) {
        //æ³¨å…¥å§”æ‰˜ç±»å¯¹è±¡
        this.target = target;
    }

    @Override
    public void insert() {
        System.out.println("ä»£ç†ä¹‹å‰æ‰“å°ä¸€ä¸ªæ—¥å¿—");
        target.insert();
        System.out.println("ä»£ç†ä¹‹åæ‰“å°ä¸€ä¸ªæ—¥å¿—");
    }
}
```

```java
@Test
    public void test1(){
        UserServiceProxy proxy = new UserServiceProxy(new UserServiceImpl());
        proxy.insert();
    }
```

æ³¨æ„å›é¡¾é™æ€ä»£ç†çš„ä¼˜åŒ–è¿‡ç¨‹

![Day12-ä»£ç†æ¢³ç†](.\assets\Day12-ä»£ç†æ¢³ç†.jpg)

ä»£ç†æ¨¡å¼æœ€å¤§çš„ä¼˜ç‚¹åœ¨äºå¯ä»¥ä¸æ›´æ”¹ç›®æ ‡ç±»ä»£ç çš„å‰æä¸‹ï¼Œæ‰©å±•ç›®æ ‡ç±»ä»£ç çš„åŠŸèƒ½ã€‚

é™æ€ä»£ç†æœ€å¤§çš„ç¼ºç‚¹åœ¨äºä»£ç è¾ƒä¸ºå†—ä½™ï¼Œæ¯ä»£ç†ä¸€ä¸ªç±»ï¼Œä¾¿è¦æ‰‹åŠ¨ç¼–å†™ä¸€ä¸ªä»£ç†ç±»ï¼›ä»£ç†å¯¹è±¡å’Œç›®æ ‡ç±»å¯¹è±¡å‡å®ç°äº†æ¥å£ï¼Œå¦‚æœæ¥å£å‘ç”Ÿäº†ä¿®æ”¹ï¼Œä¸ä»…ç›®æ ‡ç±»éœ€è¦æ›´æ”¹ï¼Œä»£ç†ç±»ä¹Ÿéœ€è¦åŒæ­¥å‘ç”Ÿä¿®æ”¹ï¼Œç»´æŠ¤æˆæœ¬å˜é«˜äº†å¾ˆå¤šã€‚



#### JDKåŠ¨æ€ä»£ç†

![image-20230908093348453](.\assets\image-20230908093348453.png)

ä»£ç†ç±»å®ç°å’Œå§”æ‰˜ç±»ç›¸åŒçš„æ¥å£ã€‚
å§”æ‰˜ç±»å’Œä»£ç†ç±»æ˜¯å…„å¼Ÿå…³ç³»ã€‚ä½¿ç”¨ç›¸åŒçš„æ¥å£æ¥æ¥æ”¶ã€‚

> é™æ€ä»£ç†ï¼Œé¡¾åæ€ä¹‰ï¼Œä¾¿æ˜¯åœ¨ç¼–è¯‘æ—¶ï¼Œå°±å·²ç»å®é™…å­˜åœ¨äº†è¯¥`class`æ–‡ä»¶ï¼›è€ŒåŠ¨æ€ä»£ç†ï¼Œåœ¨ç¼–è¯‘æ—¶æœŸï¼Œå®é™…ä¸Šå¹¶ä¸å­˜åœ¨è¯¥`class`æ–‡ä»¶ï¼Œè€Œæ˜¯ç¨‹åºåœ¨è¿è¡Œé˜¶æ®µåŠ¨æ€ç”Ÿæˆäº†å­—èŠ‚ç ã€‚
> `JDK`åŠ¨æ€ä»£ç†ï¼Œå³`JDK`ç»™æˆ‘ä»¬æä¾›çš„åŠ¨æ€ç”Ÿæˆä»£ç†ç±»çš„æ–¹å¼ï¼Œæ— éœ€å¼•å…¥ç¬¬ä¸‰æ–¹`jar`åŒ…ã€‚ä½†æ˜¯ä½¿ç”¨`JDK`åŠ¨æ€ä»£ç†æœ‰ä¸€ä¸ª**å…ˆå†³æ¡ä»¶**ï¼Œé‚£å°±æ˜¯ç›®æ ‡ç±»å¯¹è±¡å¿…é¡»å®ç°äº†æŸä¸ªæ¥å£ï¼›å¦‚æœç›®æ ‡ç±»å¯¹è±¡æ²¡æœ‰å®ç°ä»»ä½•æ¥å£ï¼Œåˆ™`JDK`åŠ¨æ€ä»£ç†æ— æ³•ä½¿ç”¨ã€‚

å¦‚æœä½¿ç”¨`JDK`æä¾›çš„åŠ¨æ€ä»£ç†ï¼Œé‚£ä¹ˆéœ€è¦å€ŸåŠ©å¦‚ä¸‹å‡ ä¸ªç±»

- `java.lang.reflect.Proxy`

  | API                                                          | å‚æ•°                                                         | è¿”å›å€¼                                                       |
  | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
  | public `static`  Object `newProxyInstance`(ClassLoader loader, Class<?>[] interfaces, InvocationHandler h) | `loader`è¡¨ç¤ºç›®æ ‡ç±»ä½¿ç”¨çš„ç±»åŠ è½½å™¨ï¼›`interfaces`è¡¨ç¤ºç›®æ ‡ç±»æ‰€å®ç°çš„æ¥å£ç±»å‹ï¼›`h`è¡¨ç¤ºå¤„ç†å™¨ï¼Œç”¨æ¥è§„å®šä»£ç†çš„å†…éƒ¨ç»†èŠ‚ | è¿”å›ä¸€ä¸ªå®ç°æŒ‡å®šæ¥å£çš„ä»£ç†ç±»å®ä¾‹å¯¹è±¡ï¼›ä»£ç†ç±»å¯¹è±¡å’Œç›®æ ‡ç±»å¯¹è±¡å®ç°ç›¸åŒçš„æ¥å£ç±»å‹ |

- `java.lang.reflect.InvocationHandler`

  | API                                                          | å‚æ•°                                                         | è¿”å›å€¼                             |
  | ------------------------------------------------------------ | ------------------------------------------------------------ | ---------------------------------- |
  | public Object invoke(Object proxy, Method method, Object[] args) | `proxy`è¡¨ç¤ºJDKå¸®åŠ©å¼€å‘è€…ç”Ÿæˆçš„ä»£ç†ç±»å¯¹è±¡ï¼Œè¿™ä¸ªå‚æ•°ä¸€èˆ¬ä¸ç”¨ç†ä¼šï¼›`method`è¡¨ç¤ºçš„æ˜¯ç›®æ ‡ç±»ä¸­çš„æ–¹æ³•ï¼›`args`è¡¨ç¤ºæ‰§è¡Œç›®æ ‡ç±»æ–¹æ³•æ—¶ä¼ é€’çš„å‚æ•°ï¼›ä¸‰ä¸ªå‚æ•°åˆåœ¨ä¸€èµ·è¡¨ç¤ºçš„å«ä¹‰è¡¨ç¤ºä»£ç†ç±»å¦‚ä½•æ¥ä»£ç†ã€å¢å¼ºç›®æ ‡ç±»é‡Œé¢çš„æ–¹æ³• | ä»£ç†ç±»æ‰§è¡Œå®Œå¯¹åº”çš„æ–¹æ³•æ—¶å®ƒçš„è¿”å›å€¼ |

```java
public class ProxyFactory {

    Object target;

    public ProxyFactory(Object target) {
        this.target = target;
    }

    public Object newProxyInstance(){
        return Proxy.newProxyInstance(target.getClass().getClassLoader(),
                target.getClass().getInterfaces(),
                new InvocationHandler() {
                    
                    //ä»£ç†ç±»å¦‚ä½•ä»£ç†
                    @Override
                    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
                        System.out.println("ä»£ç†ä¹‹å‰ç­¾è®¢åˆçº¦");
                        Object invoke = method.invoke(target, args);
                        System.out.println("ä»£ç†å®Œæ¯•è½¬è´¦ç¡®è®¤");
                        return invoke;
                    }
                });
    }
}
```

```java
@Test
    public void test2(){
        UserService userService = new UserServiceImpl();
        //å¯¹å“ªä¸ªç›®æ ‡ç±»è¿›è¡Œä»£ç†ï¼Œæˆ‘ä»¬å¯¹UserServiceImplè¿›è¡Œä»£ç†
        //ç”Ÿæˆä»£ç†ç±»å¯¹è±¡
        UserService userServiceProxy = Proxy.newProxyInstance(target.getClass().getClassLoader(),
                target.getClass().getInterfaces(),
                new InvocationHandler() {
                    
                    //ä»£ç†ç±»å¦‚ä½•ä»£ç†
                    @Override
                    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
                        System.out.println("ä»£ç†ä¹‹å‰ç­¾è®¢åˆçº¦");
                        Object invoke = method.invoke(userService, args);
                        System.out.println("ä»£ç†å®Œæ¯•è½¬è´¦ç¡®è®¤");
                        return invoke;
                    }
                });
        //ä»£ç†ç±»å¯¹è±¡æ‰§è¡Œinsertæ–¹æ³•ï¼Œä»€ä¹ˆé€»è¾‘å‘¢ï¼Ÿä¸»è¦æ˜¯invokeé‡Œé¢çš„ä»£ç é€»è¾‘
        userServiceProxy.insert();
    }
```



åˆ©ç”¨çº¿ä¸Šç›‘æµ‹å·¥å…·ä»¥åŠåç¼–è¯‘å·¥å…·ï¼Œå¯ä»¥çœ‹åˆ°ç”Ÿæˆçš„ä»£ç†ç±»å¯¹è±¡æºç 

```java
public final class $Proxy0
extends Proxy
implements UserService {
    private static Method m1;
    private static Method m3;
    private static Method m2;
    private static Method m0;

    public $Proxy0(InvocationHandler invocationHandler) {
        super(invocationHandler);
    }

    static {
        try {
            m1 = Class.forName("java.lang.Object").getMethod("equals", Class.forName("java.lang.Object"));
            m3 = Class.forName("com.cskaoyan.pattern.proxy.UserService").getMethod("insert", new Class[0]);
            m2 = Class.forName("java.lang.Object").getMethod("toString", new Class[0]);
            m0 = Class.forName("java.lang.Object").getMethod("hashCode", new Class[0]);
            return;
        }
        catch (NoSuchMethodException noSuchMethodException) {
            throw new NoSuchMethodError(noSuchMethodException.getMessage());
        }
        catch (ClassNotFoundException classNotFoundException) {
            throw new NoClassDefFoundError(classNotFoundException.getMessage());
        }
    }

    public final boolean equals(Object object) {
        try {
            return (Boolean)this.h.invoke(this, m1, new Object[]{object});
        }
        catch (Error | RuntimeException throwable) {
            throw throwable;
        }
        catch (Throwable throwable) {
            throw new UndeclaredThrowableException(throwable);
        }
    }

    public final String toString() {
        try {
            return (String)this.h.invoke(this, m2, null);
        }
        catch (Error | RuntimeException throwable) {
            throw throwable;
        }
        catch (Throwable throwable) {
            throw new UndeclaredThrowableException(throwable);
        }
    }

    public final int hashCode() {
        try {
            return (Integer)this.h.invoke(this, m0, null);
        }
        catch (Error | RuntimeException throwable) {
            throw throwable;
        }
        catch (Throwable throwable) {
            throw new UndeclaredThrowableException(throwable);
        }
    }
	//ä¸»è¦å…³æ³¨insertæ–¹æ³•
    public final void insert() {
        try {
            this.h.invoke(this, m3, null);
            return;
        }
        catch (Error | RuntimeException throwable) {
            throw throwable;
        }
        catch (Throwable throwable) {
            throw new UndeclaredThrowableException(throwable);
        }
    }
}
```

#### CGlibåŠ¨æ€ä»£ç†

å§”æ‰˜ç±»æ˜¯ä»£ç†ç±»çš„çˆ¶ç±»ï¼Œä¹Ÿå¯ä»¥è®©ä»£ç†ç±»å’Œå§”æ‰˜ç±»çš„â€œå¤–è§‚ä¸€è‡´â€ã€‚

![image-20230908093640850](.\assets\image-20230908093640850.png)

`Cglib`(`Code Generation Library`)æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œæ˜¯ä¸€ä¸ªå¼ºå¤§çš„ï¼Œé«˜æ€§èƒ½ï¼Œé«˜è´¨é‡çš„`Code`ç”Ÿæˆç±»åº“ï¼Œå®ƒå¯ä»¥åœ¨**è¿è¡ŒæœŸ**æ‰©å±•`Java`ç±»ä¸å®ç°`Java`æ¥å£ã€‚æˆ‘ä»¬å¯ä»¥å€ŸåŠ©äº`Cglib`æ¥å¸®åŠ©æˆ‘ä»¬åŠ¨æ€åœ°ç”Ÿæˆä»£ç†ç±»å¯¹è±¡ã€‚`Cglib`å¯ä»¥å¼¥è¡¥`JDK`åŠ¨æ€ä»£ç†çš„ä¸è¶³ï¼Œ`JDK`è¦æ±‚ç›®æ ‡ç±»å¿…é¡»å®ç°äº†æŸä¸ªæ¥å£ï¼Œæ‰å¯ä»¥æ‰§è¡Œä»£ç†åŠŸèƒ½ï¼›è€Œ`Cglib`å¯¹æ­¤æ— ä»»ä½•è¦æ±‚ï¼Œ**ä¸»è¦åŸå› åœ¨äº`Cglib`æ‰©å±•çš„ä»£ç†ç±»ä¼šç»§æ‰¿è‡ªç›®æ ‡ç±»**ã€‚**æ‰€ä»¥è¿™ä¹Ÿè¦æ±‚æˆ‘ä»¬çš„ç›®æ ‡ç±»ä¸èƒ½æ˜¯`final`ä¿®é¥°**ã€‚

ä½¿ç”¨`Cglib`æ¶‰åŠåˆ°çš„ç›¸å…³ç±»å¦‚ä¸‹

- `net.sf.cglib.proxy.Enhancer`

  | API                                  | å‚æ•°                                                         | è¿”å›å€¼/è¯´æ˜                                                  |
  | ------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
  | enhancer.`setSuperclass(superClass)` | çˆ¶ç±»çš„å­—èŠ‚ç å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ç›®æ ‡ç±»                         | æ— è¿”å›å€¼;Cglibäº§ç”Ÿçš„ä»£ç†ç±»ä¼šç»§æ‰¿ç›®æ ‡ç±»ï¼Œæ‰€ä»¥æ­¤å¤„è®¾ç½®çš„çˆ¶ç±»ä¹Ÿå°±æ˜¯ç›®æ ‡ç±» |
  | enhancer.`setCallBack(callback)`     | è®¾ç½®ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œä»£ç†ç±»å¯¹è±¡å¦‚ä½•ä»£ç†ç›®æ ‡å¯¹è±¡éœ€è¦åœ¨å›è°ƒå‡½æ•°ä¸­åˆ¶å®šç­–ç•¥ | CallBackæ˜¯ä¸€ä¸ªæ¥å£ï¼ŒMethodInterceptoræ˜¯ä¸€ä¸ªå­æ¥å£ã€‚æˆ‘ä»¬é€‰ç”¨è¯¥ç±»æ¥è®¾ç½®å›è°ƒç­–ç•¥ |
  | enhancer.`create()`                  | -                                                            | ç”Ÿæˆä»£ç†ç±»å¯¹è±¡                                               |

- `net.sf.cglib.proxy.MethodInterceptor`

  | API                                                          | å‚æ•°                                                         | è¿”å›å€¼/è¯´æ˜                                    |
  | ------------------------------------------------------------ | ------------------------------------------------------------ | ---------------------------------------------- |
  | public Object intercept(Object obj, Method method, Object[] args, MethodProxy proxy) | ç¬¬ä¸€ä¸ªå‚æ•°objä¸ºä»£ç†ç±»å¯¹è±¡ï¼›ç¬¬äºŒä¸ªå‚æ•°ä¸ºç›®æ ‡ç±»å¯¹åº”ä¸­å¯¹åº”çš„æ–¹æ³•ï¼›ç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºç›®æ ‡ç±»å¯¹è±¡ä¸­å¯¹åº”çš„æ–¹æ³•æ‰§è¡Œæ—¶ä¼ é€’çš„å‚æ•°ï¼›ç¬¬å››ä¸ªå‚æ•°æ˜¯ä»£ç†ç±»å¯¹è±¡ä¸­çš„å¯¹åº”æ–¹æ³• | è¿”å›å€¼ä¸€èˆ¬ä¾¿å°†ä»£ç†ç±»å¯¹è±¡å¯¹åº”æ–¹æ³•çš„æ‰§è¡Œç»“æœè¿”å› |



ä½¿ç”¨Cglibéœ€è¦å¯¼åŒ…

```xml
<dependency>
    <groupId>cglib</groupId>
    <artifactId>cglib</artifactId>
    <version>3.3.0</version>
</dependency>
```

åˆ›å»ºä¸€ä¸ªç›®æ ‡ç±»ï¼Œåœ¨è¿™é‡Œä¸ºäº†ä½“ç°Cglibçš„æ•ˆæœï¼Œç›®æ ‡ç±»æ²¡æœ‰å®ç°ä»»ä½•æ¥å£

```java
public class UserServiceImpl {

    public String getName(){
        System.out.println("ç›®æ ‡æ–¹æ³•æ‰§è¡Œ");
        return "zhangsan";
    }
}
```

ç¼–å†™æµ‹è¯•ä»£ç 

```java
public class ProxyTest {

    public static void main(String[] args) {
        UserServiceImpl userService = new UserServiceImpl();

        UserServiceImpl userServiceProxy = Enhancer.create(UserServiceImpl.class,new InvocationHandler() {

            //ä»£ç†ç±»å¦‚ä½•ä»£ç†
            @Override
            public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
                System.out.println("ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹å‰");
                Object invoke = method.invoke(userService, args);
                System.out.println("ç›®æ ‡æ–¹æ³•æ‰§è¡Œä¹‹å");
                return invoke;
            }
        });
        String name = userServiceProxy.getName();
        System.out.println(name);
    }
}
```

åŠ¨æ€ä»£ç†å’Œæ³¨è§£ç»“åˆã€‚

## è¡Œä¸ºå‹æ¨¡å¼

### è´£ä»»é“¾(Respnsibility Chain)

![image-20230907085940494](.\assets\image-20230907085940494.png)

è´£ä»»é“¾æ˜¯ä¸€ç§è¡Œä¸ºè®¾è®¡æ¨¡å¼ï¼Œå…è®¸è¯·æ±‚æ²¿ç€é“¾è¿›è¡Œå‘é€ã€‚æ”¶åˆ°è¯·æ±‚åï¼Œæ¯ä¸ªå¤„ç†è€…å‡å¯å¯¹è¯·æ±‚è¿›è¡Œå¤„ç†æˆ–è€…å°†å…¶ä¼ é€’ç»™é“¾ä¸Šçš„ä¸‹ä¸€ä¸ªå¤„ç†è€…ã€‚

å¯¹åº”çš„ç±»å…³ç³»å¦‚ä¸‹

![image-20230907085957403](.\assets\image-20230907085957403.png)

æˆ‘ä»¬å…ˆä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæä¾›ä¸‰ä¸ªå¤„ç†å™¨ï¼Œå¹¶å¤„ç†å¥½å…¶å…ˆåå…³ç³»ï¼Œç„¶ååˆ†åˆ«ä¾æ¬¡å¤„ç†ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦åšçš„äº‹æƒ…æ‹†è§£å¦‚ä¸‹

> 1. å®šä¹‰ä¸‰ä¸ªä¸åŒçš„å¤„ç†å™¨
> 2. è¿™ä¸‰ä¸ªå¤„ç†å™¨åšçš„æ˜¯ç±»ä¼¼çš„äº‹æƒ…ï¼Œé‚£ä¹ˆå¯ä»¥æŠ½è±¡ä¸€ä¸ªæ¥å£æˆ–æŠ½è±¡ç±»ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å…³äºæŠ½è±¡ç±»ä¸­çš„æ–¹æ³•
> 3. è¦å¤„ç†å…ˆåå…³ç³»ï¼Œå¯ä»¥æä¾›ä¸€ä¸ªæ–¹æ³•æ¥å¤„ç†å¤„ç†å™¨çš„é¡ºåºå…³ç³»
> 4. è¦åšå¤„ç†å™¨çš„æ ¸å¿ƒæ–¹æ³•å®Œæˆä¸šåŠ¡çš„å¤„ç†ï¼Œæ¯ä¸ªå¤„ç†å™¨çš„å¤„ç†æ–¹æ³•çš„ä¸šåŠ¡ä¸åŒ

å°†ä¸€äº›å…±æ€§çš„éƒ¨åˆ†æ”¾ç½®åœ¨ä¸€ä¸ªåŸºç±»ä¸­ï¼Œå…¶ä¸­æä¾›çš„æˆå‘˜å˜é‡nextèƒ½å¤Ÿç»´æŠ¤é¡ºåºå…³ç³»ï¼Œé€šè¿‡è°ƒç”¨å…¶æä¾›çš„setNextæ–¹æ³•å®Œæˆé¡ºåºå…³ç³»çš„ç»´æŠ¤ï¼Œhandleæ–¹æ³•èƒ½å¤Ÿæä¾›ä¸åŒçš„

```java
public abstract class AbstractHandler {
    AbstractHandler next;
    public void setNext(AbstractHandler next){
        System.out.println("å·²ç»è®¾ç½®" + this.getClass().getSimpleName() + "çš„ä¸‹ä¸€çº§ä¸º" + next.getClass().getSimpleName());
        this.next = next;
    }
    public abstract void handle();
}
```

ä¸‰ä¸ªå¤„ç†å™¨

```java
public class Level1Handler extends AbstractHandler{
    @Override
    public void handle() {
        System.out.println("ä¸€çº§å¤„ç†å™¨æ­£åœ¨å¤„ç†");
        if (next != null) {
            next.handle();
        }
    }
}
```

```java
public class Level2Handler extends AbstractHandler{
    @Override
    public void handle() {
        System.out.println("äºŒçº§å¤„ç†å™¨æ­£åœ¨å¤„ç†");
        if (next != null) {
            next.handle();
        }
    }
}
```

```java
public class Level3Handler extends AbstractHandler{
    @Override
    public void handle() {
        System.out.println("ä¸‰çº§å¤„ç†å™¨æ­£åœ¨å¤„ç†");
        if (next != null) {
            next.handle();
        }
    }
}
```



æœ€ç»ˆçš„æµ‹è¯•

```java
public class ChainExecution {

    public static void main(String[] args) {
        Level1Handler level1Handler = new Level1Handler();
        Level2Handler level2Handler = new Level2Handler();
        Level3Handler level3Handler = new Level3Handler();

        level2Handler.setNext(level3Handler);
        level1Handler.setNext(level2Handler);

        level1Handler.handle();
    }
}
```

è´£ä»»é“¾æ¨¡å¼é™ä½äº†ç³»ç»Ÿä¹‹é—´çš„è€¦åˆæ€§ï¼Œæå‡äº†ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ã€‚åœ¨å¾ˆå¤šä¸­é—´ä»¶ã€æ¡†æ¶çš„å†…éƒ¨å¤§é‡åœ°ä½¿ç”¨äº†è¯¥ç§è®¾è®¡æ¨¡å¼ï¼Œæ¯”å¦‚Filterçš„æ‰§è¡Œè¿‡ç¨‹ç­‰ã€‚